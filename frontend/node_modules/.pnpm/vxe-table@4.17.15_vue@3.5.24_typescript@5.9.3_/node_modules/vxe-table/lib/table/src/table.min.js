Object.defineProperty(exports,"__esModule",{value:!0}),exports.default=void 0;var _vue=require("vue"),_comp=require("../../ui/src/comp"),_xeUtils=_interopRequireDefault(require("xe-utils")),_dom=require("../../ui/src/dom"),_utils=require("../../ui/src/utils"),_ui=require("../../ui"),_util=require("./util"),_vn=require("../../ui/src/vn"),_anime=require("./anime"),_log=require("../../ui/src/log"),_store=require("./store"),_cell=_interopRequireDefault(require("./cell")),_body=_interopRequireDefault(require("./body")),_header=_interopRequireDefault(require("./header")),_footer=_interopRequireDefault(require("./footer")),_props=require("./props"),_emits=require("./emits"),_panel=_interopRequireDefault(require("../module/custom/panel")),_panel2=_interopRequireDefault(require("../module/filter/panel")),_importPanel=_interopRequireDefault(require("../module/export/import-panel")),_exportPanel=_interopRequireDefault(require("../module/export/export-panel")),_panel3=_interopRequireDefault(require("../module/menu/panel"));function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}require("../module/filter/hook"),require("../module/menu/hook"),require("../module/edit/hook"),require("../module/export/hook"),require("../module/keyboard/hook"),require("../module/validator/hook"),require("../module/custom/hook"),require("../render");let{getConfig,getIcon,getI18n,renderer,formats,createEvent,globalResize,interceptor,hooks,globalEvents,GLOBAL_EVENT_KEYS,useFns,renderEmptyElement}=_ui.VxeUI,supportMaxRow=5e6,customStorageKey="VXE_CUSTOM_STORE",maxYHeight=5e6,maxXWidth=5e6,crossTableDragRowObj=null;var _default=exports.default=(0,_comp.defineVxeComponent)({name:"VxeTable",props:_props.tableProps,emits:_emits.tableEmits,setup(K,l){let{slots:Z,emit:r}=l,ve=_xeUtils.default.uniqueId(),q=_xeUtils.default.browse(),he=_ui.VxeUI.getComponent("VxeLoading"),fe=_ui.VxeUI.getComponent("VxeTooltip"),t=(0,_vue.inject)("$xeTabs",null),k=(0,_vue.inject)("$xeTable",null),J=(0,_vue.inject)("$xeGrid",null),Q=(0,_vue.inject)("$xeGantt",null),ee=J||Q,pe=useFns.useSize(K).computeSize,me=(0,_store.getCrossTableDragRowInfo)(),le=(0,_vue.reactive)({staticColumns:[],tableGroupColumn:[],tableColumn:[],tableData:[],scrollXLoad:!1,scrollYLoad:!1,overflowY:!0,overflowX:!1,scrollbarWidth:0,scrollbarHeight:0,lastScrollTime:0,rowHeight:0,parentHeight:0,isGroup:!1,isAllOverflow:!1,isAllSelected:!1,isIndeterminate:!1,currentRow:null,currentColumn:null,selectRadioRow:null,footerTableData:[],rowGroupColumn:null,expandColumn:null,checkboxColumn:null,radioColumn:null,treeNodeColumn:null,hasFixedColumn:!1,upDataFlag:0,reColumnFlag:0,initStore:{filter:!1,import:!1,export:!1,custom:!1},customStore:{btnEl:null,isAll:!1,isIndeterminate:!1,activeBtn:!1,activeWrapper:!1,visible:!1,maxHeight:0,oldSortMaps:{},oldFixedMaps:{},oldVisibleMaps:{}},customColumnList:[],filterStore:{isAllSelected:!1,isIndeterminate:!1,style:null,column:null,visible:!1,maxHeight:null},columnStore:{leftList:[],centerList:[],rightList:[],resizeList:[],pxList:[],pxMinList:[],autoMinList:[],scaleList:[],scaleMinList:[],autoList:[],remainList:[]},ctxMenuStore:{selected:null,visible:!1,showChild:!1,selectChild:null,list:[],style:null},editStore:{indexs:{columns:[]},titles:{columns:[]},selected:{row:null,column:null},copyed:{cut:!1,rows:[],columns:[]},actived:{row:null,column:null},focused:{row:null,column:null}},tooltipStore:{row:null,column:null,content:null,visible:!1,type:null,currOpts:{}},validStore:{visible:!1},validErrorMaps:{},importStore:{inited:!1,file:null,type:"",modeList:[],typeList:[],filename:"",visible:!1},importParams:{mode:"",types:null,message:!0},exportStore:{inited:!1,name:"",modeList:[],typeList:[],columns:[],isPrint:!1,hasFooter:!1,hasMerge:!1,hasTree:!1,hasColgroup:!1,visible:!1},exportParams:{filename:"",sheetName:"",mode:"",type:"",isColgroup:!1,isMerge:!1,isAllExpand:!1,useStyle:!1,original:!1,message:!0,isHeader:!1,isTitle:!1,isFooter:!1},visiblwRowsFlag:1,isRowGroupStatus:!1,rowGroupList:[],aggHandleFields:[],aggHandleAggColumns:[],rowGroupExpandedFlag:1,rowExpandedFlag:1,treeExpandedFlag:1,updateCheckboxFlag:1,pendingRowFlag:1,insertRowFlag:1,removeRowFlag:1,mergeHeadFlag:1,mergeBodyFlag:1,mergeFootFlag:1,rowHeightStore:{large:52,default:48,medium:44,small:40,mini:36},scrollVMLoading:!1,scrollYHeight:0,scrollYTop:0,isScrollYBig:!1,scrollXLeft:0,scrollXWidth:0,isScrollXBig:!1,lazScrollLoading:!1,rowExpandHeightFlag:1,calcCellHeightFlag:1,resizeHeightFlag:1,resizeWidthFlag:1,isCustomStatus:!1,isCrossDragRow:!1,dragRow:null,isCrossDragCol:!1,dragCol:null,dragTipText:"",isDragResize:!1,isRowLoading:!1,isColLoading:!1}),te=(0,_util.createInternalData)(),P={},B={},re=(0,_vue.ref)(),xe=(0,_vue.ref)(),ae=(0,_vue.ref)(),we=(0,_vue.ref)(),_e=(0,_vue.ref)(),Ce=(0,_vue.ref)(),be=(0,_vue.ref)(),Re=(0,_vue.ref)(),h=(0,_vue.ref)(),f=(0,_vue.ref)(),x=(0,_vue.ref)(),p=(0,_vue.ref)(),m=(0,_vue.ref)(),w=(0,_vue.ref)(),_=(0,_vue.ref)(),b=(0,_vue.ref)(),R=(0,_vue.ref)(),E=(0,_vue.ref)(),Ee=(0,_vue.ref)(),Te=(0,_vue.ref)(),Y=(0,_vue.ref)(),j=(0,_vue.ref)(),ye=(0,_vue.ref)(),Se=(0,_vue.ref)(),De=(0,_vue.ref)(),Fe=(0,_vue.ref)(),Ie=(0,_vue.ref)(),Le=(0,_vue.ref)(),X=(0,_vue.ref)(),I=(0,_vue.ref)(),Me=(0,_vue.ref)(),ke=(0,_vue.ref)(),L=(0,_vue.ref)(),Ue=(0,_vue.ref)(),Ae=(0,_vue.ref)(),M=(0,_vue.ref)(),He=(0,_vue.ref)(),Oe=(0,_vue.ref)(),$e=(0,_vue.ref)(),Ge=(0,_vue.ref)(),D=(0,_vue.ref)(),U=(0,_vue.ref)(),A,v=(0,_vue.computed)(()=>{var e=K.id;return e?_xeUtils.default.isFunction(e)?""+(e({$table:ge,$grid:J,$gantt:Q})||""):""+e:""}),a=(0,_vue.computed)(()=>{var e=ie.value;return""+(K.rowId||e.keyField||"_X_ROW_KEY")}),ze=(0,_vue.computed)(()=>Object.assign({},getConfig().table.validConfig,K.validConfig));var o=(0,_vue.computed)(()=>Be.value);let Pe=(0,_vue.computed)(()=>{var e=Be.value.threshold;return e?_xeUtils.default.toNumber(e):0});var i=(0,_vue.computed)(()=>T.value);let Be=(0,_vue.computed)(()=>{var{virtualXConfig:e,scrollX:l}=K,t=getConfig().table.virtualXConfig,r=getConfig().table.scrollX;return e||!l&&t?Object.assign({},t,e):Object.assign({},r,l)}),T=(0,_vue.computed)(()=>{var{virtualYConfig:e,scrollY:l}=K,t=getConfig().table.virtualYConfig,r=getConfig().table.scrollY;return e||!l&&t?Object.assign({},t,e):Object.assign({},r,l)}),We=(0,_vue.computed)(()=>Object.assign({},getConfig().table.scrollbarConfig,K.scrollbarConfig)),Ne=(0,_vue.computed)(()=>{var e=We.value;return Object.assign({},e.x,(null==(e=K.scrollbarConfig)?void 0:e.x)||{})}),Ve=(0,_vue.computed)(()=>{var e=We.value;return Object.assign({},e.y,(null==(e=K.scrollbarConfig)?void 0:e.y)||{})}),qe=(0,_vue.computed)(()=>"top"===Ne.value.position),Ye=(0,_vue.computed)(()=>"left"===Ve.value.position),je=(0,_vue.computed)(()=>{var e=T.value.threshold;return e?_xeUtils.default.toNumber(e):0}),d=(0,_vue.computed)(()=>le.rowHeightStore),H=(0,_vue.computed)(()=>{var e=pe.value;return d.value[e||"default"]||18}),oe=(0,_vue.computed)(()=>Object.assign({},getConfig().table.columnConfig,K.columnConfig)),Xe=(0,_vue.computed)(()=>Object.assign({},getConfig().table.currentColumnConfig,K.currentColumnConfig)),O=(0,_vue.computed)(()=>{var e=Object.assign({},getConfig().table.cellConfig,K.cellConfig);return e.height&&(e.height=_xeUtils.default.toNumber(e.height)),e});var u=(0,_vue.computed)(()=>{var e=Object.assign({},getConfig().table.headerCellConfig,K.headerCellConfig),l=H.value,t=O.value;let r=_xeUtils.default.toNumber((0,_util.getCalcHeight)(e.height||t.height));return Q&&(t=Q.getComputeMaps().computeTaskScaleConfs,t=t.value)&&2<t.length&&(l=l/2*t.length,r=Math.max(l,r)),e.height=r,e}),s=(0,_vue.computed)(()=>{var e=Object.assign({},getConfig().table.footerCellConfig,K.footerCellConfig),l=O.value;return e.height=_xeUtils.default.toNumber((0,_util.getCalcHeight)(e.height||l.height)),e});let ie=(0,_vue.computed)(()=>Object.assign({},getConfig().table.rowConfig,K.rowConfig)),$=(0,_vue.computed)(()=>Object.assign({},getConfig().table.aggregateConfig||getConfig().table.rowGroupConfig,K.aggregateConfig||K.rowGroupConfig)),c=(0,_vue.computed)(()=>$.value),Ke=(0,_vue.computed)(()=>Object.assign({},getConfig().table.currentRowConfig,K.currentRowConfig)),ne=(0,_vue.computed)(()=>Object.assign({},getConfig().table.rowDragConfig,K.rowDragConfig)),de=(0,_vue.computed)(()=>Object.assign({},getConfig().table.columnDragConfig,K.columnDragConfig)),g=(0,_vue.computed)(()=>Object.assign({},getConfig().table.resizeConfig,K.resizeConfig)),Ze=(0,_vue.computed)(()=>Object.assign({},getConfig().table.resizableConfig,K.resizableConfig));var Je=(0,_vue.computed)(()=>Object.assign({startIndex:0},getConfig().table.seqConfig,K.seqConfig));let G=(0,_vue.computed)(()=>Object.assign({},getConfig().table.radioConfig,K.radioConfig)),ue=(0,_vue.computed)(()=>Object.assign({},getConfig().table.checkboxConfig,K.checkboxConfig)),Qe=(0,_vue.computed)(()=>Object.assign({},getConfig().tooltip,getConfig().table.tooltipConfig,K.tooltipConfig)),el=(0,_vue.computed)(()=>Object.assign({},getConfig().tooltip,getConfig().table.headerTooltipConfig,K.headerTooltipConfig)),ll=(0,_vue.computed)(()=>Object.assign({},getConfig().tooltip,getConfig().table.footerTooltipConfig,K.footerTooltipConfig)),tl=(0,_vue.computed)(()=>{var e=le.tooltipStore,l=Qe.value;return Object.assign({},l,e.currOpts)}),rl=(0,_vue.computed)(()=>{var e=Qe.value;return Object.assign({},e)}),al=(0,_vue.computed)(()=>Object.assign({},getConfig().table.editConfig,K.editConfig)),y=(0,_vue.computed)(()=>Object.assign({orders:["asc","desc",null]},getConfig().table.sortConfig,K.sortConfig)),ol=(0,_vue.computed)(()=>Object.assign({},getConfig().table.filterConfig,K.filterConfig));var il=(0,_vue.computed)(()=>Object.assign({},getConfig().table.floatingFilterConfig,K.floatingFilterConfig));let se=(0,_vue.computed)(()=>Object.assign({},getConfig().table.mouseConfig,K.mouseConfig)),nl=(0,_vue.computed)(()=>Object.assign({},getConfig().table.areaConfig,K.areaConfig)),dl=(0,_vue.computed)(()=>Object.assign({},getConfig().table.keyboardConfig,K.keyboardConfig));var ul=(0,_vue.computed)(()=>Object.assign({},getConfig().table.clipConfig,K.clipConfig)),sl=(0,_vue.computed)(()=>cl.value);let cl=(0,_vue.computed)(()=>Object.assign({},getConfig().table.fnrConfig,K.fnrConfig)),gl=(0,_vue.computed)(()=>Object.assign({},getConfig().table.menuConfig,K.menuConfig)),vl=(0,_vue.computed)(()=>{var e=le.columnStore,l=e.leftList;let t=0;for(let e=0;e<l.length;e++){var r=l[e];t+=r.renderWidth}return t}),hl=(0,_vue.computed)(()=>{var e=le.columnStore,l=e.rightList;let t=0;for(let e=0;e<l.length;e++){var r=l[e];t+=r.renderWidth}return t}),fl=(0,_vue.computed)(()=>{var{columnStore:e,mergeBodyFlag:l}=le,{mergeBodyList:t,visibleColumn:r}=te,{leftList:e,rightList:a}=e,o=r.length-a.length;if(l&&(e.length||a.length)){var i=e.length;for(let e=0;e<t.length;e++){var{col:n,colspan:d}=t[e];if(n<i||o<n+d)return!0}}return!1}),pl=(0,_vue.computed)(()=>{var{spanMethod:e,footerSpanMethod:l,showHeaderOverflow:t}=K,{isGroup:r,scrollXLoad:a}=le;let o=!1;return r||a&&t&&(e||l||(o=!0)),o}),ml=(0,_vue.computed)(()=>{var{spanMethod:e,footerSpanMethod:l}=K,{scrollXLoad:t,scrollYLoad:r,isAllOverflow:a,expandColumn:o}=le,i=fl.value,n=z.value;let d=!1;return d=!(t||r||a)||o&&"fixed"!==n.mode||i||e||l?d:!0}),xl=(0,_vue.computed)(()=>{var{spanMethod:e,footerSpanMethod:l,showFooterOverflow:t}=K,r=le.scrollXLoad;let a=!1;return r&&t&&(e||l||(a=!0)),a}),wl=(0,_vue.computed)(()=>{var e=gl.value.header;return e&&e.options?e.options:[]}),_l=(0,_vue.computed)(()=>{var e=gl.value.body;return e&&e.options?e.options:[]}),Cl=(0,_vue.computed)(()=>{var e=gl.value.footer;return e&&e.options?e.options:[]});var bl=(0,_vue.computed)(()=>Rl.value);let Rl=(0,_vue.computed)(()=>{var e=gl.value,l=wl.value,t=_l.value,r=Cl.value;return!!(K.menuConfig&&(0,_utils.isEnableConf)(e)&&(l.length||t.length||r.length))}),El=(0,_vue.computed)(()=>{var e=le.ctxMenuStore;let l=[];return e.list.forEach(e=>{e.forEach(e=>{l.push(e)})}),l}),Tl=(0,_vue.computed)(()=>Object.assign({},getConfig().table.exportConfig,K.exportConfig)),yl=(0,_vue.computed)(()=>Object.assign({},getConfig().table.importConfig,K.importConfig));var Sl=(0,_vue.computed)(()=>Object.assign({},getConfig().table.printConfig,K.printConfig));let z=(0,_vue.computed)(()=>Object.assign({},getConfig().table.expandConfig,K.expandConfig)),ce=(0,_vue.computed)(()=>Object.assign({},getConfig().table.treeConfig,K.treeConfig)),Dl=(0,_vue.computed)(()=>Object.assign({},getConfig().table.emptyRender,K.emptyRender)),Fl=(0,_vue.computed)(()=>Object.assign({},getConfig().table.loadingConfig,K.loadingConfig));var Il=(0,_vue.computed)(()=>K.border?Math.max(2,Math.ceil(le.scrollbarWidth/le.tableColumn.length)):1);let Ll=(0,_vue.computed)(()=>Object.assign({},getConfig().table.customConfig,K.customConfig)),Ml=(0,_vue.computed)(()=>{var{tableData:e,rowExpandedFlag:l,expandColumn:t,rowGroupExpandedFlag:r,treeExpandedFlag:a}=le;let{visibleDataRowIdData:o,rowExpandedMaps:i}=te,n=[];return e.length&&t&&l&&r&&a&&_xeUtils.default.each(i,(e,l)=>{o[l]&&n.push(e)}),n}),kl=(0,_vue.computed)(()=>{var e=te.visibleColumn,l=le.tableColumn;return l.length||e.length?e.filter(e=>"auto"===e.width||"auto"===e.minWidth):[]}),Ul=(0,_vue.computed)(()=>{var e=le.tableColumn,l=te.collectColumn;let t=0;return e.length&&l.length&&l.forEach(e=>{e.renderFixed&&t++}),t}),Al=(0,_vue.computed)(()=>{var e=Ul.value,l=oe.value.maxFixedSize;return!!l&&l<=e}),Hl=(0,_vue.computed)(()=>{var e=K.border;return!0===e?"full":e||"default"});var Ol=(0,_vue.computed)(()=>{var{}=K,e=le.tableData,l=te.tableFullData;let{strict:t,checkMethod:r}=ue.value;return!!t&&(!e.length&&!l.length||!!r&&l.every(e=>!r({$table:ge,row:e})))}),$l=(0,_vue.computed)(()=>{var{overflowX:e,scrollXLoad:l,overflowY:t,scrollYLoad:r}=le;return{x:e&&l,y:t&&r}}),Gl=(0,_vue.computed)(()=>c.value.groupFields),zl=(0,_vue.computed)(()=>{var e=le.rowGroupList;let l=te.fullColumnFieldData,t=[];return e.forEach(e=>{e=l[e.field];e&&t.push(e.column)}),t});let Pl={refElem:re,refTooltip:ae,refValidTooltip:_e,refTableFilter:be,refTableCustom:Re,refTableMenu:Ce,refTableHeader:f,refTableBody:x,refTableFooter:p,refTableLeftHeader:m,refTableLeftBody:w,refTableLeftFooter:_,refTableRightHeader:b,refTableRightBody:R,refTableRightFooter:E,refLeftContainer:Y,refRightContainer:j,refColResizeBar:ye,refRowResizeBar:Se,refScrollXVirtualElem:Me,refScrollYVirtualElem:ke,refScrollXHandleElem:L,refScrollYHandleElem:M,refScrollXSpaceElem:D,refScrollYSpaceElem:U},Bl={computeSize:pe,computeTableId:v,computeValidOpts:ze,computeRowField:a,computeVirtualXOpts:Be,computeVirtualYOpts:T,computeScrollbarOpts:We,computeScrollbarXOpts:Ne,computeScrollbarYOpts:Ve,computeScrollbarXToTop:qe,computeScrollbarYToLeft:Ye,computeColumnOpts:oe,computeCurrentColumnOpts:Xe,computeScrollXThreshold:Pe,computeScrollYThreshold:je,computeRowHeightMaps:d,computeDefaultRowHeight:H,computeCellOpts:O,computeHeaderCellOpts:u,computeFooterCellOpts:s,computeRowOpts:ie,computeAggregateOpts:$,computeRowGroupOpts:c,computeCurrentRowOpts:Ke,computeRowDragOpts:ne,computeColumnDragOpts:de,computeResizeOpts:g,computeResizableOpts:Ze,computeSeqOpts:Je,computeRadioOpts:G,computeCheckboxOpts:ue,computeTooltipOpts:Qe,computeHeaderTooltipOpts:el,computeFooterTooltipOpts:ll,computeEditOpts:al,computeSortOpts:y,computeFilterOpts:ol,computeFloatingFilterOpts:il,computeMouseOpts:se,computeAreaOpts:nl,computeKeyboardOpts:dl,computeClipOpts:ul,computeFnrOpts:cl,computeHeaderMenu:wl,computeBodyMenu:_l,computeFooterMenu:Cl,computeIsMenu:bl,computeIsContentMenu:Rl,computeMenuList:El,computeMenuOpts:gl,computeExportOpts:Tl,computeImportOpts:yl,computePrintOpts:Sl,computeExpandOpts:z,computeTreeOpts:ce,computeEmptyOpts:Dl,computeLoadingOpts:Fl,computeCellOffsetWidth:Il,computeCustomOpts:Ll,computeLeftFixedWidth:vl,computeRightFixedWidth:hl,computeBodyMergeCoverFixed:fl,computeFixedColumnSize:Ul,computeIsMaxFixedColumn:Al,computeIsAllCheckboxDisabled:Ol,computeIsHeaderRenderOptimize:pl,computeIsBodyRenderOptimize:ml,computeIsFooterRenderOptimize:xl,computeVirtualScrollBars:$l,computeRowGroupFields:Gl,computeRowGroupColumns:zl,computeFNROpts:sl,computeSXOpts:o,computeSYOpts:i},ge={xID:ve,props:K,context:l,reactData:le,internalData:te,getRefMaps:()=>Pl,getComputeMaps:()=>Bl,xeGrid:J,xeGantt:Q,xegrid:J},Wl=(e,l,t)=>{e=_xeUtils.default.get(e,t),l=_xeUtils.default.get(l,t);return!(!(0,_utils.eqEmptyValue)(e)||!(0,_utils.eqEmptyValue)(l))||(_xeUtils.default.isString(e)||_xeUtils.default.isNumber(e)?""+e==""+l:_xeUtils.default.isEqual(e,l))},Nl=()=>{var e=a.value;te.currKeyField=e,te.isCurrDeepKey=(0,_util.hasDeepKey)(e)},S=(e,l)=>_xeUtils.default.isBoolean(e)?e:l,Vl=e=>{var{orders:l=[]}=y.value,e=e.order||null,e=l.indexOf(e)+1;return l[e<l.length?e:0]},ql=e=>{var l=getConfig().version,t=_xeUtils.default.toStringJSON(localStorage.getItem(customStorageKey)||""),t=t&&t._v===l?t:{_v:l};return(e?t[e]:t)||{}},Yl=e=>{let t=te.fullAllDataRowIdData,r={};return _xeUtils.default.each(e,(e,l)=>{t[l]&&(r[l]=e)}),r},jl=e=>{let t=te.fullDataRowIdData,r=[];return _xeUtils.default.each(e,(e,l)=>{t[l]&&-1===ge.findRowIndexOf(r,t[l].row)&&r.push(t[l].row)}),r},Xl=()=>{var{isScrollXBig:a,scrollXWidth:o}=le,{elemStore:i,visibleColumn:n,fullColumnIdData:d}=te,u=vl.value,s=hl.value,i=(0,_util.getRefElem)(i["main-body-scroll"]);if(i){var c=i.clientWidth;let e=i.scrollLeft;var g=(e=a?Math.ceil((o-c)*Math.min(1,e/(maxXWidth-c))):e)+u,v=e+c-s;let l=0,t=n.length;for(;l<t;){var h=Math.floor((l+t)/2);(d[n[h].id]||{}).oLeft<=g?l=h+1:t=h}let r=0;i=l===n.length?l:Math.max(0,l<n.length?l-2:0);for(let e=i,l=n.length;e<l;e++){var f=d[n[e].id]||{};if(r++,f.oLeft>v||60<=r)break}return{toVisibleIndex:Math.max(0,i),visibleSize:Math.max(1,r)}}return{toVisibleIndex:0,visibleSize:6}},Kl=(e,l)=>{var t=le.rowHeightStore;l&&l.clientHeight&&(t[e]=l.clientHeight)},Zl=()=>{var l=le.isAllOverflow,t=f.value,r=x.value,r=r?r.$el:null,e=H.value;let a=0;if(l){if(r){l=t?t.$el:null;let e;(e=!(e=r.querySelector("tr"))&&l?l.querySelector("tr"):e)&&(a=e.clientHeight)}a=a||e}else a=e;return Math.max(18,a)},Jl=()=>{var{isAllOverflow:l,expandColumn:t,isScrollYBig:o,scrollYHeight:i}=le,{elemStore:n,isResizeCellHeight:d,afterFullData:u,fullAllDataRowIdData:s}=te,c=ie.value,g=O.value,v=H.value,n=(0,_util.getRefElem)(n["main-body-scroll"]);if(n){var h=n.clientHeight;let e=n.scrollTop;var f=e=o?Math.ceil((i-h)*Math.min(1,e/(maxYHeight-h))):e,p=e+h;let r=-1,a=0;if(d||g.height||c.height||t||!l){var m=(0,_util.createHandleGetRowId)(ge).handleGetRowId;let t=0,e=u.length;for(;t<e;){var x=Math.floor((t+e)/2);(s[m(u[x])]||{}).oTop<=f?t=x+1:e=x}for(let e=r=t===u.length?t:Math.max(0,t<u.length?t-2:0),l=u.length;e<l;e++){var w=s[m(u[e])]||{};if(a++,w.oTop>p||100<=a)break}}else r=Math.floor(f/v)-1,a=Math.ceil(h/v)+1;return{toVisibleIndex:Math.max(0,r),visibleSize:Math.max(6,a)}}return{toVisibleIndex:0,visibleSize:6}},Ql=(t,r,a)=>{for(let e=0,l=t.length;e<l;e++){var o=t[e],{startIndex:i,endIndex:n}=r,d=o[a],o=d+o[a+"span"];d<i&&i<o&&(r.startIndex=d),d<n&&n<o&&(r.endIndex=o),r.startIndex===i&&r.endIndex===n||(e=-1)}};function et(l){var t={};if(l&&l.length)for(let e=0;e<l.length;e++){var{row:r,col:a,rowspan:o,colspan:i}=l[e];for(let l=0;l<o;l++)for(let e=0;e<i;e++)t[r+l+":"+(a+e)]=l||e?{rowspan:0,colspan:0}:{rowspan:o,colspan:i}}return t}let lt=(e,t,r)=>{var a=te.tableFullColumn;let{multiple:n,remote:d,orders:u}=y.value;if((t=_xeUtils.default.isArray(t)?t:[t])&&t.length){let l={},o=(n||(t=[t[0]],a.forEach(e=>{e.order&&(l[e.id]=e)})),{}),i=null;return t.forEach((e,l)=>{let{field:t,order:r}=e,a=t;_xeUtils.default.isString(t)&&(a=ge.getColumnByField(t)),i=i||a,a&&a.sortable&&(u&&-1===u.indexOf(r)&&(r=Vl(a)),a.order!==r&&(a.order=r),a.sortTime=Date.now()+l,o[a.id]=a)}),n||_xeUtils.default.each(l,(e,l)=>{o[l]||(e.order=null)}),r&&!d&&ge.handleTableData(!0),e&&ge.handleColumnSortEvent(e,i),(0,_vue.nextTick)().then(()=>(N(),ge.updateCellAreas(),F()))}return(0,_vue.nextTick)()},tt=()=>{var e=te.tableFullColumn;e.forEach(e=>{e.order=null})},rt=e=>{var{editConfig:l,editRules:t}=K,r=le.parentHeight;let a=K[e],o=("minHeight"===e&&(e=getConfig().table.minHeight,_xeUtils.default.eqNull(a))&&((0,_utils.eqEmptyValue)(e)?t&&(0,_utils.isEnableConf)(l)&&(a=144):a=e),0);return o=a?"100%"===a||"auto"===a?r:(t=ge.getExcludeHeight(),o=(0,_dom.isScale)(a)?Math.floor((_xeUtils.default.toInteger(a)||1)/100*r):_xeUtils.default.toNumber(a),Math.max(40,o-t)):o},at=e=>{let{aggregateConfig:s,rowGroupConfig:c}=K;var l=te.collectColumn,{storage:t,storeOptions:r}=Ll.value,a=!0===t,t=Object.assign({},!a&&t||{},r);let g=S(t.resizable,a),v=S(t.visible,a),h=S(t.fixed,a);r=S(t.sort,a);let f=S(t.aggGroup,a),p=S(t.aggFunc,a),{resizableData:m,sortData:x,visibleData:w,fixedData:_,aggGroupData:C,aggFuncData:b}=e;if(g&&m||r&&x||v&&w||h&&_||f&&C||p&&b){let i={};if(r&&x){if(!_xeUtils.default.isArray(x)){let t=[];_xeUtils.default.each(x,(e,l)=>{t.push({key:l,index:e})}),x=_xeUtils.default.orderBy(t,{field:"index",order:"asc"}).map(e=>({k:e.key}))}let o=1;_xeUtils.default.eachTree(x,(e,l,t,r,a)=>{i[e.k]={key:e.k,sNum:o++,pKey:a?a.k:null}},{children:"c"})}let n={},d=[],u=[];_xeUtils.default.eachTree(l,(e,l,t,r,a)=>{var o=e.getKey();a||h&&_&&void 0!==_[o]&&(e.fixed=_[o]),g&&m&&_xeUtils.default.isNumber(m[o])&&(e.resizeWidth=m[o]),v&&w&&_xeUtils.default.isBoolean(w[o])&&(e.visible=w[o]),p&&b&&(s||c)&&b[o]&&(e.aggFunc=b[o]),f&&C&&C[o]&&u.push({field:e.field}),n[o]=e,d.push(e)}),(s||c)&&u.length&&(t=kt(te.tableFullData,u),te.tableFullTreeData=[],te.tableFullGroupData=t.treeData,le.isRowGroupStatus=!0,le.rowGroupList=u,ge.cacheRowMap(!1)),r&&x&&(d.forEach(e=>{var l,t=e.getKey(),t=i[t];t&&(l=t.pKey?n[t.pKey]:null,e.parentId=l?l.id:null,e.renderSortNumber=t.sNum)}),a=_xeUtils.default.toArrayTree(_xeUtils.default.orderBy(d,"renderSortNumber"),{key:"id",parentKey:"parentId",children:"children"}),te.collectColumn=a,te.tableFullColumn=(0,_util.getColumnList)(a)),le.isCustomStatus=!0}else le.isCustomStatus=!1},ot=()=>{var{treeConfig:e,showOverflow:l}=K,{tableFullColumn:t,collectColumn:r}=te;let c=te.fullColumnIdData={},g=te.fullColumnFieldData={};var a=se.value,o=z.value;let v=oe.value;var i=de.value,n=T.value;let{isCrossDrag:h,isSelfToChildDrag:f}=i;var i=Ll.value,d=ce.value;let p=i.storage;var i=ie.value,u=r.some(_utils.hasChildrenList);let m=!!l,x,w,_,C,b,R,E,s=(e,l,t,r,a)=>{var{id:o,field:i,fixed:n,type:d,treeNode:u,rowGroupNode:s}=e,l={$index:-1,_index:-1,column:e,colid:o,index:l,items:t,parent:a||null,width:0,oLeft:0};i?(g[i]&&(0,_log.errLog)("vxe.error.colRepet",["field",i]),g[i]=l):(p&&!d&&(0,_log.errLog)("vxe.error.reqSupportProp",["storage",`[${d?"type="+d:"title="+e.getTitle()}]field=?`]),v.drag&&(h||f)&&(0,_log.errLog)("vxe.error.reqSupportProp",["column-drag-config.isCrossDrag | column-drag-config.isSelfToChildDrag",`${e.getTitle()||d||""} -> field=?`])),!E&&n&&(E=n),R||"html"!==d||(R=e),u&&(_&&(0,_log.warnLog)("vxe.error.colRepet",["tree-node",u]),_=_||e),s&&(_&&(0,_log.warnLog)("vxe.error.colRepet",["row-group-node",s]),x=x||e),"expand"===d&&(w&&(0,_log.warnLog)("vxe.error.colRepet",["type",d]),w=w||e),"checkbox"===d?(C&&(0,_log.warnLog)("vxe.error.colRepet",["type",d]),C=C||e):"radio"===d&&(b&&(0,_log.warnLog)("vxe.error.colRepet",["type",d]),b=b||e),m&&!1===e.showOverflow&&(m=!1),c[o]&&(0,_log.errLog)("vxe.error.colRepet",["colId",o]),c[o]=l};u?_xeUtils.default.eachTree(r,(e,l,t,r,a,o)=>{e.level=o.length,s(e,l,t,0,a)}):t.forEach(s),w&&"fixed"!==o.mode&&n.enabled&&(0,_log.warnLog)("vxe.error.notConflictProp",['column.type="expand',"virtual-y-config.enabled=false"]),w&&"fixed"!==o.mode&&a.area&&(0,_log.errLog)("vxe.error.errConflicts",["mouse-config.area","column.type=expand"]),w&&"inside"!==o.mode&&e&&!d.transform&&(0,_log.errLog)("vxe.error.notConflictProp",["tree-config.transform=false","expand-config.mode=fixed"]),R&&(v.useKey||(0,_log.errLog)("vxe.error.notSupportProp",["column.type=html","column-config.useKey=false","column-config.useKey=true"]),i.useKey||(0,_log.errLog)("vxe.error.notSupportProp",["column.type=html","row-config.useKey=false","row-config.useKey=true"])),le.isGroup=u,le.rowGroupColumn=x,le.treeNodeColumn=_,le.expandColumn=w,le.checkboxColumn=C,le.radioColumn=b,le.isAllOverflow=m},it=()=>{te.customHeight=rt("height"),te.customMinHeight=rt("minHeight"),te.customMaxHeight=rt("maxHeight"),le.scrollYLoad&&!(te.customHeight||te.customMinHeight||te.customMaxHeight)&&(te.customHeight=300)},nt=(e,l)=>{var t=oe.value.autoOptions,{isCalcHeader:t,isCalcBody:r,isCalcFooter:a}=t||{},o=[],i=(t&&o.push(`.vxe-header-cell--wrapper[colid="${e.id}"]`),r&&o.push(`.vxe-body-cell--wrapper[colid="${e.id}"]`),a&&o.push(`.vxe-footer-cell--wrapper[colid="${e.id}"]`),o.length?l.querySelectorAll(o.join(",")):[]);let n=0;t=i[0];t&&t.parentElement&&(r=getComputedStyle(t.parentElement),n=Math.ceil(_xeUtils.default.toNumber(r.paddingLeft)+_xeUtils.default.toNumber(r.paddingRight)));let d=e.renderAutoWidth-n;for(let e=0;e<i.length;e++){var u=i[e];d=Math.max(d,u?Math.ceil(u.scrollWidth)+4:0)}return d+n},dt=()=>{var e=kl.value;let r=te.fullColumnIdData,a=re.value;a&&(a.setAttribute("data-calc-col","Y"),e.forEach(e=>{var l=e.id,l=r[l],t=nt(e,a);l&&(l.width=Math.max(t,l.width)),e.renderAutoWidth=t}),ge.analyColumnWidth(),a.removeAttribute("data-calc-col"))},ut=()=>{var e=te.elemStore,e=(0,_util.getRefElem)(e["main-body-wrapper"]);if(e){var a=M.value;if(a)if(L.value){let t=0;a=e.clientWidth,e=a;let r=e/100;var l=K.fit,o=le.columnStore,{resizeList:o,pxMinList:i,autoMinList:n,pxList:d,scaleList:u,scaleMinList:s,autoList:c,remainList:g}=o;if(i.forEach(e=>{var l=_xeUtils.default.toInteger(e.minWidth);t+=l,e.renderWidth=l}),n.forEach(e=>{var l=Math.max(60,_xeUtils.default.toInteger(e.renderAutoWidth));t+=l,e.renderWidth=l}),s.forEach(e=>{var l=Math.floor(_xeUtils.default.toInteger(e.minWidth)*r);t+=l,e.renderWidth=l}),u.forEach(e=>{var l=Math.floor(_xeUtils.default.toInteger(e.width)*r);t+=l,e.renderWidth=l}),d.forEach(e=>{var l=_xeUtils.default.toInteger(e.width);t+=l,e.renderWidth=l}),c.forEach(e=>{var l=Math.max(60,_xeUtils.default.toInteger(e.renderAutoWidth));t+=l,e.renderWidth=l}),o.forEach(e=>{var l=_xeUtils.default.toInteger(e.resizeWidth);t+=l,e.renderWidth=l}),e-=t,r=0<e?Math.floor(e/(s.length+i.length+n.length+g.length)):0,l?0<e&&s.concat(i).concat(n).forEach(e=>{t+=r,e.renderWidth+=r}):r=40,g.forEach(e=>{var l=Math.max(r,40);e.renderWidth=l,t+=l}),l){var v=u.concat(s).concat(i).concat(n).concat(g);let l=v.length-1;if(0<l){let e=a-t;if(0<e){for(;0<e&&0<=l;)e--,v[l--].renderWidth++;t=a}}}le.scrollXWidth=t,le.resizeWidthFlag++,Jt(),it()}}},st=(e,l)=>{var t=le.scrollXLoad,r=l.querySelectorAll(`.vxe-cell--wrapper[rowid="${e.rowid}"]`);let a=0,o=null,i=0;for(let e=0;e<r.length;e++){var n=r[e],d=n.parentElement,u=d.style,s=u.height,d=(t||(u.height=""),o||(o=getComputedStyle(d),i=o?Math.ceil(_xeUtils.default.toNumber(o.paddingTop)+_xeUtils.default.toNumber(o.paddingBottom)):0),t||(u.height=s),n?n.clientHeight:0);a=Math.max(a,Math.ceil(d+i))}return a=t?Math.max(a,e.height):a},ct=()=>{var e=K.treeConfig,{tableData:l,isAllOverflow:t,scrollYLoad:r,scrollXLoad:a}=le;let o=te.fullAllDataRowIdData;var i=ce.value;let n=H.value,d=re.value;if(d&&!t&&(r||a||e&&i.showLine)){let t=(0,_util.createHandleGetRowId)(ge).handleGetRowId;d.setAttribute("data-calc-row","Y"),l.forEach(e=>{var l,e=t(e),e=o[e];e&&(l=st(e,d),e.height=Math.max(n,l)),d.removeAttribute("data-calc-row")}),le.calcCellHeightFlag++}},gt=t=>{let{sortBy:r,sortType:a}=t;return e=>{let l;return l=r?_xeUtils.default.isFunction(r)?r({row:e,column:t}):_xeUtils.default.get(e,r):P.getCellLabel(e,t),a&&"auto"!==a?"number"===a?_xeUtils.default.toNumber(l):"string"===a?_xeUtils.default.toValueString(l):l:isNaN(l)?l:_xeUtils.default.toNumber(l)}},vt=()=>{let r=K.treeConfig,{fullDataRowIdData:d,fullAllDataRowIdData:u,afterFullData:e,afterTreeFullData:l}=te;var t=ce.value,a=t.transform,o=t.children||t.childrenField;let s={};if(r){let i=0,n=(0,_util.createHandleGetRowId)(ge).handleGetRowId;_xeUtils.default.eachTree(l,(e,l,t,r)=>{var a=n(e),o=u[a],r=r.map((e,l)=>l%2==0?Number(e)+1:".").join("");o?(o.seq=r,o.treeIndex=l,o._tIndex=i):(l={row:e,rowid:a,seq:r,index:-1,$index:-1,_index:-1,treeIndex:-1,_tIndex:i,items:[],parent:null,level:0,height:0,resizeHeight:0,oTop:0,expandHeight:0},u[a]=l,d[a]=l),i++,s[a]=e},{children:a?t.mapChildrenField:o}),a&&e.forEach((e,l)=>{var e=n(e),e=u[e],t=l+1;e&&(r||(e.seq=t),e._index=l)}),te.afterFullRowMaps=s}else(()=>{let o=K.treeConfig,{afterFullData:e,fullDataRowIdData:i,fullAllDataRowIdData:n}=te,d=(0,_util.createHandleGetRowId)(ge).handleGetRowId,u={};e.forEach((e,l)=>{var t=d(e),r=n[t],a=l+1;r?(o||(r.seq=a),r._index=l):(r={row:e,rowid:t,seq:a,index:-1,$index:-1,_index:l,treeIndex:-1,_tIndex:-1,items:[],parent:null,level:0,height:0,resizeHeight:0,oTop:0,expandHeight:0},n[t]=r,i[t]=r),u[t]=e}),te.afterFullRowMaps=u})()},n=()=>{var e=K.treeConfig,l=le.isRowGroupStatus;let{fullAllDataRowIdData:n,treeExpandedMaps:d,rowGroupExpandedMaps:u}=te;var t=$.value,r=ce.value;let s=(0,_util.createHandleGetRowId)(ge).handleGetRowId,c=[],g={};return e&&r.transform?(e=r.children||r.childrenField,_xeUtils.default.eachTree(te.afterTreeFullData,(e,l,t,r,a)=>{var o=s(e),i=s(a);(!a||g[i]&&d[i])&&((a=n[o])&&(a._index=c.length),g[o]=1,c.push(e))},{children:e}),te.afterFullData=c,Wt(c),c):l?(r=t.childrenField,_xeUtils.default.eachTree(te.afterGroupFullData,(e,l,t,r,a)=>{var o=s(e),i=s(a);(!a||g[i]&&u[i])&&((a=n[o])&&(a._index=c.length),g[o]=1,c.push(e))},{children:r}),te.afterFullData=c,Wt(c),c):te.afterFullData},F=()=>{var a=K.mouseConfig;let{isGroup:w,currentRow:o,tableColumn:_,overflowX:C,scrollbarWidth:i,overflowY:n,scrollbarHeight:d,scrollXWidth:b,columnStore:u,editStore:s,isColLoading:R}=le,{visibleColumn:E,tableHeight:T,elemStore:y,customHeight:S,customMinHeight:D,customMaxHeight:F,tHeaderHeight:I,tFooterHeight:L}=te;var M=te.xeGanttView,k=re.value;if(k&&(!te.tBodyHeight||k.clientHeight)){let{leftList:l,rightList:t}=u,c=n?i:0,g=C?d:0;var U=De.value;let v=pl.value,h=ml.value,f=xl.value;var A=We.value,H=se.value,O=(0,_util.getRefElem)(y["main-body-wrapper"]),$=(0,_util.getRefElem)(y["main-body-table"]),U=(U&&(U.style.top=I+"px",U.style.height=O?O.offsetHeight-g+"px":""),A.x||{}),O=A.y||{},A=Ye.value;let e=C?"visible":"hidden",r=("visible"===U.visible||M?(g=d,e="visible"):"hidden"!==U.visible&&!1!==U.visible||(g=0,e="hidden"),n?"visible":"hidden"),p=("hidden"===O.visible||!1===O.visible||M&&!A?(c=0,r="hidden"):"visible"===O.visible&&(c=i,r="visible"),0),m=0,x=D-I-L-g;F&&(m=Math.max(x,F-I-L-g)),(p=S?S-I-L-g:p)||$&&(p=$.clientHeight),p&&(m&&(p=Math.min(m,p)),p=Math.max(x,p));U=Ue.value,O=Ae.value,$=Me.value,$=($&&($.style.height=g+"px",$.style.visibility=e),Oe.value),k=($&&($.style.width=k.clientWidth-c+"px",$.style.left=A?c+"px":""),U&&(A?(U.style.width=c+"px",U.style.display=n&&c?"block":""):U.style.display=""),O&&(A?O.style.display="":(O.style.width=c+"px",O.style.display="visible"===e?"block":"")),ke.value),$=(k&&(k.style.width=c+"px",k.style.height=p+I+L+"px",k.style.visibility=r),He.value),U=($&&($.style.height=I+"px",$.style.display=I&&"visible"===r?"block":""),$e.value),A=(U&&(U.style.height=p+"px",U.style.top=I+"px"),Ge.value),O=(A&&(A.style.height=L+"px",A.style.top=I+p+"px",A.style.display=L&&"visible"===r?"block":""),X.value);return O&&(O.style.height=p+"px",O.style.top=I+"px"),te.tBodyHeight=p,["main","left","right"].forEach((n,e)=>{let d=0<e?n:"";e="left"===d;let u=[],s;d&&(u=e?l:t,s=(e?Y:j).value),["header","body","footer"].forEach(l=>{var t=(0,_util.getRefElem)(y[n+`-${l}-wrapper`]),r=(0,_util.getRefElem)(y[n+`-${l}-scroll`]),a=(0,_util.getRefElem)(y[n+`-${l}-table`]);if("header"===l){let e=_;var o=v,i=(w?e=E:(o&&(R||!d&&C)||(e=E),d&&o&&(e=u||[])),e.reduce((e,l)=>e+l.renderWidth,0));d&&(!w&&o?t&&(t.style.width=i?i+"px":""):t&&(t.style.width=b?b+"px":"")),r&&(r.style.height=I+"px"),a&&(a.style.width=i?i+"px":"")}else if("body"===l){r&&(r.style.maxHeight=F?m+"px":"",r.style.height=S?p+"px":"",r.style.minHeight=x+"px"),s&&(t&&(t.style.top=I+"px"),s.style.height=`${0<S?S:T+I+L+g}px`,s.style.width=u.reduce((e,l)=>e+l.renderWidth,0)+"px");let e=_;o=h,i=(e=d&&(e=E,o)?u||[]:e).reduce((e,l)=>e+l.renderWidth,0),o=(d&&(o?t&&(t.style.width=i?i+"px":""):t&&(t.style.width=b?b+"px":"")),a&&(a.style.width=i?i+"px":"",a.style.paddingRight=c&&d&&(q.firefox||q.safari)?c+"px":""),(0,_util.getRefElem)(y[n+`-${l}-emptyBlock`]));o&&(o.style.width=i?i+"px":"")}else if("footer"===l){let e=_;o=f,i=(o&&(R||!d&&C)||(e=E),(e=d&&o?u||[]:e).reduce((e,l)=>e+l.renderWidth,0));d&&(o?t&&(t.style.width=i?i+"px":""):t&&(t.style.width=b?b+"px":"")),r&&(r.style.height=L+"px",s)&&t&&(t.style.top=`${0<S?S-L-g:T+I}px`),a&&(a.style.width=i?i+"px":"")}})}),o&&ge.setCurrentRow(o),a&&H.selected&&s.selected.row&&s.selected.column&&ge.addCellSelectedClass(),M&&M.handleUpdateStyle&&M.handleUpdateStyle(),(0,_vue.nextTick)()}},ht=e=>ge.triggerValidate?ge.triggerValidate(e):(0,_vue.nextTick)(),ft=(e,l)=>{ht("blur").catch(e=>e).then(()=>{ge.handleEdit(l,e).then(()=>ht("change")).catch(e=>e)})},pt=()=>{var l=K.sortConfig;if(l){var t=y.value;let e=t.defaultSort;e&&(e=_xeUtils.default.isArray(e)?e:[e]).length&&((l.multiple?e:e.slice(0,1)).forEach((e,l)=>{var{field:e,order:t}=e;e&&t&&(e=ge.getColumnByField(e))&&e.sortable&&(e.order=t,e.sortTime=Date.now()+l)}),t.remote||ge.handleTableData(!0).then(F))}},mt=e=>{G.value.reserve&&(te.radioReserveRow=e)},xt=(e,l)=>{var t,r=te.checkboxReserveRowMap;ue.value.reserve&&(t=(0,_util.getRowid)(ge,e),l?r[t]=e:r[t]&&delete r[t])},wt=(e,l)=>{var t=G.value.checkMethod;return e&&(l||!t||t({$table:ge,row:e}))&&(le.selectRadioRow=e,mt(e)),(0,_vue.nextTick)()},_t=(e,l,t)=>(e&&!_xeUtils.default.isArray(e)&&(e=[e]),ge.handleBatchSelectRows(e,!!l,t),ge.checkSelectionStatus(),(0,_vue.nextTick)()),Ct=(l,t)=>{let r=K.treeConfig,a=le.isRowGroupStatus,{afterFullData:e,afterTreeFullData:o,afterGroupFullData:i,checkboxReserveRowMap:n,selectCheckboxMaps:d}=te;var u=ce.value,s=$.value,u=u.children||u.childrenField,c=ue.value;let{checkField:g,reserve:v,checkMethod:h}=c,f=(0,_util.createHandleGetRowId)(ge).handleGetRowId,p=c.indeterminateField||c.halfField,m={};return g?(c=e=>{!t&&h&&!h({$table:ge,row:e})||(l&&(m[f(e)]=e),_xeUtils.default.set(e,g,l)),(r||a)&&p&&_xeUtils.default.set(e,p,!1)},r||a?_xeUtils.default.eachTree(e,c,{children:u}):e.forEach(c)):a?l?_xeUtils.default.eachTree(i,e=>{var l;!t&&h&&!h({$table:ge,row:e})||(l=f(e),m[l]=e)},{children:s.mapChildrenField}):!t&&h&&_xeUtils.default.eachTree(i,e=>{var l=f(e);!h({$table:ge,row:e})&&d[l]&&(m[l]=e)},{children:s.mapChildrenField}):r?l?_xeUtils.default.eachTree(o,e=>{var l;!t&&h&&!h({$table:ge,row:e})||(l=f(e),m[l]=e)},{children:u}):!t&&h&&_xeUtils.default.eachTree(o,e=>{var l=f(e);!h({$table:ge,row:e})&&d[l]&&(m[l]=e)},{children:u}):l?!t&&h?e.forEach(e=>{var l=f(e);(d[l]||h({$table:ge,row:e}))&&(m[l]=e)}):e.forEach(e=>{var l=f(e);m[l]=e}):!t&&h&&e.forEach(e=>{var l=f(e);!h({$table:ge,row:e})&&d[l]&&(m[l]=e)}),v&&(l?_xeUtils.default.each(m,(e,l)=>{n[l]=e}):e.forEach(e=>xt(e,!1))),le.updateCheckboxFlag++,te.selectCheckboxMaps=g?{}:m,le.isAllSelected=l,le.isIndeterminate=!1,te.treeIndeterminateRowMaps={},ge.checkSelectionStatus(),(0,_vue.nextTick)()},bt=o=>{var e=ce.value,l=ue.value;let{transform:i,loadMethod:n}=e,d=l.checkStrictly;return new Promise(a=>{if(n){let{fullAllDataRowIdData:e,treeExpandLazyLoadedMaps:l}=te,t=(0,_util.getRowid)(ge,o),r=e[t];l[t]=o,Promise.resolve(n({$table:ge,row:o})).then(e=>{if(r&&(r.treeLoaded=!0),l[t]&&delete l[t],e=_xeUtils.default.isArray(e)?e:[])return ge.loadTreeChildren(o,e).then(e=>{var l=te.treeExpandedMaps;return e.length&&!l[t]&&(l[t]=o),le.treeExpandedFlag++,!d&&ge.isCheckedByCheckboxRow(o)&&_t(e,!0),(0,_vue.nextTick)().then(()=>{if(i)return ge.handleTableData(),vt(),(0,_vue.nextTick)()})})}).catch(()=>{var e=te.treeExpandLazyLoadedMaps;r&&(r.treeLoaded=!1),e[t]&&delete e[t]}).finally(()=>{le.treeExpandedFlag++,(0,_vue.nextTick)().then(()=>ge.recalculate()).then(()=>a())})}else a()})},Rt=(e,l)=>{var t,r=te.treeExpandedReserveRowMap;ce.value.reserve&&(t=(0,_util.getRowid)(ge,e),l?r[t]=e:r[t]&&delete r[t])},Et=i=>new Promise(r=>{var e=z.value.loadMethod;if(e){var{fullAllDataRowIdData:a,rowExpandLazyLoadedMaps:o}=te;let l=(0,_util.getRowid)(ge,i),t=a[l];o[l]=i,e({$table:ge,row:i,rowIndex:ge.getRowIndex(i),$rowIndex:ge.getVMRowIndex(i)}).then(()=>{var e=te.rowExpandedMaps;t&&(t.expandLoaded=!0),e[l]=i,le.rowExpandedFlag++}).catch(()=>{t&&(t.expandLoaded=!1)}).finally(()=>{var e=te.rowExpandLazyLoadedMaps;e[l]&&delete e[l],le.rowExpandedFlag++,(0,_vue.nextTick)().then(()=>ge.recalculate()).then(()=>ge.updateCellAreas()).then(()=>r())})}else r()}),Tt=(e,l)=>{var t,r=te.rowExpandedReserveRowMap;z.value.reserve&&(t=(0,_util.getRowid)(ge,e),l?r[t]=e:r[t]&&delete r[t])},yt=()=>(0,_vue.nextTick)().then(()=>{var e,{scrollXLoad:l,scrollYLoad:t}=le,{scrollXStore:r,scrollYStore:a}=te,o=T.value,i=Be.value,i=(l?({toVisibleIndex:l,visibleSize:e}=Xl(),n=Math.max(0,i.oSize?_xeUtils.default.toNumber(i.oSize):0),r.preloadSize=_xeUtils.default.toNumber(i.preSize),r.offsetSize=n,r.visibleSize=e,r.endIndex=Math.max(r.startIndex+r.visibleSize+n,r.endIndex),r.visibleStartIndex=Math.max(r.startIndex,l),r.visibleEndIndex=Math.min(r.endIndex,l+e),ge.updateScrollXData().then(()=>{Gt()})):ge.updateScrollXSpace(),Zl()),{toVisibleIndex:n,visibleSize:r}=(a.rowHeight=i,le.rowHeight=i,Jl());t?(l=Math.max(0,o.oSize?_xeUtils.default.toNumber(o.oSize):0),a.preloadSize=_xeUtils.default.toNumber(o.preSize),a.offsetSize=l,a.visibleSize=r,a.endIndex=Math.max(a.startIndex+r+l,a.endIndex),a.visibleStartIndex=Math.max(a.startIndex,n),a.visibleEndIndex=Math.min(a.endIndex,n+r),ge.updateScrollYData().then(()=>{Yt()})):ge.updateScrollYSpace()}),St=()=>{var{scrollXWidth:e,scrollYHeight:l}=le,t=te.elemStore,r=We.value,a=(0,_util.getRefElem)(t["main-body-wrapper"]),o=(0,_util.getRefElem)(t["main-header-table"]),t=(0,_util.getRefElem)(t["main-footer-table"]),i=L.value,n=M.value;let d=!1;a&&(l=l>a.clientHeight,n&&(le.scrollbarWidth=r.width||n.offsetWidth-n.clientWidth||14),le.overflowY=l,d=e>a.clientWidth,i&&(le.scrollbarHeight=r.height||i.offsetHeight-i.clientHeight||14),n=o?o.clientHeight:0,l=t?t.clientHeight:0,te.tableHeight=a.offsetHeight,te.tHeaderHeight=n,te.tFooterHeight=l,le.overflowX=d,le.parentHeight=Math.max(n+l+20,ge.getParentHeight())),d&&ge.checkScrolling()},Dt=(e,l,t)=>{var r,a,o,i=re.value;return te.rceRunTime=Date.now(),i&&i.clientWidth?((i=xe.value)&&([i,r,a,o]=i.children,Kl("default",i),Kl("medium",r),Kl("small",a),Kl("mini",o)),l&&dt(),e&&ut(),St(),F(),Qt(),e&&er(),yt().then(()=>{if(l&&dt(),e&&ut(),t&&ct(),F(),St(),e&&N(),Qt(),e&&er(),e)return yt()})):(0,_vue.nextTick)()},C=(i,n,d)=>new Promise(e=>{var l=te.xeGanttView,{rceTimeout:t,rceRunTime:r}=te,a=g.value.refreshDelay||20,o=re.value;o&&o.clientWidth&&(ut(),Qt()),!t||(clearTimeout(t),r&&r+(a-5)<Date.now())?e(Dt(i,n,d)):(0,_vue.nextTick)(()=>{e()}),l&&l.handleLazyRecalculate&&l.handleLazyRecalculate(),te.rceTimeout=setTimeout(()=>{te.rceTimeout=void 0,Dt(i,n,d)},a)}),Ft=()=>{C(!0,!0,!0)},It=()=>{var e=te.visibleColumn;let l=[];e.forEach(e=>{e.aggFunc&&l.push(e)}),le.aggHandleAggColumns=l},Lt=e=>{let l=[],t=[];e&&(_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{l.push(e),t.push({field:e})}),le.rowGroupList=t,le.aggHandleFields=l,It()},Mt=e=>{let t=$.value.mapChildrenField;t&&(_xeUtils.default.lastEach(e,e=>{let l=0;_xeUtils.default.each(e[t],e=>{e.isAggregate?l+=e.childCount||0:l++}),e.childCount=l}),ge.handlePivotTableAggregateData)&&ge.handlePivotTableAggregateData(e)},kt=(e,h)=>{let f=e,p=e;if(h){let{rowField:d,parentField:u,childrenField:s,mapChildrenField:c}=$.value;var l=ue.value;let g=l.checkField,v=l.indeterminateField||l.halfField;l=h[0];if(l&&d&&u&&s&&c){f=[],p=[];let r=l.field,a=ge.getColumnByField(r),o={},i=[],n=(0,_util.getRowkey)(ge);e.forEach(e=>{var l=a?ge.getCellLabel(e,a):_xeUtils.default.get(e,r),l=_xeUtils.default.eqNull(l)?"":l;let t=o[l];t||(t=[],o[l]=t),e.isAggregate&&(e.isAggregate=void 0),t.push(e)}),_xeUtils.default.objectEach(o,(e,l)=>{var{fullData:e,treeData:t}=kt(e,h.slice(1)),l={isAggregate:!0,aggData:{},groupContent:l,groupField:r,childCount:0,[d]:(0,_util.getRowUniqueId)(),[u]:null,[n]:(0,_util.getRowUniqueId)(),[s]:t,[c]:t};g&&(l[g]=!1),v&&(l[v]=!1),i.push(l),p.push(l),f.push(l),e.length&&f.push(...e)}),Mt(i)}}return{treeData:p,fullData:f}},Ut=()=>{let e=K.data;At(e||[],!0).then(()=>{e&&e.length&&(te.inited=!0,te.initStatus=!0,Ht()),pt(),F(),le.isAllOverflow||(ct(),N())})},At=(e,l)=>{var{keepSource:t,treeConfig:r,rowGroupConfig:a,aggregateConfig:o}=K;let{rowGroupList:i,scrollYLoad:n}=le,{scrollYStore:d,scrollXStore:u,lastScrollLeft:s,lastScrollTop:c}=te;var g=ie.value,v=ce.value;let h=z.value;var f=v.transform,p=v.children||v.childrenField;let m=[],x=(0,_vue.reactive)(e?e.slice(0):[]);if(x.length>supportMaxRow&&(0,_log.errLog)("vxe.error.errMaxRow",[supportMaxRow]),r&&i.length)return(0,_log.errLog)("vxe.error.noTree",["aggregate-config"]),(0,_vue.nextTick)();if(g.drag&&i.length)return(0,_log.errLog)("vxe.error.errConflicts",["row-config.drag","aggregate-config"]),(0,_vue.nextTick)();let w=!1,_=(r?f?(v.rowField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.rowField"]),v.parentField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.parentField"]),p||(0,_log.errLog)("vxe.error.reqProp",["tree-config.childrenField"]),v.mapChildrenField||(0,_log.errLog)("vxe.error.reqProp",["tree-config.mapChildrenField"]),p===v.mapChildrenField&&(0,_log.errLog)("vxe.error.errConflicts",["tree-config.childrenField","tree-config.mapChildrenField"]),m=_xeUtils.default.toArrayTree(x,{key:v.rowField,parentKey:v.parentField,children:p,mapChildren:v.mapChildrenField}),x=m.slice(0)):m=x.slice(0):(o||a)&&i.length&&(g=kt(x,i),m=g.treeData,x=g.fullData,w=!0),le.isRowGroupStatus=w,d.startIndex=0,d.endIndex=1,u.startIndex=0,u.endIndex=1,te.cvCacheMaps={},le.isRowLoading=!0,le.scrollVMLoading=!1,le.treeExpandedFlag++,le.rowExpandedFlag++,te.insertRowMaps={},le.insertRowFlag++,te.removeRowMaps={},le.removeRowFlag++,Wt(x));return te.tableFullData=x,te.tableFullTreeData=w?[]:m,te.tableFullGroupData=w?m:[],ge.cacheRowMap(l),te.tableSynchData=e,l&&(te.isResizeCellHeight=!1),t&&ge.cacheSourceMap(x),ge.clearCellAreas&&K.mouseConfig&&(ge.clearCellAreas(),ge.clearCopyCellArea()),ge.clearMergeCells(),ge.clearMergeFooterItems(),ge.handleTableData(!0),ge.updateFooter(),ge.handleUpdateBodyMerge(),(0,_vue.nextTick)().then(()=>{it(),F()}).then(()=>{yt()}).then(()=>{var e=T.value;return _&&(d.endIndex=d.visibleSize),_&&(le.expandColumn&&"fixed"!==h.mode&&(0,_log.errLog)("vxe.error.notConflictProp",['column.type="expand','expand-config.mode="fixed"']),"scroll"===e.mode&&"fixed"===h.mode&&(0,_log.warnLog)("vxe.error.notConflictProp",["virtual-y-config.mode=scroll","expand-config.mode=inside"]),K.height||K.maxHeight||(0,_log.errLog)("vxe.error.reqProp",["height | max-height | virtual-y-config={enabled: false}"])),(()=>{var e=K.treeConfig,{expandColumn:l,currentRow:t,selectRadioRow:r}=le,{fullDataRowIdData:a,fullAllDataRowIdData:o,radioReserveRow:i,selectCheckboxMaps:n,treeExpandedMaps:d,rowExpandedMaps:u}=te,s=z.value,c=ce.value,g=G.value,v=ue.value;r&&!o[(0,_util.getRowid)(ge,r)]&&(le.selectRadioRow=null),g.reserve&&i&&a[r=(0,_util.getRowid)(ge,i)]&&wt(a[r].row,!0),te.selectCheckboxMaps=Yl(n),le.updateCheckboxFlag++,v.reserve&&_t(jl(te.checkboxReserveRowMap),!0,!0),t&&!o[(0,_util.getRowid)(ge,t)]&&(le.currentRow=null),te.rowExpandedMaps=l?Yl(u):{},le.rowExpandedFlag++,l&&s.reserve&&ge.setRowExpand(jl(te.rowExpandedReserveRowMap),!0),te.treeExpandedMaps=e?Yl(d):{},le.treeExpandedFlag++,e&&c.reserve&&ge.setTreeExpand(jl(te.treeExpandedReserveRowMap),!0)})(),ge.checkSelectionStatus(),ge.dispatchEvent("data-change",{visibleColumn:te.visibleColumn,visibleData:te.afterFullData},null),new Promise(a=>{(0,_vue.nextTick)().then(()=>Dt(!1,!1,!1)).then(()=>{Dt(!1,!0,!0),N()}).then(()=>{let e=s,l=c;var t=Be.value,r=T.value;t.scrollToLeftOnChange&&(e=0),r.scrollToTopOnChange&&(l=0),le.isRowLoading=!1,Dt(!1,!1,!1),er(),K.showOverflow||setTimeout(()=>{C(!1,!0,!0),setTimeout(()=>C(!1,!0,!0),3e3)},2e3),n===_?(0,_util.restoreScrollLocation)(ge,e,l).then(()=>{Dt(!1,!0,!0),N(),er(),a()}):setTimeout(()=>{(0,_util.restoreScrollLocation)(ge,e,l).then(()=>{Dt(!1,!0,!0),N(),er(),a()})})})})})},Ht=()=>{var e,l,t;(()=>{var e=K.checkboxConfig;if(e){let t=te.fullDataRowIdData;var{checkAll:e,checkRowKeys:r}=ue.value;if(e)Ct(!0,!0);else if(r){let l=[];r.forEach(e=>{t[e]&&l.push(t[e].row)}),_t(l,!0,!0)}}})(),(t=K.radioConfig)&&(t=te.fullDataRowIdData,{checkRowKey:e,reserve:l}=G.value,e)&&(t[e]&&wt(t[e].row,!0),l)&&(t=(0,_util.getRowkey)(ge),te.radioReserveRow={[t]:e}),(()=>{var e=K.expandConfig;if(e){let t=te.fullDataRowIdData;var{expandAll:e,expandRowKeys:r}=z.value;if(e)ge.setAllRowExpand(!0);else if(r){let l=[];r.forEach(e=>{t[e]&&l.push(t[e].row)}),ge.setRowExpand(l,!0)}}})(),(()=>{var e=K.treeConfig;if(e){let t=te.fullAllDataRowIdData;var{expandAll:e,expandRowKeys:r}=ce.value;if(e)ge.setAllTreeExpand(!0);else if(r){let l=[];r.forEach(e=>{e=t[e];e&&l.push(e.row)}),ge.setTreeExpand(l,!0)}}})(),(()=>{const{isRowGroupStatus:e}=le;if(e){const l=$.value;const{expandAll:t,expandGroupFields:r}=l;if(t)ge.setAllRowGroupExpand(true);else if(r&&r.length)ge.setRowGroupExpandByField(r,true)}})(),(l=K.mergeCells)&&ge.setMergeCells(l),(t=K.mergeHeaderCells)&&ge.setMergeHeaderCells(t),(()=>{var{mergeFooterCells:e,mergeFooterItems:l}=K,e=e||l;e&&ge.setMergeFooterCells(e)})(),(0,_vue.nextTick)(()=>setTimeout(()=>ge.recalculate()))},Ot=()=>{var e=le.scrollXLoad;let{visibleColumn:l,scrollXStore:t,fullColumnIdData:r}=te;e=e?l.slice(t.startIndex,t.endIndex):l.slice(0);e.forEach((e,l)=>{e=e.id,e=r[e];e&&(e.$index=l)}),le.tableColumn=e},$t=()=>{var e=_xeUtils.default.orderBy(te.collectColumn,"renderSortNumber"),e=(te.collectColumn=e,(0,_util.getColumnList)(e));te.tableFullColumn=e,ot()},Gt=()=>{var e=le.isScrollXBig,{mergeBodyList:l,mergeFooterList:t,scrollXStore:r}=te,{preloadSize:a,startIndex:o,endIndex:i,offsetSize:n}=r,{toVisibleIndex:d,visibleSize:u}=Xl(),e={startIndex:Math.max(0,e?d-1:d-1-n-a),endIndex:e?d+u:d+u+n+a},{startIndex:n,endIndex:a}=(r.visibleStartIndex=d-1,r.visibleEndIndex=d+u+1,Ql(l.concat(t),e,"col"),e);!(d<=o||i-u-1<=d)||o===n&&i===a||(r.startIndex=n,r.endIndex=a,ge.updateScrollXData()),ge.closeTooltip()},zt=e=>{let i=[],n=[],d=[];var{isGroup:l,columnStore:t}=le;let{collectColumn:a,tableFullColumn:r,scrollXStore:o,fullColumnIdData:u}=te;if(l){let l=[],t=[],r=[];_xeUtils.default.eachTree(a,(e,l,t,r,a)=>{var o=(0,_utils.hasChildrenList)(e);a&&a.fixed&&(e.fixed=a.fixed),a&&(e.fixed||"")!==(a.fixed||"")&&(0,_log.errLog)("vxe.error.groupFixed"),o?e.visible=!!_xeUtils.default.findTree(e.children,e=>!(0,_utils.hasChildrenList)(e)&&e.visible):e.visible&&("left"===e.fixed?i:"right"===e.fixed?d:n).push(e)}),a.forEach(e=>{e.visible&&("left"===e.fixed?l:"right"===e.fixed?r:t).push(e)}),le.tableGroupColumn=l.concat(t).concat(r)}else r.forEach(e=>{e.visible&&("left"===e.fixed?i:"right"===e.fixed?d:n).push(e)});let s=i.concat(n).concat(d);te.visibleColumn=s,Jt();l=Bt();return le.hasFixedColumn=0<i.length||0<d.length,Object.assign(t,{leftList:i,centerList:n,rightList:d}),l&&(K.spanMethod&&(0,_log.warnLog)("vxe.error.scrollErrProp",["span-method"]),K.footerSpanMethod&&(0,_log.warnLog)("vxe.error.scrollErrProp",["footer-span-method"]),e)&&(t=Xl().visibleSize,o.startIndex=0,o.endIndex=t,o.visibleSize=t,o.visibleStartIndex=0,o.visibleEndIndex=t),s.length===te.visibleColumn.length&&te.visibleColumn.every((e,l)=>e===s[l])||(ge.clearMergeCells(),ge.clearMergeFooterItems()),s.forEach((e,l)=>{e=e.id,e=u[e];e&&(e._index=l)}),Ot(),It(),e?(Jt(),ge.updateFooter().then(()=>ge.recalculate()).then(()=>(ge.updateCellAreas(),ge.recalculate()))):ge.updateFooter()},Pt=e=>{let r=z.value;te.collectColumn=e;e=(0,_util.getColumnList)(e);return te.tableFullColumn=e,le.isColLoading=!0,(()=>{var e=te.collectColumn;let d={},u={},s=1;_xeUtils.default.eachTree(e,(e,l,t,r,a)=>{var{id:o,field:i}=e,n=a?a.id:null,l={$index:-1,_index:-1,column:e,colid:o,index:l,items:t,parent:a||null,width:0,oLeft:0};e.parentId=n,e.defaultParentId=n,e.sortNumber=s,e.renderSortNumber=s,s++,i&&(u[i]&&(0,_log.errLog)("vxe.error.colRepet",["field",i]),u[i]=l),d[o]=l}),te.fullColumnIdData=d,te.fullColumnFieldData=u})(),Promise.resolve((()=>{var e=K.customConfig,l=v.value,t=Ll.value,{storage:r,restoreStore:a,storeOptions:o}=t,i=!0===r,o=Object.assign({},!i&&r||{},o),n=S(o.resizable,i),d=S(o.visible,i),u=S(o.fixed,i),s=S(o.sort,i),c=S(o.aggGroup,i),o=S(o.aggFunc,i);if(r&&(e?(0,_utils.isEnableConf)(t):t.enabled)&&(n||d||u||s||c||o)){if(l)return i=ql(l),a?Promise.resolve(a({$table:ge,id:l,type:"restore",storeData:i})).then(e=>{if(e)return at(e)}).catch(e=>e):at(i);(0,_log.errLog)("vxe.error.reqProp",["id"])}})()).then(()=>{var{scrollXLoad:e,scrollYLoad:l,expandColumn:t}=le;return ot(),zt(!0).then(()=>{le.scrollXLoad&&Gt()}),ge.clearMergeCells(),ge.clearMergeFooterItems(),ge.handleTableData(!0),ge.handleAggregateSummaryData(),(e||l)&&t&&"fixed"!==r.mode&&(0,_log.warnLog)("vxe.error.scrollErrProp",["column.type=expand"]),(0,_vue.nextTick)().then(()=>{A&&A.syncUpdate({collectColumn:te.collectColumn,$table:ge}),ge.handleUpdateCustomColumn&&ge.handleUpdateCustomColumn();var e=oe.value;return K.showCustomHeader&&le.isGroup&&(e.resizable||K.resizable)&&(0,_log.warnLog)("vxe.error.notConflictProp",["show-custom-header & colgroup","column-config.resizable=false"]),le.isColLoading=!1,C(!1,!0,!0)})})},Bt=e=>{var l=Be.value,e=e||te.tableFullColumn,l=!!l.enabled&&-1<l.gt&&(0===l.gt||l.gt<e.length);return le.scrollXLoad=l},Wt=e=>{var l=K.treeConfig,t=te.xeGanttView,r=T.value,a=ce.value.transform,e=e||te.tableFullData,a=(a||!l)&&!!r.enabled&&-1<r.gt&&(0===r.gt||r.gt<e.length);return le.scrollYLoad=a,t&&t.handleUpdateSYStatus&&t.handleUpdateSYStatus(a),a},Nt=(e,l)=>{let t=le.treeNodeColumn,{fullAllDataRowIdData:r,tableFullTreeData:a,treeExpandedMaps:o,treeExpandLazyLoadedMaps:i}=te;var n=ce.value;let{reserve:d,lazy:u,accordion:s,toggleMethod:c}=n,g=n.children||n.childrenField,v=n.hasChild||n.hasChildField,h=[],f=ge.getColumnIndex(t),p=ge.getVMColumnIndex(t),m=(0,_util.createHandleGetRowId)(ge).handleGetRowId,x=c?e.filter(e=>c({$table:ge,expanded:l,column:t,columnIndex:f,$columnIndex:p,row:e})):e;return s&&(x=x.length?[x[x.length-1]]:[],n=_xeUtils.default.findTree(a,e=>e===x[0],{children:g}))&&n.items.forEach(e=>{e=m(e);o[e]&&delete o[e]}),l?x.forEach(e=>{var l,t=m(e);o[t]||(l=r[t])&&(u&&e[v]&&!l.treeLoaded&&!i[t]?h.push(bt(e)):e[g]&&e[g].length&&(o[t]=e))}):x.forEach(e=>{e=m(e);o[e]&&delete o[e]}),d&&x.forEach(e=>Rt(e,l)),le.treeExpandedFlag++,Promise.all(h).then(()=>(er(),ge.recalculate()))},Vt=(e,l)=>((e,l)=>{let{fullAllDataRowIdData:t,tableFullGroupData:r,rowGroupExpandedMaps:a}=te;let{mapChildrenField:o,accordion:i}=$.value,n=(0,_util.createHandleGetRowId)(ge).handleGetRowId,d=e;return o&&(i&&(d=d.length?[d[d.length-1]]:[],e=_xeUtils.default.findTree(r,e=>(0,_util.getRowid)(ge,e)===(0,_util.getRowid)(ge,d[0]),{children:o}))&&e.items.forEach(e=>{e=n(e);a[e]&&delete a[e]}),l?d.forEach(e=>{var l=n(e);a[l]||t[l]&&e[o]&&e[o].length&&(a[l]=e)}):d.forEach(e=>{e=n(e);a[e]&&delete a[e]})),le.rowGroupExpandedFlag++,ge.recalculate()})(e,l).then(()=>(n(),ge.handleTableData(),le.rowGroupExpandedFlag++,vt(),(0,_vue.nextTick)())).then(()=>C(!0,!0,!0)).then(()=>{setTimeout(()=>{ge.updateCellAreas()},30)}),qt=(e,l)=>{Ct(l),e&&W("checkbox-all",{records:()=>ge.getCheckboxRecords(),reserves:()=>ge.getCheckboxReserveRecords(),indeterminates:()=>ge.getCheckboxIndeterminateRecords(),checked:l},e)},Yt=()=>{var{isAllOverflow:e,isScrollYBig:l}=le,{mergeBodyList:t,scrollYStore:r}=te,{preloadSize:a,startIndex:o,endIndex:i,offsetSize:n}=r,e=e?n:n+1,{toVisibleIndex:d,visibleSize:u}=Jl(),n={startIndex:Math.max(0,l?d-1:d-1-n-a),endIndex:l?d+u:d+u+e+a},{startIndex:l,endIndex:e}=(r.visibleStartIndex=d-1,r.visibleEndIndex=d+u+1,Ql(t,n,"row"),n);!(d<=o||i-u-1<=d)||o===l&&i===e||(r.startIndex=l,r.endIndex=e,ge.updateScrollYData())};u=t=>function(e){var l=te.fullAllDataRowIdData;if(e){l=l[(0,_util.getRowid)(ge,e)];if(l)return l[t]}return-1},s=t=>function(e){var l=te.fullColumnIdData;if(e){l=l[e.id];if(l)return l[t]}return-1};let jt=e=>{var l=te.xeGanttView;l&&(l=l.internalData.elemStore,l=(0,_util.getRefElem)(l["main-body-scroll"]))&&(l.scrollTop=e)},W=(e,l,t)=>{r(e,createEvent(t,{$table:ge,$grid:J,$gantt:Q},l))},Xt=()=>{var e=re.value;e&&e.clientWidth&&e.clientHeight&&ge.recalculate()},Kt=(e,l)=>{ge.analyColumnWidth(),ge.recalculate().then(()=>{ge.saveCustomStore("update:width"),ge.updateCellAreas(),ge.dispatchEvent("column-resizable-change",l,e),ge.dispatchEvent("resizable-change",l,e),setTimeout(()=>ge.recalculate(!0),300)})},Zt=(e,l)=>{le.resizeHeightFlag++,ge.recalculate().then(()=>{ge.updateCellAreas(),ge.dispatchEvent("row-resizable-change",l,e),setTimeout(()=>ge.recalculate(!0),300)})},Jt=()=>{var{visibleColumn:t,fullColumnIdData:r}=te;let a=0;for(let e=0,l=t.length;e<l;e++){var o=t[e],i=r[o.id];i&&(i.oLeft=a),a+=o.renderWidth}},N=()=>{var t=le.expandColumn,{afterFullData:r,fullAllDataRowIdData:a,rowExpandedMaps:o}=te,i=z.value,n=ie.value,d=O.value,u=H.value,s=(0,_util.createHandleGetRowId)(ge).handleGetRowId;let c=0;for(let e=0,l=r.length;e<l;e++){var g=s(r[e]),v=a[g]||{};v.oTop=c,c+=v.resizeHeight||d.height||n.height||v.height||u,t&&o[g]&&(c+=v.expandHeight||i.height||0)}},Qt=()=>{let{expandColumn:e,scrollYLoad:d,scrollYTop:u,isScrollYBig:s}=le;var l=z.value;let c=ie.value,g=O.value,v=H.value;l=l.mode;if(e&&"fixed"===l){let{elemStore:e,fullAllDataRowIdData:i}=te;l=X.value;let n=(0,_util.getRefElem)(e["main-body-scroll"]);if(l&&n){let o=!1;_xeUtils.default.arrayEach(l.children,l=>{var t=l.getAttribute("rowid")||"",r=i[t];if(r){var a=l.offsetHeight+1,t=n.querySelector(`.vxe-body--row[rowid="${t}"]`);let e=0;d?e=s&&t?t.offsetTop+t.offsetHeight:r.oTop+(r.resizeHeight||g.height||c.height||r.height||v):t&&(e=t.offsetTop+t.offsetHeight),s&&(e+=u),l.style.top=(0,_dom.toCssUnit)(e),o||r.expandHeight!==a&&(o=!0),r.expandHeight=a}}),o&&(le.rowExpandHeightFlag++,(0,_vue.nextTick)(()=>{N()}))}}},er=()=>{var e=K.treeConfig;if(e){let t=le.tableData,{fullAllDataRowIdData:n,treeExpandedMaps:d}=te,u=O.value,s=ie.value,c=H.value;e=ce.value;let{transform:g,mapChildrenField:v}=e,h=e.children||e.childrenField,f=(0,_util.createHandleGetRowId)(ge).handleGetRowId,p=[],m=(e,l,t)=>{var r=f(e),a=n[r]||{};let o=e[g?v:h];var i=t[l-1]||null,t=t[l+1]||null;o&&o.length&&d[r]?(p.push({row:e,prevRow:i,nextRow:t}),o.forEach((e,l)=>{var t=f(e);d[t]&&m(e,l,o)})):t?(l=f(t),r=n[l]||{},e=(0,_util.getCellRestHeight)(a,u,s,c),i=(0,_util.getCellRestHeight)(r,u,s,c),a.oHeight=e,a.lineHeight=Math.floor(e/2+i/2)):(a.oHeight=0,a.lineHeight=0)};t.forEach((e,l)=>{m(e,l,t)}),_xeUtils.default.lastArrayEach(p,({row:e,nextRow:l})=>{var t=f(e),e=e[g?v:h],t=n[t];if(t){let r=(0,_util.getCellRestHeight)(t,u,s,c),a=0;e.forEach(e=>{var l=f(e),t=n[l]||{},e=e[g?v:h];d[l]&&e&&e.length?(r+=t.oHeight||0,a+=t.oHeight||0):(l=(0,_util.getCellRestHeight)(t,u,s,c),t.oHeight=l,t.lineHeight=l,r+=l,a+=l)}),l&&(e=f(l),l=n[e]||{},e=(0,_util.getCellRestHeight)(t,u,s,c),l=(0,_util.getCellRestHeight)(l,u,s,c),r+=e,a+=Math.floor(e/2+l/2)),t.lineHeight=a,t.oHeight=r}})}},lr=()=>{var e=te.elemStore,l=X.value,e=(0,_util.getRefElem)(e["main-body-scroll"]);l&&e&&(l.scrollTop=e.scrollTop)},tr=(P={dispatchEvent:W,getEl(){return re.value},clearAll(){return(0,_util.clearTableAllStatus)(ge)},syncData(){return(0,_log.errLog)("vxe.error.delFunc",["syncData","getData"]),(0,_vue.nextTick)().then(()=>(le.tableData=[],r("update:data",te.tableFullData),(0,_vue.nextTick)()))},updateData(){let{scrollXLoad:e,scrollYLoad:l}=le;return ge.handleTableData(!0).then(()=>{if(ge.updateFooter(),e||l)return e&&ge.updateScrollXSpace(),l&&ge.updateScrollYSpace(),ge.refreshScroll()}).then(()=>(ge.updateCellAreas(),C(!0,!0,!0))).then(()=>{setTimeout(()=>C(!1,!0,!0),50)})},loadData(e){let l=te.initStatus;return At(e,!1).then(()=>(te.inited=!0,te.initStatus=!0,l||Ht(),C(!1,!0,!0)))},reloadData(e){return ge.clearAll().then(()=>(te.inited=!0,te.initStatus=!0,At(e,!0))).then(()=>(Ht(),C(!1,!0,!0)))},setRow(l,a){if(l&&a){let e=l,r=(_xeUtils.default.isArray(l)||(e=[l]),(0,_util.getRowkey)(ge));e.forEach(e=>{var l=(0,_util.getRowid)(ge,e),t=_xeUtils.default.clone(Object.assign({},a),!0);_xeUtils.default.set(t,r,l),Object.assign(e,t)})}return(0,_vue.nextTick)()},reloadRow(e,l,t){var r=K.keepSource,a=le.tableData,o=te.sourceDataRowIdData;if(r){if(ge.isAggregateRecord(e))return(0,_vue.nextTick)();r=o[(0,_util.getRowid)(ge,e)];r&&e&&(t?(o=_xeUtils.default.clone(_xeUtils.default.get(l||e,t),!0),_xeUtils.default.set(e,t,o),_xeUtils.default.set(r,t,o)):(t=(0,_util.getRowkey)(ge),o=(0,_util.getRowid)(ge,e),l=_xeUtils.default.clone(Object.assign({},l),!0),_xeUtils.default.set(l,t,o),_xeUtils.default.destructuring(r,Object.assign(e,l)))),le.tableData=a.slice(0)}else(0,_log.errLog)("vxe.error.reqProp",["keep-source"]);return(0,_vue.nextTick)()},getParams(){return K.params},loadTreeChildren(r,e){let l=K.keepSource,{tableSourceData:a,fullDataRowIdData:n,fullAllDataRowIdData:d,sourceDataRowIdData:o}=te;var t=ce.value;let{transform:i,mapChildrenField:u}=t,s=t.children||t.childrenField,c=d[(0,_util.getRowid)(ge,r)],g=c?c.level:0;return P.createData(e).then(e=>{if(l){let l=(0,_util.getRowid)(ge,r);var t=_xeUtils.default.findTree(a,e=>l===(0,_util.getRowid)(ge,e),{children:s});t&&(t.item[s]=_xeUtils.default.clone(e,!0)),e.forEach(e=>{var l=(0,_util.getRowid)(ge,e);o[l]=_xeUtils.default.clone(e,!0)})}return _xeUtils.default.eachTree(e,(e,l,t,r,a,o)=>{var i=(0,_util.getRowid)(ge,e),e={row:e,rowid:i,seq:-1,index:l,_index:-1,$index:-1,treeIndex:-1,_tIndex:-1,items:t,parent:a||c.row,level:g+o.length,height:0,resizeHeight:0,oTop:0,expandHeight:0};n[i]=e,d[i]=e},{children:s}),r[s]=e,i&&(r[u]=_xeUtils.default.clone(e,!1)),vt(),e})},loadColumn(e){let{lastScrollLeft:a,lastScrollTop:o}=te;e=_xeUtils.default.mapTree(e,e=>(0,_vue.reactive)(_cell.default.createColumn(ge,e)));return Pt(e).then(()=>{let e=a,l=o;var t=Be.value,r=T.value;t.scrollToLeftOnChange&&(e=0),r.scrollToTopOnChange&&(l=0),(0,_util.restoreScrollLocation)(ge,e,l)})},reloadColumn(e){return P.clearAll().then(()=>P.loadColumn(e))},getRowNode(e){if(e){var l=te.fullAllDataRowIdData,e=e.getAttribute("rowid");if(e){l=l[e];if(l)return{rowid:l.rowid,item:l.row,index:l.index,items:l.items,parent:l.parent}}}return null},getColumnNode(e){if(e){var l=te.fullColumnIdData,e=e.getAttribute("colid");if(e){l=l[e];if(l)return{colid:l.colid,item:l.column,index:l.index,items:l.items,parent:l.parent}}}return null},getRowSeq:u("seq"),getRowIndex:u("index"),getVTRowIndex:u("_index"),getVMRowIndex:u("$index"),getColumnIndex:s("index"),getVTColumnIndex:s("_index"),getVMColumnIndex:s("$index"),createData(e){return(0,_vue.nextTick)().then(()=>(0,_vue.reactive)(B.defineField(e)))},createRow(e){let l=_xeUtils.default.isArray(e);return l||(e=[e||{}]),P.createData(e).then(e=>l?e:e[0])},revertData(e,r){var{keepSource:l,treeConfig:t}=K;let{fullAllDataRowIdData:a,fullDataRowIdData:o,tableSourceData:i,sourceDataRowIdData:n,tableFullData:d,afterFullData:u,removeRowMaps:s}=te;var c=ce.value.transform;let g=(0,_util.createHandleGetRowId)(ge).handleGetRowId;if(!l)return(0,_log.errLog)("vxe.error.reqProp",["keep-source"]),(0,_vue.nextTick)();let v=e,h=(e?_xeUtils.default.isArray(e)||(v=[e]):v=_xeUtils.default.toArray(ge.getUpdateRecords()),!1);return v.length&&v.forEach(e=>{var l,e=g(e),t=a[e];t&&(t=t.row,ge.isInsertByRow(t)||(l=n[e])&&t&&(r?_xeUtils.default.set(t,r,_xeUtils.default.clone(_xeUtils.default.get(l,r),!0)):_xeUtils.default.destructuring(t,_xeUtils.default.clone(l,!0)),!o[e])&&ge.isRemoveByRow(t)&&(s[e]&&delete s[e],d.unshift(t),u.unshift(t),h=!0))}),e?(h&&(le.removeRowFlag++,ge.updateFooter(),ge.cacheRowMap(!1),ge.handleTableData(t&&c),t&&c||ge.updateAfterDataIndex(),ge.checkSelectionStatus(),le.scrollYLoad)&&ge.updateScrollYSpace(),(0,_vue.nextTick)().then(()=>(ge.updateCellAreas(),C(!1,!0,!0)))):ge.reloadData(i)},clearData(e,l){let{tableFullData:t,visibleColumn:r}=te;return arguments.length?e&&!_xeUtils.default.isArray(e)&&(e=[e]):e=t,l?e.forEach(e=>_xeUtils.default.set(e,l,null)):e.forEach(l=>{r.forEach(e=>{e.field&&(0,_util.setCellValue)(l,e,null)})}),(0,_vue.nextTick)()},getCellElement(e,l){var t=te.elemStore,l=(0,_util.handleFieldOrColumn)(ge,l);if(!l)return null;var e=(0,_util.getRowid)(ge,e),r=(0,_util.getRefElem)(t["main-body-scroll"]),a=(0,_util.getRefElem)(t["left-body-scroll"]),t=(0,_util.getRefElem)(t["right-body-scroll"]);let o;return l&&(l.fixed&&("left"===l.fixed?a&&(o=a):t&&(o=t)),o=o||r)?o.querySelector(`.vxe-body--row[rowid="${e}"] .`+l.id):null},getCellLabel(l,t){t=(0,_util.handleFieldOrColumn)(ge,t);if(!t)return null;var r=t.formatter,a=(0,_util.getCellValue)(l,t);let o=a;if(r){let e;var i=te.fullAllDataRowIdData,n=(0,_util.getRowid)(ge,l),d=t.id,u=i[n];if(u&&(e=(e=u.formatData)||(i[n].formatData={}),u)&&e[d]&&e[d].value===a)return e[d].label;i={cellValue:a,row:l,rowIndex:ge.getRowIndex(l),column:t,columnIndex:ge.getColumnIndex(t)};o=_xeUtils.default.isString(r)?(u=(n=formats.get(r))?n.tableCellFormatMethod||n.cellFormatMethod:null)?u(i):"":_xeUtils.default.isArray(r)?(t=(l=formats.get(r[0]))?l.tableCellFormatMethod||l.cellFormatMethod:null)?t(i,...r.slice(1)):"":r(i),e&&(e[d]={value:a,label:o})}return o},getFooterCellLabel(t,r){r=(0,_util.handleFieldOrColumn)(ge,r);if(!r)return null;var a=r.footerFormatter,o=ge.getVTColumnIndex(r);let i="",n=i=_xeUtils.default.isArray(t)?t[o]:_xeUtils.default.get(t,r.field);if(a){let e;var d=le.footerTableData,u=te.footerFullDataRowData,s=r.id,d=d.indexOf(t);let l=null;if(-1<d&&(l=(l=u[d])||(u[d]={}),e=(e=l.formatData)||(u[d].formatData={}),l)&&e[s]&&e[s].value===i)return e[s].label;u={cellValue:i,itemValue:i,row:t,items:t,$rowIndex:d,column:r,_columnIndex:o,columnIndex:ge.getColumnIndex(r)};n=_xeUtils.default.isString(a)?(d=(t=formats.get(a))?t.tableFooterCellFormatMethod:null)?d(u):"":_xeUtils.default.isArray(a)?(r=(o=formats.get(a[0]))?o.tableFooterCellFormatMethod:null)?r(u,...a.slice(1)):"":a(u),e&&(e[s]={value:i,label:n})}return n},isInsertByRow(e){e=(0,_util.getRowid)(ge,e);return!!le.insertRowFlag&&!!te.insertRowMaps[e]},isRemoveByRow(e){e=(0,_util.getRowid)(ge,e);return!!le.removeRowFlag&&!!te.removeRowMaps[e]},removeInsertRow(){var e=te.insertRowMaps;return ge.remove(_xeUtils.default.values(e))},isUpdateByRow(e,l){var t=K.keepSource,{tableFullColumn:r,fullDataRowIdData:a,sourceDataRowIdData:o}=te;if(t){t=_xeUtils.default.isString(e)||_xeUtils.default.isNumber(e)?e:(0,_util.getRowid)(ge,e),e=a[t];if(!e)return!1;var i=e.row,n=o[t];if(n){if(1<arguments.length)return!Wl(n,i,l);for(let e=0,l=r.length;e<l;e++){var d=r[e].field;if(d&&!Wl(n,i,d))return!0}}}return!1},getColumns(e){var l=te.visibleColumn;return _xeUtils.default.isUndefined(e)?l.slice(0):l[e]},getColid(e){e=(0,_util.handleFieldOrColumn)(ge,e);return e?e.id:null},getColumnById(e){var l=te.fullColumnIdData;return e&&l[e]?l[e].column:null},getColumnByField(e){var l=te.fullColumnFieldData;return e&&l[e]?l[e].column:null},getParentColumn(e){var l=te.fullColumnIdData,e=(0,_util.handleFieldOrColumn)(ge,e);return e&&e.parentId&&l[e.parentId]?l[e.parentId].column:null},getTableColumn(){return{collectColumn:te.collectColumn.slice(0),fullColumn:te.tableFullColumn.slice(0),visibleColumn:te.visibleColumn.slice(0),tableColumn:le.tableColumn.slice(0)}},moveColumnTo(e,t,l){var{fullColumnIdData:r,visibleColumn:a}=te,{dragToChild:l,dragPos:o,isCrossDrag:i}=Object.assign({},l),e=(0,_util.handleFieldOrColumn)(ge,e);let n=null;var d=e?r[e.id]:null;let u="left";if(_xeUtils.default.isNumber(t)){if(d&&t){let e=d.items,l=d._index+t;i&&(e=a,l=d._index+t),0<l&&l<e.length-1&&(n=e[l]),0<t&&(u="right")}}else{i=(n=(0,_util.handleFieldOrColumn)(ge,t))?r[n.id]:null;d&&i&&i._index>d._index&&(u="right")}return ge.handleColDragSwapEvent(null,!0,e,n,o||u,!0===l)},moveRowTo(e,t,l){var r=K.treeConfig,{fullAllDataRowIdData:a,afterFullData:o}=te,{dragToChild:l,dragPos:i,isCrossDrag:n}=Object.assign({},l),d=ce.value,e=(0,_util.handleRowidOrRow)(ge,e);let u=null,s="top";var c=e?a[(0,_util.getRowid)(ge,e)]:null;if(_xeUtils.default.isNumber(t)){if(c&&t){let e=o,l=c._index+t;r&&(e=c.items,d.transform)&&(l=c.treeIndex+t,n)&&(e=o,l=c._index+t),0<=l&&l<=e.length-1&&(u=e[l]),0<t&&(s="bottom")}}else{r=(u=(0,_util.handleRowidOrRow)(ge,t))?a[(0,_util.getRowid)(ge,u)]:null;c&&r&&r._index>c._index&&(s="bottom")}return ge.handleRowDragSwapEvent(null,!0,e,u,i||s,!0===l)},getFullColumns(){var e=te.collectColumn;return e.slice(0)},getData(e){var l=K.data||te.tableSynchData;return _xeUtils.default.isUndefined(e)?l.slice(0):l[e]},getCheckboxRecords(e){var l=K.treeConfig,t=le.updateCheckboxFlag;let{tableFullData:r,afterFullData:a,tableFullTreeData:o,fullDataRowIdData:i,afterFullRowMaps:n,selectCheckboxMaps:d}=te;var u=ce.value,{transform:s,mapChildrenField:c}=u;let g=ue.value.checkField;u=u.children||u.childrenField;let v=[];if(t)if(g)v=l?_xeUtils.default.filterTree(e?s?o:r:s?o:a,e=>_xeUtils.default.get(e,g),{children:s?c:u}):(e?r:a).filter(e=>_xeUtils.default.get(e,g));else{let t=e||l&&!s?i:n;_xeUtils.default.each(d,(e,l)=>{t[l]&&v.push(i[l].row)})}return v},getTreeRowChildren(l){var t=K.treeConfig,r=te.fullAllDataRowIdData,a=ce.value,{transform:o,mapChildrenField:i}=a,a=a.children||a.childrenField;if(l&&t){let e;if(e=_xeUtils.default.isString(l)?l:(0,_util.getRowid)(ge,l)){t=r[e],l=t?t.row:null;if(l)return l[o?i:a]||[]}}return[]},getTreeRowLevel(l){var t=K.treeConfig,r=te.fullAllDataRowIdData;if(l&&t){let e;if(e=_xeUtils.default.isString(l)?l:(0,_util.getRowid)(ge,l)){t=r[e];if(t)return t.level}}return-1},getTreeParentRow(l){var t=K.treeConfig,r=te.fullAllDataRowIdData;if(l&&t){let e;if(e=_xeUtils.default.isString(l)?l:(0,_util.getRowid)(ge,l)){t=r[e];if(t)return t.parent}}return null},getParentRow(e){return(0,_log.warnLog)("vxe.error.delFunc",["getParentRow","getTreeParentRow"]),ge.getTreeParentRow(e)},getRowById(e){var l=te.fullAllDataRowIdData,e=_xeUtils.default.eqNull(e)?"":encodeURIComponent(e||"");return l[e]?l[e].row:null},getRowid(e){return(0,_util.getRowid)(ge,e)},getTableData(){var{tableData:e,footerTableData:l}=le,{tableFullData:t,afterFullData:r,tableFullTreeData:a}=te;return{fullData:(K.treeConfig?a:t).slice(0),visibleData:r.slice(0),tableData:e.slice(0),footerData:l.slice(0)}},getFullData(){var e,l,t,r,a=K.treeConfig,{tableFullData:o,tableFullTreeData:i}=te;return a?({transform:e,mapChildrenField:l,rowField:t,parentField:r}=a=ce.value,a=a.children||a.childrenField,e?_xeUtils.default.toArrayTree(_xeUtils.default.toTreeArray(i,{children:l}),{key:t,parentKey:r,children:a,mapChildren:l}):i.slice(0)):o.slice(0)},setColumnFixed(e,l){let t=!1;var r=_xeUtils.default.isArray(e)?e:[e],a=oe.value,o=Al.value;for(let e=0;e<r.length;e++){var i=r[e],i=(0,_util.handleFieldOrColumn)(ge,i),i=(0,_util.getRootColumn)(ge,i);if(i&&i.fixed!==l){if(!i.fixed&&o)return _ui.VxeUI.modal&&_ui.VxeUI.modal.message({status:"error",content:getI18n("vxe.table.maxFixedCol",[a.maxFixedSize])}),(0,_vue.nextTick)();_xeUtils.default.eachTree([i],e=>{e.fixed=l,e.renderFixed=l}),B.saveCustomStore("update:fixed"),t=t||!0}}return t?P.refreshColumn():(0,_vue.nextTick)()},clearColumnFixed(e){let l=!1;return(_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{e=(0,_util.handleFieldOrColumn)(ge,e),e=(0,_util.getRootColumn)(ge,e);e&&e.fixed&&(_xeUtils.default.eachTree([e],e=>{e.fixed=null,e.renderFixed=null}),B.saveCustomStore("update:fixed"),l=l||!0)}),l?P.refreshColumn():(0,_vue.nextTick)()},hideColumn(e){let l=!1;return(_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{e=(0,_util.handleFieldOrColumn)(ge,e);e&&e.visible&&(e.visible=!1,l=l||!0)}),l?B.handleCustom():(0,_vue.nextTick)()},showColumn(e){let l=!1;return(_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{e=(0,_util.handleFieldOrColumn)(ge,e);e&&!e.visible&&(e.visible=!0,l=l||!0)}),l?B.handleCustom():(0,_vue.nextTick)()},setColumnWidth(e,l){var t=te.elemStore;let r=!1;e=_xeUtils.default.isArray(e)?e:[e];let a=_xeUtils.default.toInteger(l);return(0,_dom.isScale)(l)&&(t=(l=(0,_util.getRefElem)(t["main-body-scroll"]))?l.clientWidth-1:0,a=Math.floor(a*t)),(a&&(e.forEach(e=>{e=(0,_util.handleFieldOrColumn)(ge,e);e&&(e.resizeWidth=a,r=r||!0)}),r)?ge.refreshColumn():(0,_vue.nextTick)()).then(()=>({status:r}))},getColumnWidth(e){e=(0,_util.handleFieldOrColumn)(ge,e);return e?e.renderWidth:0},resetColumn(e){return(0,_log.warnLog)("vxe.error.delFunc",["resetColumn","resetCustom"]),ge.resetCustom(e)},refreshColumn(e){return e&&$t(),zt(!0).then(()=>ge.refreshScroll()).then(()=>C(!1,!0,!0))},setRowHeightConf(e){let t=te.fullAllDataRowIdData,r=!1;return e&&(_xeUtils.default.each(e,(e,l)=>{l=t[l];l&&(e=_xeUtils.default.toInteger(e))&&(l.resizeHeight=e,r=r||!0)}),r)&&(te.isResizeCellHeight=!0,le.resizeHeightFlag++),(0,_vue.nextTick)().then(()=>(N(),{status:r}))},getRowHeightConf(r){let{fullAllDataRowIdData:a,afterFullData:e}=te,o=(0,_util.createHandleGetRowId)(ge).handleGetRowId,i=ie.value,n=O.value,d=H.value,u={};return e.forEach(e=>{var l,e=o(e),t=a[e];t&&((l=t.resizeHeight)||r)&&(l=l||n.height||i.height||t.height||d,u[e]=l)}),u},recalcRowHeight(e){let t=te.fullAllDataRowIdData;e=_xeUtils.default.isArray(e)?e:[e];let r=re.value;if(r){let l=(0,_util.createHandleGetRowId)(ge).handleGetRowId;r.setAttribute("data-calc-row","Y"),e.forEach(e=>{e=_xeUtils.default.isString(e)||_xeUtils.default.isNumber(e)?e:l(e),e=t[e];e&&(e.resizeHeight=st(e,r)),r.removeAttribute("data-calc-row")}),le.calcCellHeightFlag++}return(0,_vue.nextTick)()},setRowHeight(e,l){let t=te.fullAllDataRowIdData,r=!1;e=_xeUtils.default.isArray(e)?e:[e];let a=_xeUtils.default.toInteger(l);if((0,_dom.isScale)(l)&&(l=(l=(l=x.value)?l.$el:null)?l.clientHeight-1:0,a=Math.floor(a*l)),a){let l=(0,_util.createHandleGetRowId)(ge).handleGetRowId;e.forEach(e=>{e=_xeUtils.default.isString(e)||_xeUtils.default.isNumber(e)?e:l(e),e=t[e];e&&(e.resizeHeight=a,r=r||!0)}),r&&(te.isResizeCellHeight=!0,le.resizeHeightFlag++)}return(0,_vue.nextTick)().then(()=>({status:r}))},getRowHeight(e){var l=te.fullAllDataRowIdData,t=ie.value,r=O.value,a=H.value,l=l[_xeUtils.default.isString(e)||_xeUtils.default.isNumber(e)?e:(0,_util.getRowid)(ge,e)];return l?l.resizeHeight||r.height||t.height||l.height||a:0},refreshScroll(){let{elemStore:e,lastScrollLeft:l,lastScrollTop:t}=te,r=(0,_util.getRefElem)(e["main-header-scroll"]),a=(0,_util.getRefElem)(e["main-body-scroll"]),o=(0,_util.getRefElem)(e["main-footer-scroll"]),i=(0,_util.getRefElem)(e["left-body-scroll"]),n=(0,_util.getRefElem)(e["right-body-scroll"]),d=L.value,u=M.value;return new Promise(e=>{if(l||t)return(0,_util.restoreScrollLocation)(ge,l,t).then(()=>{setTimeout(e,10)});te.intoRunScroll=!0,(0,_dom.setScrollTop)(u,t),(0,_dom.setScrollTop)(a,t),(0,_dom.setScrollTop)(i,t),(0,_dom.setScrollTop)(n,t),(0,_dom.setScrollLeft)(d,l),(0,_dom.setScrollLeft)(a,l),(0,_dom.setScrollLeft)(r,l),(0,_dom.setScrollLeft)(o,l),setTimeout(()=>{te.intoRunScroll=!1,e()},10)})},recalculate(e){e=!!e;return C(e,e,e)},openTooltip(e,l){var t=we.value;return t&&t.open?t.open(e,l):(0,_vue.nextTick)()},closeTooltip(){var e=le.tooltipStore,l=ae.value,t=we.value;return e.visible&&(Object.assign(e,{row:null,column:null,content:null,visible:!1,type:null,currOpts:{}}),l)&&l.close&&l.close(),t&&t.close&&t.close(),(0,_vue.nextTick)()},isAllCheckboxChecked(){return le.isAllSelected},isAllCheckboxIndeterminate(){return!le.isAllSelected&&le.isIndeterminate},getCheckboxIndeterminateRecords(e){var l=K.treeConfig;let{fullDataRowIdData:a,treeIndeterminateRowMaps:o}=te;if(l){let t=[],r=[];return _xeUtils.default.each(o,(e,l)=>{e&&(t.push(e),a[l])&&r.push(e)}),e?t:r}return[]},setCheckboxRow(e,l){return e&&!_xeUtils.default.isArray(e)&&(e=[e]),_t(e,l,!0)},setCheckboxRowKey(e,l){let t=te.fullAllDataRowIdData,r=(_xeUtils.default.isArray(e)||(e=[e]),[]);return e.forEach(e=>{e=t[e];e&&r.push(e.row)}),_t(r,l,!0)},isCheckedByCheckboxRow(e){var l=le.updateCheckboxFlag,t=te.selectCheckboxMaps,r=ue.value.checkField;return r?_xeUtils.default.get(e,r):!!l&&!!t[(0,_util.getRowid)(ge,e)]},isCheckedByCheckboxRowKey(e){var l=le.updateCheckboxFlag,{fullAllDataRowIdData:t,selectCheckboxMaps:r}=te,a=ue.value.checkField;return a?!!(t=t[e])&&_xeUtils.default.get(t.row,a):!!l&&!!r[e]},isIndeterminateByCheckboxRow(e){var l=te.treeIndeterminateRowMaps;return!!l[(0,_util.getRowid)(ge,e)]&&!ge.isCheckedByCheckboxRow(e)},isIndeterminateByCheckboxRowKey(e){var l=te.treeIndeterminateRowMaps;return!!l[e]&&!ge.isCheckedByCheckboxRowKey(e)},toggleCheckboxRow(e){var l=te.selectCheckboxMaps,t=ue.value.checkField,t=t?!_xeUtils.default.get(e,t):!l[(0,_util.getRowid)(ge,e)];return B.handleBatchSelectRows([e],t,!0),B.checkSelectionStatus(),(0,_vue.nextTick)()},setAllCheckboxRow(e){return Ct(e,!0)},getRadioReserveRecord(e){var r=K.treeConfig,{fullDataRowIdData:l,radioReserveRow:a,afterFullData:o}=te,t=G.value,i=ce.value,i=i.children||i.childrenField;if(t.reserve&&a){let t=(0,_util.getRowid)(ge,a);if(e){if(!l[t])return a}else{let l=(0,_util.getRowkey)(ge);if(r){if(_xeUtils.default.findTree(o,e=>t===_xeUtils.default.get(e,l),{children:i}))return a}else if(!o.some(e=>t===_xeUtils.default.get(e,l)))return a}}return null},clearRadioReserve(){return(te.radioReserveRow=null,_vue.nextTick)()},getCheckboxReserveRecords(r){var e=K.treeConfig;let{afterFullData:a,fullDataRowIdData:o,checkboxReserveRowMap:i}=te;var l=ue.value,n=ce.value,n=n.children||n.childrenField;let d=[];if(l.reserve){let l=(0,_util.createHandleGetRowId)(ge).handleGetRowId,t={};e?_xeUtils.default.eachTree(a,e=>{t[l(e)]=1},{children:n}):a.forEach(e=>{t[l(e)]=1}),_xeUtils.default.each(i,(e,l)=>{e&&(r?o[l]||d.push(e):t[l]||d.push(e))})}return d},clearCheckboxReserve(){return te.checkboxReserveRowMap={},(0,_vue.nextTick)()},toggleAllCheckboxRow(){return qt(null,!le.isAllSelected),(0,_vue.nextTick)()},clearCheckboxRow(){let l=K.treeConfig;var e=te.tableFullData,t=ce.value,t=t.children||t.childrenField,r=ue.value;let{checkField:a,reserve:o}=r,i=r.indeterminateField||r.halfField;return a&&(r=e=>{l&&i&&_xeUtils.default.set(e,i,!1),_xeUtils.default.set(e,a,!1)},l?_xeUtils.default.eachTree(e,r,{children:t}):e.forEach(r)),o&&e.forEach(e=>xt(e,!1)),le.isAllSelected=!1,le.isIndeterminate=!1,te.selectCheckboxMaps={},te.treeIndeterminateRowMaps={},le.updateCheckboxFlag++,(0,_vue.nextTick)()},setCurrentRow(e){var l=te.xeGanttView,t=ie.value,r=re.value;return P.clearCurrentRow(),le.currentRow=e,(t.isCurrent||K.highlightCurrentRow)&&r&&_xeUtils.default.arrayEach(r.querySelectorAll(`[rowid="${(0,_util.getRowid)(ge,e)}"]`),e=>(0,_dom.addClass)(e,"row--current")),l&&l.handleUpdateCurrentRow&&l.handleUpdateCurrentRow(e),(0,_vue.nextTick)()},isCheckedByRadioRow(e){var l=le.selectRadioRow;return!(!e||!l)&&ge.eqRow(l,e)},isCheckedByRadioRowKey(e){var l=le.selectRadioRow;return!!l&&e===(0,_util.getRowid)(ge,l)},setRadioRow(e){return wt(e,!0)},setRadioRowKey(e){var l=te.fullAllDataRowIdData,l=l[e];return l?wt(l.row,!0):(0,_vue.nextTick)()},clearCurrentRow(){var e=te.xeGanttView,l=re.value;return le.currentRow=null,te.hoverRow=null,l&&_xeUtils.default.arrayEach(l.querySelectorAll(".row--current"),e=>(0,_dom.removeClass)(e,"row--current")),e&&e.handleUpdateCurrentRow&&e.handleUpdateCurrentRow(),(0,_vue.nextTick)()},clearRadioRow(){return(le.selectRadioRow=null,_vue.nextTick)()},getCurrentRecord(e){var l=le.currentRow,{fullDataRowIdData:t,afterFullRowMaps:r}=te;if(ie.value.isCurrent||K.highlightCurrentRow){var a=(0,_util.getRowid)(ge,l);if(e){if(t[a])return l}else if(r[a])return l}return null},getRadioRecord(e){var{fullDataRowIdData:l,afterFullRowMaps:t}=te,r=le.selectRadioRow;if(r){var a=(0,_util.getRowid)(ge,r);if(e){if(l[a])return r}else if(t[a])return r}return null},getCurrentColumn(){return oe.value.isCurrent||K.highlightCurrentColumn?le.currentColumn:null},setCurrentColumn(e){var l=K.mouseConfig,t=se.value;let r=l&&t.selected;l=(0,_util.handleFieldOrColumn)(ge,e);return l&&(ge.clearCurrentColumn(),le.currentColumn=l),(0,_vue.nextTick)().then(()=>{r&&ge.addCellSelectedClass()})},clearCurrentColumn(){return(le.currentColumn=null,_vue.nextTick)()},setPendingRow(e,l){let t=(0,_util.createHandleGetRowId)(ge).handleGetRowId,r=te.pendingRowMaps;return e&&!_xeUtils.default.isArray(e)&&(e=[e]),l?e.forEach(e=>{var l=t(e);l&&!r[l]&&(r[l]=e)}):e.forEach(e=>{e=t(e);e&&r[e]&&delete r[e]}),le.pendingRowFlag++,(0,_vue.nextTick)()},togglePendingRow(e){let t=(0,_util.createHandleGetRowId)(ge).handleGetRowId,r=te.pendingRowMaps;return(e=e&&!_xeUtils.default.isArray(e)?[e]:e).forEach(e=>{var l=t(e);l&&(r[l]?delete r[l]:r[l]=e)}),le.pendingRowFlag++,(0,_vue.nextTick)()},hasPendingByRow(e){return P.isPendingByRow(e)},isPendingByRow(e){var l=te.pendingRowMaps;return!!l[(0,_util.getRowid)(ge,e)]},getPendingRecords(){let{fullAllDataRowIdData:t,pendingRowMaps:e}=te,r=[];return _xeUtils.default.each(e,(e,l)=>{t[l]&&r.push(e)}),r},clearPendingRow(){return te.pendingRowMaps={},le.pendingRowFlag++,(0,_vue.nextTick)()},sort(e,l){let{multiple:t,remote:r,orders:o}=y.value;return e&&_xeUtils.default.isString(e)&&(e=[{field:e,order:l}]),(e=_xeUtils.default.isArray(e)?e:[e]).length?(t||tt(),(t?e:[e[0]]).forEach((e,l)=>{let{field:t,order:r}=e,a=t;(a=_xeUtils.default.isString(t)?P.getColumnByField(t):a)&&a.sortable&&(o&&-1===o.indexOf(r)&&(r=Vl(a)),a.order!==r&&(a.order=r),a.sortTime=Date.now()+l)}),r||B.handleTableData(!0),(0,_vue.nextTick)().then(()=>(N(),P.updateCellAreas(),F()))):(0,_vue.nextTick)()},setSort(e,l){return lt(null,e,l)},setSortByEvent(e,l){return lt(e,l,!0)},clearSort(e){var l=y.value;return e?(e=(0,_util.handleFieldOrColumn)(ge,e))&&(e.order=null):tt(),l.remote||ge.handleTableData(!0),(0,_vue.nextTick)().then(()=>(N(),F()))},clearSortByEvent(e,l){var t=te.tableFullColumn,r=y.value,a=r.multiple;let o=[],i=null;return e&&(l?(i=(0,_util.handleFieldOrColumn)(ge,l))&&(i.order=null):t.forEach(e=>{e.order&&(e.order=null,o.push(e))}),r.remote||ge.handleTableData(!0),(i=a?i:o[0])&&ge.handleColumnSortEvent(e,i),a)&&o.length&&(l={$table:ge,$event:e,cols:o,sortList:[]},W("clear-all-sort",l,e)),(0,_vue.nextTick)().then(()=>(N(),F()))},isSort(e){return e?!!(e=(0,_util.handleFieldOrColumn)(ge,e))&&e.sortable&&!!e.order:0<P.getSortColumns().length},getSortColumns(){var{multiple:e,chronological:l}=y.value;let r=[];var t=te.tableFullColumn;return t.forEach(e=>{var{field:l,order:t}=e;e.sortable&&t&&r.push({column:e,field:l,property:l,order:t,sortTime:e.sortTime})}),e&&l&&1<r.length?_xeUtils.default.orderBy(r,"sortTime"):r},setFilterByEvent(e,l,t){l=(0,_util.handleFieldOrColumn)(ge,l);return l&&l.filters?(l.filters=(0,_util.toFilters)(t||[],l.id),ge.handleColumnConfirmFilter(l,e)):(0,_vue.nextTick)()},closeFilter(){var e=le.filterStore,{column:l,visible:t}=e;return e.isAllSelected=!1,e.isIndeterminate=!1,e.visible=!1,t&&(e=l?l.field:null,W("filter-visible",{column:l,property:e,field:e,filterList:()=>ge.getCheckedFilters(),visible:!1},null)),(0,_vue.nextTick)()},isActiveFilterByColumn(e){e=(0,_util.handleFieldOrColumn)(ge,e);return e?e.filters&&e.filters.some(e=>e.checked):0<ge.getCheckedFilters().length},isFilter(e){return P.isActiveFilterByColumn(e)},clearFilterByEvent(e,r){var l=le.filterStore,a=te.tableFullColumn,t=ol.value,o=t.multiple;let i=[],n=null;if(r?(n=(0,_util.handleFieldOrColumn)(ge,r))&&ge.handleClearFilter(n):a.forEach(e=>{e.filters&&(i.push(e),ge.handleClearFilter(e))}),r&&n===l.column||Object.assign(l,{isAllSelected:!1,isIndeterminate:!1,style:null,options:[],column:null,multiple:!1,visible:!1}),t.remote||ge.updateData(),n=o?n:i[0]){a=()=>ge.getCheckedFilters();let l=[],t=[];n.filters.forEach(e=>{e.checked&&(l.push(e.value),t.push(e.data))});r={$table:ge,$event:e,column:n,field:n.field,property:n.field,values:l,datas:t,filters:a,filterList:a};ge.dispatchEvent("filter-change",r,e),ge.dispatchEvent("clear-filter",r,e)}return o&&i.length&&(l={$table:ge,$event:e,cols:i,filterList:[]},W("clear-all-filter",l,e)),(0,_vue.nextTick)()},isRowExpandLoaded(e){var l=te.fullAllDataRowIdData,l=l[(0,_util.getRowid)(ge,e)];return l&&!!l.expandLoaded},clearRowExpandLoaded(e){var{fullAllDataRowIdData:l,rowExpandLazyLoadedMaps:t}=te,r=z.value.lazy,e=(0,_util.getRowid)(ge,e),l=l[e];return r&&l&&(l.expandLoaded=!1,delete t[e]),le.rowExpandedFlag++,(0,_vue.nextTick)()},reloadRowExpand(e){var l=te.rowExpandLazyLoadedMaps,t=z.value.lazy,r=(0,_util.getRowid)(ge,e);return t&&!l[r]&&ge.clearRowExpandLoaded(e).then(()=>Et(e)),(0,_vue.nextTick)()},reloadExpandContent(e){return(0,_log.warnLog)("vxe.error.delFunc",["reloadExpandContent","reloadRowExpand"]),ge.reloadRowExpand(e)},toggleRowExpand(e){return ge.setRowExpand(e,!ge.isRowExpandByRow(e))},setAllRowExpand(e){var l=ce.value,{tableFullData:t,tableFullTreeData:r}=te,l=l.children||l.childrenField;let a=[];return K.treeConfig?_xeUtils.default.eachTree(r,e=>{a.push(e)},{children:l}):a=t,P.setRowExpand(a,e)},setRowExpand(e,l){let t=le.expandColumn,{fullAllDataRowIdData:r,rowExpandedMaps:a,rowExpandLazyLoadedMaps:o}=te,i=(0,_util.createHandleGetRowId)(ge).handleGetRowId;let{reserve:n,lazy:d,accordion:u,toggleMethod:s}=z.value,c=[],g=t?ge.getColumnIndex(t):-1,v=t?ge.getVMColumnIndex(t):-1;return e&&(_xeUtils.default.isArray(e)||(e=[e]),u&&(a={},te.rowExpandedMaps=a,e=e.slice(e.length-1,e.length)),e=s?e.filter(e=>s({$table:ge,expanded:l,column:t,columnIndex:g,$columnIndex:v,row:e,rowIndex:ge.getRowIndex(e),$rowIndex:ge.getVMRowIndex(e)})):e,l?e.forEach(e=>{var l,t=i(e);a[t]||(l=r[t],d&&!l.expandLoaded&&!o[t]?c.push(Et(e)):a[t]=e)}):e.forEach(e=>{e=i(e);a[e]&&delete a[e]}),n)&&e.forEach(e=>Tt(e,l)),le.rowExpandedFlag++,Promise.all(c).then(()=>(0,_vue.nextTick)()).then(()=>C(!0,!0,!0)).then(()=>(N(),Qt(),lr(),ge.updateCellAreas()))},isRowExpandByRow(e){var l=le.rowExpandedFlag,t=te.rowExpandedMaps,e=(0,_util.getRowid)(ge,e);return!!l&&!!t[e]},isExpandByRow(e){return(0,_log.warnLog)("vxe.error.delFunc",["isExpandByRow","isRowExpandByRow"]),P.isRowExpandByRow(e)},clearRowExpand(){var{tableFullData:e,scrollYStore:l}=te,t=z.value.reserve;let r=ge.getRowExpandRecords();return te.rowExpandedMaps={},t&&e.forEach(e=>Tt(e,!1)),le.rowExpandedFlag++,l.startIndex=0,l.endIndex=1,(0,_vue.nextTick)().then(()=>{if(r.length)return C(!0,!0,!0)}).then(()=>(N(),Qt(),lr(),ge.updateCellAreas()))},clearRowExpandReserve(){return te.rowExpandedReserveRowMap={},(0,_vue.nextTick)()},getRowExpandRecords(){let l=[];return _xeUtils.default.each(te.rowExpandedMaps,e=>{e&&l.push(e)}),l},setRowGroups(e){var{aggregateConfig:l,rowGroupConfig:t}=K,r=$.value.maxGroupSize;return l||t?(l=e?_xeUtils.default.isArray(e)?e:[e]:[],r&&l.length>r?(_ui.VxeUI.modal&&_ui.VxeUI.modal.message({status:"error",content:getI18n("vxe.table.maxGroupCol",[r])}),(0,_vue.nextTick)()):l.length?(Lt(l.map(e=>_xeUtils.default.isString(e)?e:e.field)),At(te.tableSynchData,!0)):(0,_vue.nextTick)()):((0,_log.errLog)("vxe.error.reqProp",["aggregate-config"]),(0,_vue.nextTick)())},getRowGroups(){var{aggregateConfig:e,rowGroupConfig:l}=K;let t=te.fullColumnFieldData;return e||l?(e=le.rowGroupList,e.map(({field:e})=>{var l=t[e];return l?l.column:{field:e}})):[]},getRowGroupFields(){return ge.getRowGroups().map(e=>e.field)},clearRowGroups(){var{aggregateConfig:e,rowGroupConfig:l}=K;return e||l?(Lt([]),At(te.tableSynchData,!0)):((0,_log.errLog)("vxe.error.reqProp",["aggregate-config"]),(0,_vue.nextTick)())},isRowGroupRecord(e){return(0,_log.warnLog)("vxe.error.delFunc",["isRowGroupRecord","isAggregateRecord"]),ge.isAggregateRecord(e)},isRowGroupExpandByRow(e){return(0,_log.warnLog)("vxe.error.delFunc",["isRowGroupExpandByRow","isAggregateExpandByRow"]),ge.isAggregateExpandByRow(e)},isAggregateRecord(e){var l=le.isRowGroupStatus;return l&&e.isAggregate},getAggregateContentByRow(e){var l=le.isRowGroupStatus;return l&&e&&e.isAggregate?e.groupContent:""},getAggregateRowChildren(e){var{childrenField:l,mapChildrenField:t}=$.value,r=le.isRowGroupStatus;return r&&e&&e.isAggregate&&l&&t&&e[t]||[]},isAggregateExpandByRow(e){var l=le.rowGroupExpandedFlag,t=te.rowGroupExpandedMaps;return!!l&&!!t[(0,_util.getRowid)(ge,e)]},setRowGroupExpand(e,l){return e?(_xeUtils.default.isArray(e)||(e=[e]),Vt(e,l)):(0,_vue.nextTick)()},setRowGroupExpandByField(e,r){var l=le.isRowGroupStatus,a=$.value.childrenField;if(e&&(_xeUtils.default.isArray(e)||(e=[e]),l)){let l=[],t={};if(e.forEach(e=>{t[e]=!0}),_xeUtils.default.eachTree(te.afterGroupFullData,e=>{e.isAggregate&&t[e.groupField]&&l.push(e)},{children:a}),l.length)return Vt(l,r)}return(0,_vue.nextTick)()},setAllRowGroupExpand(e){var l=te.tableFullGroupData;let t=$.value.mapChildrenField,r={};return e&&t&&_xeUtils.default.eachTree(l,e=>{e[t]&&e[t].length&&(r[(0,_util.getRowid)(ge,e)]=e)},{children:t}),te.rowGroupExpandedMaps=r,n(),ge.handleTableData(),vt(),le.rowGroupExpandedFlag++,C(!0,!0,!0)},clearRowGroupExpand(){return te.rowGroupExpandedMaps={},n(),ge.handleTableData(),vt(),le.rowGroupExpandedFlag++,C(!0,!0,!0)},getTreeExpandRecords(){let l=[];return _xeUtils.default.each(te.treeExpandedMaps,e=>{e&&l.push(e)}),l},isTreeExpandLoaded(e){var l=te.fullAllDataRowIdData,l=l[(0,_util.getRowid)(ge,e)];return l&&!!l.treeLoaded},clearTreeExpandLoaded(e){let{fullAllDataRowIdData:t,treeExpandedMaps:r}=te;var l=ce.value.transform;return e?(e=_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{var e=(0,_util.getRowid)(ge,e),l=t[e];l&&(l.treeLoaded=!1,r[e])&&delete r[e]}):_xeUtils.default.each(t,e=>{e.treeLoaded=!1}),te.treeExpandedMaps={},l&&(n(),ge.handleTableData()),le.treeExpandedFlag++,(0,_vue.nextTick)()},reloadTreeExpand(e){var l=te.treeExpandLazyLoadedMaps,t=ce.value,r=t.hasChild||t.hasChildField;let{transform:a,lazy:o}=t;t=(0,_util.getRowid)(ge,e);return o&&e[r]&&!l[t]?ge.clearTreeExpandLoaded(e).then(()=>bt(e)).then(()=>{a&&(n(),ge.handleTableData()),le.treeExpandedFlag++}).then(()=>ge.recalculate()):(0,_vue.nextTick)()},reloadTreeChilds(e){return(0,_log.warnLog)("vxe.error.delFunc",["reloadTreeChilds","reloadTreeExpand"]),ge.reloadTreeExpand(e)},toggleTreeExpand(e){return ge.setTreeExpand(e,!ge.isTreeExpandByRow(e))},setAllTreeExpand(e){var l=te.tableFullData,t=ce.value;let{transform:r,lazy:a}=t,o=t.children||t.childrenField,i=[];return _xeUtils.default.eachTree(l,e=>{var l=e[o];(a||l&&l.length)&&i.push(e)},{children:o}),ge.setTreeExpand(i,e).then(()=>{if(r)return n(),le.treeExpandedFlag++,ge.recalculate()})},setTreeExpand(e,l){var t=ce.value.transform;return e&&(e=_xeUtils.default.isArray(e)?e:[e]).length?(t?(e,l)=>{let{lastScrollLeft:t,lastScrollTop:r}=te;return Nt(e,l).then(()=>(n(),ge.handleTableData(),le.treeExpandedFlag++,vt(),(0,_vue.nextTick)())).then(()=>Dt(!0,!0,!0)).then(()=>{(0,_util.restoreScrollLocation)(ge,t,r),er(),setTimeout(()=>{ge.updateCellAreas()},30)})}:Nt)(e,l):(0,_vue.nextTick)()},isTreeExpandByRow(e){var l=le.treeExpandedFlag,t=te.treeExpandedMaps;return!!l&&!!t[(0,_util.getRowid)(ge,e)]},clearTreeExpand(){var e=te.tableFullTreeData,l=ce.value,t=l.children||l.childrenField;let{transform:r,reserve:a}=l,o=ge.getTreeExpandRecords();return te.treeExpandedMaps={},a&&_xeUtils.default.eachTree(e,e=>Rt(e,!1),{children:t}),ge.handleTableData().then(()=>{r&&(n(),ge.handleTableData()),le.treeExpandedFlag++}).then(()=>{if(er(),o.length)return ge.recalculate()})},clearTreeExpandReserve(){return te.treeExpandedReserveRowMap={},(0,_vue.nextTick)()},getScroll(){return ge.getScrollData()},getScrollData(){var{scrollXLoad:e,scrollYLoad:l,scrollbarHeight:t,scrollbarWidth:r}=le,a=te.elemStore,a=(0,_util.getRefElem)(a["main-body-scroll"]),o=a?a.scrollTop:0,i=a?a.scrollLeft:0,n=a?a.clientHeight:0,d=a?a.clientWidth:0,u=a?a.scrollHeight:0,a=a?a.scrollWidth:0;return{virtualX:e,virtualY:l,isTop:o<=0,isBottom:u<=o+n,isLeft:i<=0,isRight:a<=i+d,scrollbarHeight:t,scrollbarWidth:r,scrollTop:o,scrollLeft:i,scrollHeight:u,scrollWidth:a,clientHeight:n,clientWidth:d}},scrollTo(e,l){var t=te.elemStore,r=(0,_util.getRefElem)(t["main-header-scroll"]),a=(0,_util.getRefElem)(t["main-body-scroll"]),o=(0,_util.getRefElem)(t["main-footer-scroll"]),i=(0,_util.getRefElem)(t["left-body-scroll"]),t=(0,_util.getRefElem)(t["right-body-scroll"]),n=L.value,d=M.value;return te.intoRunScroll=!0,e&&!_xeUtils.default.isNumber(e)&&(l=e.top,e=e.left),_xeUtils.default.isNumber(e)&&((0,_dom.setScrollLeft)(n,e),(0,_dom.setScrollLeft)(a,e),(0,_dom.setScrollLeft)(r,e),(0,_dom.setScrollLeft)(o,e),Gt()),_xeUtils.default.isNumber(l)&&((0,_dom.setScrollTop)(d,l),(0,_dom.setScrollTop)(a,l),(0,_dom.setScrollTop)(i,l),(0,_dom.setScrollTop)(t,l),Yt()),le.scrollXLoad||le.scrollYLoad?new Promise(e=>{setTimeout(()=>{(0,_vue.nextTick)(()=>{te.intoRunScroll=!1,e()})},30)}):(0,_vue.nextTick)().then(()=>{te.intoRunScroll=!1})},scrollToRow(e,l){let{isAllOverflow:t,scrollYLoad:r,scrollXLoad:a}=le;var o,i,n=[];return e&&(K.treeConfig?n.push(ge.scrollToTreeRow(e)):n.push((0,_util.rowToVisible)(ge,e))),l&&n.push((l=l,o=e,i=te.fullColumnIdData,(l=(0,_util.handleFieldOrColumn)(ge,l))&&i[l.id]?(0,_util.colToVisible)(ge,l,o):(0,_vue.nextTick)())),Promise.all(n).then(()=>{if(e)return t||!r&&!a||(ct(),dt()),(0,_vue.nextTick)()})},scrollToColumn(e){var l=te.fullColumnIdData,e=(0,_util.handleFieldOrColumn)(ge,e);return e&&l[e.id]?(0,_util.colToVisible)(ge,e):(0,_vue.nextTick)()},clearScroll(){var{elemStore:e,scrollXStore:l,scrollYStore:t}=te,r=(0,_util.getRefElem)(e["main-header-scroll"]),a=(0,_util.getRefElem)(e["main-body-scroll"]),o=(0,_util.getRefElem)(e["main-footer-scroll"]),i=(0,_util.getRefElem)(e["left-body-scroll"]),e=(0,_util.getRefElem)(e["right-body-scroll"]),n=L.value,d=M.value;return te.intoRunScroll=!0,(0,_dom.setScrollLeft)(n,0),(0,_dom.setScrollLeft)(a,0),(0,_dom.setScrollLeft)(r,0),(0,_dom.setScrollLeft)(o,0),(0,_dom.setScrollTop)(d,0),(0,_dom.setScrollTop)(a,0),(0,_dom.setScrollTop)(i,0),(0,_dom.setScrollTop)(e,0),l.startIndex=0,l.visibleStartIndex=0,l.endIndex=l.visibleSize,l.visibleEndIndex=l.visibleSize,t.startIndex=0,t.visibleStartIndex=0,t.endIndex=t.visibleSize,t.visibleEndIndex=t.visibleSize,(0,_vue.nextTick)().then(()=>{te.lastScrollLeft=0,te.lastScrollTop=0,te.intoRunScroll=!1})},updateFooter(){var{showFooter:e,footerData:l,footerMethod:t}=K,{visibleColumn:r,afterFullData:a}=te;let o=[];return e&&l&&l.length?o=l.slice(0):e&&t&&(o=r.length?t({columns:r,data:a,$table:ge,$grid:J,$gantt:Q}):[]),le.footerTableData=o,ge.handleUpdateFooterMerge(),ge.dispatchEvent("footer-data-change",{visibleColumn:te.visibleColumn,footData:o},null),(0,_vue.nextTick)()},updateStatus(l,t){return(0,_vue.nextTick)().then(()=>{var e=K.editRules;if(l&&e)return ge.handleCellRuleUpdateStatus("change",l,t)})},setMergeCells(e){return K.spanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-cells","span-method"]),(l=>{let{fullAllDataRowIdData:n,fullColumnIdData:d,visibleColumn:u,afterFullData:s,mergeBodyList:c,mergeBodyMaps:g}=te;if(l){let e=(0,_util.createHandleGetRowId)(ge).handleGetRowId;(l=_xeUtils.default.isArray(l)?l:[l]).forEach(l=>{var{row:l,col:t,rowspan:r,colspan:a}=l;let o=-1,i=-1;if(_xeUtils.default.isNumber(l)?o=l:(l=(l=l?e(l):null)?n[l]:null)&&(o=l._index),_xeUtils.default.isNumber(t)?i=t:(t=(l=t?t.id:null)?d[l]:null)&&(i=t._index),-1<o&&-1<i&&(r||a)&&(r=_xeUtils.default.toNumber(r)||1,a=_xeUtils.default.toNumber(a)||1,1<r||1<a)){l=s[o],t=u[i];let e=g[o+":"+i];e?(e.rowspan=r,e.colspan=a,e._rowspan=r,e._colspan=a):(e={row:o,col:i,rowspan:r,colspan:a,_row:l,_col:t,_rowspan:r,_colspan:a},g[o+":"+i]=e,c.push(e))}})}})(e),ge.handleUpdateBodyMerge(),(0,_vue.nextTick)().then(()=>{var e=le.expandColumn,l=te.mergeBodyList;return e&&l.length&&(0,_log.warnLog)("vxe.error.errConflicts",["type=expand","merge-cells | span-method"]),ge.updateCellAreas(),F()})},removeMergeCells(e){K.spanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-cells","span-method"]);let l=(e=>{let{mergeBodyList:o,fullColumnIdData:i,fullAllDataRowIdData:n,mergeBodyMaps:d}=te,u=[];if(e){let a=(0,_util.createHandleGetRowId)(ge).handleGetRowId;(e=_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{var{row:e,col:l}=e;let t=-1,r=-1;_xeUtils.default.isNumber(e)?t=e:(e=(e=e?a(e):null)?n[e]:null)&&(t=e._index),_xeUtils.default.isNumber(l)?r=l:(l=(e=l?l.id:null)?i[e]:null)&&(r=l._index);l=_xeUtils.default.findIndexOf(o,e=>e.row===t&&e.col===r);if(-1<l){l=o.splice(l,1);let e=l[0];e&&(u.push(l[0]),d[t+":"+r])&&delete d[t+":"+r]}})}return u})(e);return ge.handleUpdateBodyMerge(),(0,_vue.nextTick)().then(()=>(ge.updateCellAreas(),F(),l))},getMergeCells(){return te.mergeBodyList.slice(0)},clearMergeCells(){return te.mergeBodyList=[],te.mergeBodyMaps={},te.mergeBodyCellMaps={},le.mergeBodyFlag++,(0,_vue.nextTick)().then(()=>F())},setMergeHeaderCells(e){return(e=>{let d=K.showCustomHeader,u=le.footerTableData,{mergeHeaderList:s,mergeHeaderMaps:c,fullColumnIdData:g}=te;if(e){let n=te.visibleColumn;(e=_xeUtils.default.isArray(e)?e:[e]).forEach(l=>{var{row:l,col:t,rowspan:r,colspan:a}=l,l=_xeUtils.default.isNumber(l)?l:-1;let o=-1;if(_xeUtils.default.isNumber(t)?o=t:(t=(t=t?t.id:null)?g[t]:null)&&(o=t._index),-1<l&&-1<o&&(r||a))if(r=_xeUtils.default.toNumber(r)||1,a=_xeUtils.default.toNumber(a)||1,!d&&1<r)(0,_log.errLog)("vxe.error.notSupportProp",["[table] show-custom-header=false","rowspan="+r,"rowspan=1"]);else if(1<r||1<a){var t=u[l],i=n[o];let e=c[l+":"+o];e?(e.rowspan=r,e.colspan=a,e._rowspan=r,e._colspan=a):(e={row:l,col:o,rowspan:r,colspan:a,_row:t,_col:i,_rowspan:r,_colspan:a},c[l+":"+o]=e,s.push(e))}})}})(e),ge.handleUpdateHeaderMerge(),(0,_vue.nextTick)().then(()=>F())},removeMergeHeaderCells(e){let l=(e=>{let{mergeHeaderList:a,fullColumnIdData:o,mergeHeaderMaps:i}=te,n=[];return e&&(e=_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{var{row:e,col:l}=e;let t=_xeUtils.default.isNumber(e)?e:-1,r=-1;_xeUtils.default.isNumber(l)?r=l:(l=(e=l?l.id:null)?o[e]:null)&&(r=l._index);l=_xeUtils.default.findIndexOf(a,e=>e.row===t&&e.col===r);if(-1<l){let e=a.splice(l,1)[0];e&&(n.push(e),i[t+":"+r])&&delete i[t+":"+r]}}),n})(e);return ge.handleUpdateHeaderMerge(),(0,_vue.nextTick)().then(()=>(F(),l))},getMergeHeaderCells(){return te.mergeHeaderList.slice(0)},clearMergeHeaderCells(){return te.mergeHeaderList=[],te.mergeHeaderMaps={},te.mergeHeaderCellMaps={},le.mergeHeadFlag++,(0,_vue.nextTick)().then(()=>F())},setMergeFooterCells(e){return K.footerSpanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-footer-cells | merge-footer-items","footer-span-method"]),(e=>{let d=le.footerTableData,{mergeFooterList:u,mergeFooterMaps:s,fullColumnIdData:c}=te;if(e){let n=te.visibleColumn;(e=_xeUtils.default.isArray(e)?e:[e]).forEach(l=>{var{row:l,col:t,rowspan:r,colspan:a}=l,l=_xeUtils.default.isNumber(l)?l:-1;let o=-1;if(_xeUtils.default.isNumber(t)?o=t:(t=(t=t?t.id:null)?c[t]:null)&&(o=t._index),-1<l&&-1<o&&(r||a)&&(r=_xeUtils.default.toNumber(r)||1,a=_xeUtils.default.toNumber(a)||1,1<r||1<a)){var t=d[l],i=n[o];let e=s[l+":"+o];e?(e.rowspan=r,e.colspan=a,e._rowspan=r,e._colspan=a):(e={row:l,col:o,rowspan:r,colspan:a,_row:t,_col:i,_rowspan:r,_colspan:a},s[l+":"+o]=e,u.push(e))}})}})(e),ge.handleUpdateFooterMerge(),(0,_vue.nextTick)().then(()=>F())},setMergeFooterItems(e){return ge.setMergeFooterCells(e)},removeMergeFooterCells(e){K.footerSpanMethod&&(0,_log.errLog)("vxe.error.errConflicts",["merge-footer-cells | merge-footer-items","footer-span-method"]);let l=(e=>{let{mergeFooterList:a,fullColumnIdData:o,mergeFooterMaps:i}=te,n=[];return e&&(e=_xeUtils.default.isArray(e)?e:[e]).forEach(e=>{var{row:e,col:l}=e;let t=_xeUtils.default.isNumber(e)?e:-1,r=-1;_xeUtils.default.isNumber(l)?r=l:(l=(e=l?l.id:null)?o[e]:null)&&(r=l._index);l=_xeUtils.default.findIndexOf(a,e=>e.row===t&&e.col===r);if(-1<l){let e=a.splice(l,1)[0];e&&(n.push(e),i[t+":"+r])&&delete i[t+":"+r]}}),n})(e);return ge.handleUpdateFooterMerge(),(0,_vue.nextTick)().then(()=>(F(),l))},removeMergeFooterItems(e){return ge.removeMergeFooterCells(e)},getMergeFooterCells(){return te.mergeFooterList.slice(0)},getMergeFooterItems(){return ge.getMergeFooterCells()},clearMergeFooterCells(){return te.mergeFooterList=[],te.mergeFooterMaps={},te.mergeFooterCellMaps={},le.mergeFootFlag++,(0,_vue.nextTick)().then(()=>F())},clearMergeFooterItems(){return ge.clearMergeFooterCells()},updateCellAreas(){var e=K.mouseConfig,l=se.value;return e&&l.area&&ge.handleRecalculateCellAreaEvent?ge.handleRecalculateCellAreaEvent():(0,_vue.nextTick)()},getCustomStoreData(){var e=K.id,l=Ll.value,{isRowGroupStatus:t,rowGroupList:r}=le;let{fullColumnFieldData:a,collectColumn:o}=te,{storage:i,checkMethod:v,storeOptions:n}=l;var l=!0===i,h=Object.assign({},!l&&i||{},n);let f=S(h.resizable,l),p=S(h.visible,l),m=S(h.fixed,l),x=S(h.sort,l);var w=S(h.aggGroup,l);let _=S(h.aggFunc,l),C={},b=[],R={},E={},T={},y={};h={resizableData:void 0,sortData:void 0,visibleData:void 0,fixedData:void 0,aggGroupData:void 0,aggFuncData:void 0};if(e){let n=0,d=0,u=0,s=0,c=0,g={};_xeUtils.default.eachTree(o,(e,l,t,r,a)=>{var o,i=e.getKey();i?(a?x&&(a=a.getKey(),a=g[a],d=1,a)&&(o={k:i},g[i]=o,a.c||(a.c=[]),a.c.push(o)):(x&&(d=1,a={k:i},g[i]=a,b.push(a)),m&&(e.fixed||"")!==(e.defaultFixed||"")&&(u=1,E[i]=e.fixed)),f&&e.resizeWidth&&(n=1,C[i]=e.renderWidth),!p||v&&!v({$table:ge,column:e})||(!e.visible&&e.defaultVisible?(s=1,R[i]=!1):e.visible&&!e.defaultVisible&&(s=1,R[i]=!0)),_&&(e.aggFunc||"")!==(e.defaultAggFunc||"")&&(c=1,y[i]=e.aggFunc)):(0,_log.errLog)("vxe.error.reqProp",[`${e.getTitle()||e.type||""} -> column.field=?`])}),n&&(h.resizableData=C),d&&(h.sortData=b),u&&(h.fixedData=E),s&&(h.visibleData=R),w&&t&&(r.forEach(e=>{e=a[e.field];e&&(T[e.column.getKey()]=!0)}),h.aggGroupData=T),c&&(h.aggFuncData=y)}else i&&(0,_log.errLog)("vxe.error.reqProp",["id"]);return h},focus(){return te.isActivated=!0,(0,_vue.nextTick)()},blur(){return(te.isActivated=!1,_vue.nextTick)()},connect(e){return ge.connectToolbar(e)},connectToolbar(e){return e?(A=e).syncUpdate({collectColumn:te.collectColumn,$table:ge}):(0,_log.errLog)("vxe.error.barUnableLink"),(0,_vue.nextTick)()}},t=>{var{editStore:e,ctxMenuStore:l,customStore:r}=le;let{mouseConfig:a,editRules:o}=K,i=re.value,n=al.value,d=ze.value;var u=nl.value;let s=e.actived;var e=_e.value,c=be.value,g=Re.value,v=Ce.value;if(!c||(0,_dom.getEventTargetNode)(t,i,"vxe-cell--filter").flag||(0,_dom.getEventTargetNode)(t,c.getRefMaps().refElem.value).flag||(0,_dom.getEventTargetNode)(t,document.body,"vxe-table--ignore-clear").flag||B.preventEvent(t,"event.clearFilter",te._currFilterParams,P.closeFilter),!g||r.btnEl===t.target||(0,_dom.getEventTargetNode)(t,document.body,"vxe-toolbar-custom-target").flag||(0,_dom.getEventTargetNode)(t,g.getRefMaps().refElem.value).flag||(0,_dom.getEventTargetNode)(t,document.body,"vxe-table--ignore-clear").flag||r.visible&&ge.closeCustom&&B.preventEvent(t,"event.clearCustom",{},()=>{ge.closeCustom(),ge.dispatchEvent("custom",{type:"close"},t)}),s.row)!1===n.autoClear||(c=s.args.cell)&&(0,_dom.getEventTargetNode)(t,c).flag||e&&(0,_dom.getEventTargetNode)(t,e.$el).flag||te._lastCallTime&&!(te._lastCallTime+50<Date.now())||(0,_dom.getEventTargetNode)(t,document.body,"vxe-table--ignore-clear").flag||B.preventEvent(t,"event.clearEdit",s.args,()=>{let e;var l;(e=(e=(e="row"===n.mode?!!(l=(l=(0,_dom.getEventTargetNode)(t,i,"vxe-body--row")).flag?P.getRowNode(l.targetElem):null)&&!ge.eqRow(l.item,s.args.row):!(0,_dom.getEventTargetNode)(t,i,"col--edit").flag)||(0,_dom.getEventTargetNode)(t,i,"vxe-header--row").flag)||(0,_dom.getEventTargetNode)(t,i,"vxe-footer--row").flag)||!K.height||le.overflowY||(l=t.target,(0,_dom.hasClass)(l,"vxe-table--body-wrapper")&&(e=t.offsetY<l.clientHeight)),!e&&(0,_dom.getEventTargetNode)(t,i).flag||setTimeout(()=>{ge.handleClearEdit(t).then(()=>{!te.isActivated&&o&&d.autoClear&&(le.validErrorMaps={})})})});else if(a&&!((0,_dom.getEventTargetNode)(t,i).flag||ee&&(0,_dom.getEventTargetNode)(t,ee.getRefMaps().refElem.value).flag||v&&(0,_dom.getEventTargetNode)(t,v.getRefMaps().refElem.value).flag||A&&(0,_dom.getEventTargetNode)(t,A.getRefMaps().refElem.value).flag)&&(ge.clearSelected&&ge.clearSelected(),u.autoClear)&&ge.getCellAreas){let e=ge.getCellAreas();e&&e.length&&!(0,_dom.getEventTargetNode)(t,document.body,"vxe-table--ignore-areas-clear").flag&&B.preventEvent(t,"event.clearAreas",{},()=>{ge.clearCellAreas(),ge.clearCopyCellArea(),W("clear-cell-area-selection",{cellAreas:e},t)})}ge.closeMenu&&l.visible&&v&&!(0,_dom.getEventTargetNode)(t,v.getRefMaps().refElem.value).flag&&ge.closeMenu();g=(0,_dom.getEventTargetNode)(t,ee?ee.getRefMaps().refElem.value:i).flag;!g&&o&&d.autoClear&&(le.validErrorMaps={}),te.isActivated=g}),rr=()=>{P.closeFilter(),ge.closeMenu&&ge.closeMenu()},ar=()=>{P.closeTooltip(),ge.closeMenu&&ge.closeMenu()},or=l=>{let{mouseConfig:e,keyboardConfig:t}=K,{filterStore:r,ctxMenuStore:a,editStore:o}=le,i=se.value,n=dl.value,d=o.actived;globalEvents.hasKey(l,GLOBAL_EVENT_KEYS.ESCAPE)&&B.preventEvent(l,"event.keydown",null,()=>{if(W("keydown-start",{},l),t&&e&&i.area&&ge.handleKeyboardCellAreaEvent)ge.handleKeyboardCellAreaEvent(l);else if((d.row||r.visible||a.visible)&&(l.stopPropagation(),ge.closeMenu&&ge.closeMenu(),P.closeFilter(),t)&&n.isEsc&&d.row){let e=d.args;ge.handleClearEdit(l),i.selected&&(0,_vue.nextTick)(()=>ge.handleSelected(e,l))}W("keydown",{},l),W("keydown-end",{},l)})},ir=z=>{te.isActivated&&ge.preventEvent(z,"event.keydown",null,()=>{var{mouseConfig:e,keyboardConfig:l,treeConfig:t,editConfig:r,highlightCurrentRow:a,highlightCurrentColumn:o}=K;let{ctxMenuStore:i,editStore:H,currentRow:n}=le;var d=te.afterFullData,u=Rl.value,s=_l.value,c=dl.value,g=se.value,v=al.value,h=ce.value,f=El.value,p=ie.value,O=oe.value,{selected:m,actived:x}=H,h=h.children||h.childrenField,w=z.keyCode,_=globalEvents.hasKey(z,GLOBAL_EVENT_KEYS.ESCAPE),C=globalEvents.hasKey(z,GLOBAL_EVENT_KEYS.BACKSPACE),$=globalEvents.hasKey(z,GLOBAL_EVENT_KEYS.TAB),b=globalEvents.hasKey(z,GLOBAL_EVENT_KEYS.ENTER),R=globalEvents.hasKey(z,GLOBAL_EVENT_KEYS.SPACEBAR),E=globalEvents.hasKey(z,GLOBAL_EVENT_KEYS.ARROW_LEFT),T=globalEvents.hasKey(z,GLOBAL_EVENT_KEYS.ARROW_UP),y=globalEvents.hasKey(z,GLOBAL_EVENT_KEYS.ARROW_RIGHT),S=globalEvents.hasKey(z,GLOBAL_EVENT_KEYS.ARROW_DOWN),G=globalEvents.hasKey(z,GLOBAL_EVENT_KEYS.DELETE),D=globalEvents.hasKey(z,GLOBAL_EVENT_KEYS.F2),F=globalEvents.hasKey(z,GLOBAL_EVENT_KEYS.CONTEXT_MENU),I=(0,_dom.hasControlKey)(z),L=z.shiftKey,M=z.altKey,k=E||T||y||S,u=u&&i.visible&&(b||R||k),U=(0,_utils.isEnableConf)(r)&&x.column&&x.row;let A=v.beforeEditMethod||v.activeMethod;if(u)z.preventDefault(),i.showChild&&(0,_utils.hasChildrenList)(i.selected)?ge.moveCtxMenu(z,i,"selectChild",E,!1,i.selected.children):ge.moveCtxMenu(z,i,"selected",y,!0,f);else if(l&&e&&g.area&&ge.handleKeyboardCellAreaEvent)ge.handleKeyboardCellAreaEvent(z);else if(_){if(ge.closeMenu&&ge.closeMenu(),ge.closeFilter(),l&&c.isEsc&&x.row){let e=x.args;ge.handleClearEdit(z),g.selected&&(0,_vue.nextTick)(()=>ge.handleSelected(e,z))}}else if(R&&l&&c.isChecked&&m.row&&m.column&&("checkbox"===m.column.type||"radio"===m.column.type))z.preventDefault(),"checkbox"===m.column.type?B.handleToggleCheckRowEvent(z,m.args):B.triggerRadioRowEvent(z,m.args);else if(D&&(0,_utils.isEnableConf)(r))U||m.row&&m.column&&(z.preventDefault(),ge.handleEdit(m.args,z));else if(F)te._keyCtx=m.row&&m.column&&s.length,clearTimeout(te.keyCtxTimeout),te.keyCtxTimeout=setTimeout(()=>{te._keyCtx=!1},1e3);else if(b&&!M&&l&&c.isEnter&&(m.row||x.row||t&&(p.isCurrent||a)&&n)){var{isLastEnterAppendRow:u,beforeEnterMethod:f,enterMethod:e}=c;if(I){if(x.row){let e=x.args;ge.handleClearEdit(z),g.selected&&(0,_vue.nextTick)(()=>{ge.handleSelected(e,z)})}}else if(m.row||x.row){let t=(m.row?m:x).args;if(L)c.enterToTab?ge.moveTabSelected(t,L,z):ge.moveEnterSelected(t,E,!0,y,!1,z);else if(c.enterToTab)ge.moveTabSelected(t,L,z);else{var _=m.row||x.row;let l=m.column||x.column;D=ge.getVTRowIndex(_),F={row:_,rowIndex:ge.getRowIndex(_),$rowIndex:ge.getVMRowIndex(_),_rowIndex:D,column:l,columnIndex:ge.getColumnIndex(l),$columnIndex:ge.getVMColumnIndex(l),_columnIndex:ge.getVTColumnIndex(l),$table:ge};if(!f||!1!==f(F)){if(u&&D>=d.length-1)return ge.insertAt({},-1).then(({row:e})=>{ge.scrollToRow(e,l),ge.handleSelected(Object.assign(Object.assign({},t),{row:e}),z)}),void ge.dispatchEvent("enter-append-row",F,z);ge.moveEnterSelected(t,E,!1,y,!0,z),e&&e(F)}}}else if(t&&(p.isCurrent||a)&&n){s=n[h];if(s&&s.length){z.preventDefault();let e=s[0],l={$table:ge,row:e,rowIndex:ge.getRowIndex(e),$rowIndex:ge.getVMRowIndex(e)};ge.setTreeExpand(n,!0).then(()=>ge.scrollToRow(e)).then(()=>ge.triggerCurrentRowEvent(z,l))}}}else if(k&&l&&c.isArrow)U||(g.selected&&m.row&&m.column?ge.moveArrowSelected(m.args,E,T,y,S,z):((T||S)&&(p.isCurrent||a)&&ge.moveCurrentRow(T,S,z),(E||y)&&(O.isCurrent||o)&&ge.moveCurrentColumn(E,y,z)));else if($&&l&&c.isTab)m.row||m.column?ge.moveTabSelected(m.args,L,z):(x.row||x.column)&&ge.moveTabSelected(x.args,L,z);else if(l&&c.isDel&&G&&(0,_utils.isEnableConf)(r)&&(m.row||m.column))U||(b=c.delMethod,M={row:m.row,rowIndex:P.getRowIndex(m.row),column:m.column,columnIndex:P.getColumnIndex(m.column),$table:ge,$grid:J,$gantt:Q},A&&!A(M))||(b?b(M):(0,_util.setCellValue)(m.row,m.column,null),P.updateFooter(),W("cell-delete-value",M,z));else if(C&&l&&c.isBack&&(0,_utils.isEnableConf)(r)&&(m.row||m.column))U||(_=c.backMethod,c.isDel&&(0,_utils.isEnableConf)(r)&&(m.row||m.column)&&(f={row:m.row,rowIndex:ge.getRowIndex(m.row),column:m.column,columnIndex:ge.getColumnIndex(m.column),$table:ge,$grid:J,$gantt:Q},A&&!A(f)||(_?_(f):((0,_util.setCellValue)(m.row,m.column,null),ge.handleEdit(m.args,z)),W("cell-backspace-value",f,z))));else if(C&&l&&t&&c.isBack&&(p.isCurrent||a)&&n){let l=_xeUtils.default.findTree(te.afterTreeFullData,e=>e===n,{children:h}).parent;if(l){z.preventDefault();let e={row:l,rowIndex:ge.getRowIndex(l),$rowIndex:ge.getVMRowIndex(l),$table:ge,$grid:J,$gantt:Q};ge.setTreeExpand(l,!1).then(()=>ge.scrollToRow(l)).then(()=>ge.triggerCurrentRowEvent(z,e))}}else if(l&&(0,_utils.isEnableConf)(r)&&c.isEdit&&!I&&(R||48<=w&&w<=57||65<=w&&w<=90||96<=w&&w<=111||186<=w&&w<=192||219<=w&&w<=222)){var{editMode:u,editMethod:D}=c;if(m.column&&m.row&&(0,_utils.isEnableConf)(m.column.editRender)){let e=v.beforeEditMethod||v.activeMethod;d={row:m.row,rowIndex:ge.getRowIndex(m.row),column:m.column,columnIndex:ge.getColumnIndex(m.column),$table:ge,$grid:J,$gantt:Q};e&&!e(Object.assign(Object.assign({},m.args),{$table:ge,$grid:J,$gantt:Q}))||(D?D(d):("insert"!==u&&(0,_util.setCellValue)(m.row,m.column,null),ge.handleEdit(m.args,z)))}}W("keydown",{},z)})},nr=e=>{var{keyboardConfig:l,mouseConfig:t}=K,{editStore:r,filterStore:a}=le,o=te.isActivated,i=se.value,n=dl.value,r=r.actived;o&&!a.visible&&(r.row||r.column||l&&n.isClip&&t&&i.area&&ge.handlePasteCellAreaEvent&&ge.handlePasteCellAreaEvent(e),W("paste",{},e))},dr=e=>{var{keyboardConfig:l,mouseConfig:t}=K,{editStore:r,filterStore:a}=le,o=te.isActivated,i=se.value,n=dl.value,r=r.actived;o&&!a.visible&&(r.row||r.column||l&&n.isClip&&t&&i.area&&ge.handleCopyCellAreaEvent&&ge.handleCopyCellAreaEvent(e),W("copy",{},e))},ur=e=>{var{keyboardConfig:l,mouseConfig:t}=K,{editStore:r,filterStore:a}=le,o=te.isActivated,i=se.value,n=dl.value,r=r.actived;o&&!a.visible&&(r.row||r.column||l&&n.isClip&&t&&i.area&&ge.handleCutCellAreaEvent&&ge.handleCutCellAreaEvent(e),W("cut",{},e))},sr=()=>{ge.closeMenu&&ge.closeMenu();var e=re.value;e&&e.clientWidth&&(Ft(),ge.updateCellAreas())},cr=e=>{var l=ae.value;clearTimeout(te.tooltipTimeout),e?P.closeTooltip():l&&l.setActived&&l.setActived(!0)},V=()=>{crossTableDragRowObj=null,me.row=null},gr=()=>{var{dragRow:e,dragCol:l}=le;(e||l)&&(hr(),vr(),pr(),V(),le.dragRow=null,le.dragCol=null)},vr=()=>{var e=re.value;if(e){let l="row--drag-origin";_xeUtils.default.arrayEach(e.querySelectorAll("."+l),e=>{(e.draggable=!1,_dom.removeClass)(e,l)})}},hr=()=>{var e=re.value;if(e){let l="col--drag-origin";_xeUtils.default.arrayEach(e.querySelectorAll("."+l),e=>{(e.draggable=!1,_dom.removeClass)(e,l)})}},fr=(e,t,r,l,a)=>{let o=re.value;if(o=Q&&t&&(i=Q.getRefMaps().refGanttContainerElem,i=i.value)?i:o){var{overflowX:i,scrollbarWidth:n,overflowY:d,scrollbarHeight:u}=le,s=te.prevDragToChild,c=o.getBoundingClientRect(),d=d?n:0,n=i?u:0,i=o.clientWidth,u=o.clientHeight;if(t){var g=Ie.value;if(g)if(l){var v=Ye.value,h=t.getBoundingClientRect();let e=t.clientHeight;t=Math.max(1,h.y-c.y);t+e>u-n&&(e=u-t-n),g.style.display="block",g.style.left=`${v?d:0}px`,g.style.top=t+"px",g.style.height=e+"px",g.style.width=i-d+"px",g.setAttribute("drag-pos",a),g.setAttribute("drag-to-child",s?"y":"n")}else g.style.display=""}else if(r){h=Le.value;if(h)if(l){var v=qe.value,t=Y.value,g=t?t.clientWidth:0,t=j.value,t=t?t.clientWidth:0,f=r.getBoundingClientRect();let e=r.clientWidth;r=Math.max(0,f.y-c.y);let l=f.x-c.x;l<g&&(e-=g-l,l=g);g=i-t-(t?0:d);l+e>g&&(e=g-l),h.style.display="block",h.style.top=r+"px",h.style.left=l+"px",h.style.width=e+"px",h.style.height=s?f.height+"px":u-r-(v?0:n)+"px",h.setAttribute("drag-pos",a),h.setAttribute("drag-to-child",s?"y":"n")}else h.style.display=""}i=Fe.value;i&&(i.style.display="block",i.style.top=Math.min(o.clientHeight-o.scrollTop-i.clientHeight,e.clientY-c.y)+"px",i.style.left=Math.min(o.clientWidth-o.scrollLeft-i.clientWidth-16,e.clientX-c.x)+"px",i.setAttribute("drag-status",l?s?"sub":"normal":"disabled"))}},pr=()=>{var e=Fe.value,l=Ie.value,t=Le.value;e&&(e.style.display=""),l&&(l.style.display=""),t&&(t.style.display="")},mr=()=>{let e=re.value;var l,t=[".vxe-body--row"];Q&&(l=Q.getRefMaps().refGanttContainerElem,(l=l.value)&&(e=l),t.push(".vxe-gantt-view--body-row",".vxe-gantt-view--chart-row")),pr(),vr(),(0,_anime.clearRowAnimate)(e,t),te.prevDragToChild=!1,le.dragRow=null,le.dragCol=null},xr=()=>{var e=re.value;pr(),hr(),(0,_anime.clearColAnimate)(e,[".vxe-table--column"]),te.prevDragToChild=!1,le.dragRow=null,le.dragCol=null},wr=(e,r,a,o,i,n,d)=>{let u=i||o;if(u){d.cell=o;var i=le.tooltipStore,{column:o,row:s}=d,{showAll:l,contentMethod:c}=r,d=c?c(d):null,c=c&&!_xeUtils.default.eqNull(d),d=c?d:_xeUtils.default.toString("html"===o.type?u.innerText:u.textContent).trim();let t=u.scrollWidth>u.clientWidth;if(d&&(l||c||t)){let l=(0,_utils.formatText)(d);Object.assign(i,{row:s,column:o,visible:!0,content:l,type:a,currOpts:r}),(0,_vue.nextTick)(()=>{var e=ae.value;e&&e.open&&e.open(t?u:n,l)})}}return(0,_vue.nextTick)()},_r=(e,l)=>{if(e){if(ee)return ee.callSlot(e,l);if(_xeUtils.default.isFunction(e))return(0,_vn.getSlotVNs)(e(l))}return[]},Cr=(B={getSetupOptions(){return getConfig()},updateAfterDataIndex:vt,callSlot:_r,getParentElem(){var e,l=re.value;return ee?(e=ee.getRefMaps().refElem.value)?e.parentNode:null:l?l.parentNode:null},getParentHeight(){var t=K.height,r=re.value;if(r){r=r.parentNode;let e=0,l=0;return r&&(Q&&(0,_dom.hasClass)(r,"vxe-gantt--table-wrapper")?l=Q.getParentHeight():J&&(0,_dom.hasClass)(r,"vxe-grid--table-wrapper")?l=J.getParentHeight():(l=r.clientHeight,e="100%"===t||"auto"===t?(0,_dom.getPaddingTopBottomSize)(r):0)),Math.floor(l-e)}return 0},getExcludeHeight(){return ee?ee.getExcludeHeight():0},defineField(e){let l=K.treeConfig,t=z.value,r=ce.value,o=G.value,i=ue.value,n=r.children||r.childrenField,d=(0,_util.getRowkey)(ge);return(e=_xeUtils.default.isArray(e)?e:[e]).map(a=>(te.tableFullColumn.forEach(l=>{var{field:t,editRender:r}=l;if(t&&!_xeUtils.default.has(a,t)&&!a[t]){let e=null;r&&(r=r.defaultValue,_xeUtils.default.isFunction(r)?e=r({column:l}):_xeUtils.default.isUndefined(r)||(e=r)),_xeUtils.default.set(a,t,e)}}),[o.labelField,i.checkField,i.labelField,t.labelField].forEach(e=>{e&&(0,_utils.eqEmptyValue)(_xeUtils.default.get(a,e))&&_xeUtils.default.set(a,e,null)}),l&&r.lazy&&_xeUtils.default.isUndefined(a[n])&&(a[n]=null),(0,_utils.eqEmptyValue)(_xeUtils.default.get(a,d))&&_xeUtils.default.set(a,d,(0,_util.getRowUniqueId)()),a))},handleTableData(e){var l=le.scrollYLoad;let{scrollYStore:t,fullDataRowIdData:a}=te;var r=te.xeGanttView;let o=te.afterFullData;e&&((()=>{var e=K.treeConfig,l=le.isRowGroupStatus,{tableFullColumn:t,tableFullData:r,tableFullTreeData:a,tableFullGroupData:n}=te,d=ol.value,u=y.value,s=$.value,c=ce.value,g=c.children||c.childrenField,{transform:c,rowField:v,parentField:h,mapChildrenField:f}=c;let{isEvery:p,remote:m,filterMethod:x}=d,{remote:w,sortMethod:_,multiple:C,chronological:b}=u,R=[],E=[];if(m&&w)l?(E=_xeUtils.default.searchTree(n,()=>!0,{original:!0,isEvery:!0,children:s.mapChildrenField,mapChildren:s.childrenField}),R=E):e&&c?(E=_xeUtils.default.searchTree(a,()=>!0,{original:!0,isEvery:p,children:f,mapChildren:g}),R=E):(R=(e?a:r).slice(0),E=R);else{let o=[],i=[];t.forEach(e=>{var{field:l,sortable:t,order:r,filters:a}=e;if(!m&&a&&a.length){let l=[],t=[];a.forEach(e=>{e.checked&&(t.push(e),l.push(e.value))}),t.length&&o.push({column:e,valueList:l,itemList:t})}!w&&t&&r&&i.push({column:e,field:l,property:l,order:r,sortTime:e.sortTime})}),C&&b&&1<i.length&&(i=_xeUtils.default.orderBy(i,"sortTime")),!m&&o.length?(d=u=>o.every(({column:l,valueList:e,itemList:t})=>{let{filterMethod:r,filterRender:a}=l;var o=(0,_utils.isEnableConf)(a)?renderer.get(a.name):null;let i=o?o.tableFilterMethod||o.filterMethod:null,n=o?o.tableFilterDefaultMethod||o.defaultTableFilterMethod||o.defaultFilterMethod:null,d=(0,_util.getCellValue)(u,l);return r?t.some(e=>r({value:e.value,option:e,cellValue:d,row:u,column:l,$table:ge})):i?t.some(e=>i({value:e.value,option:e,cellValue:d,row:u,column:l,$table:ge})):x?x({$table:ge,options:t,values:e,cellValue:d,row:u,column:l}):n?t.some(e=>n({value:e.value,option:e,cellValue:d,row:u,column:l,$table:ge})):-1<e.indexOf(_xeUtils.default.get(u,l.field))}),l?(E=_xeUtils.default.searchTree(n,d,{original:!0,isEvery:!0,children:s.mapChildrenField,mapChildren:s.childrenField}),R=E):e&&c?(E=_xeUtils.default.searchTree(a,d,{original:!0,isEvery:p,children:f,mapChildren:g}),R=E):(R=(e?a:r).filter(d),E=R)):l?(E=_xeUtils.default.searchTree(n,()=>!0,{original:!0,isEvery:!0,children:s.mapChildrenField,mapChildren:s.childrenField}),R=E):e&&c?(E=_xeUtils.default.searchTree(a,()=>!0,{original:!0,isEvery:p,children:f,mapChildren:g}),R=E):(R=(e?a:r).slice(0),E=R),!w&&i.length&&(l?(E=_?(u=_({data:E,sortList:i,$table:ge}),_xeUtils.default.isArray(u)?u:E):(t=_xeUtils.default.toTreeArray(E,{key:s.rowField,parentKey:s.parentField,children:s.mapChildrenField}),_xeUtils.default.toArrayTree(_xeUtils.default.orderBy(t,i.map(({column:e,order:l})=>[gt(e),l])),{key:s.rowField,parentKey:s.parentField,children:s.childrenField,mapChildren:s.mapChildrenField})),R=E):e&&c?(E=_?(d=_({data:E,sortList:i,$table:ge}),_xeUtils.default.isArray(d)?d:E):(n=_xeUtils.default.toTreeArray(E,{children:f}),_xeUtils.default.toArrayTree(_xeUtils.default.orderBy(n,i.map(({column:e,order:l})=>[gt(e),l])),{key:v,parentKey:h,children:g,mapChildren:f})),R=E):(R=_?(a=_({data:R,sortList:i,$table:ge}),_xeUtils.default.isArray(a)?a:R):_xeUtils.default.orderBy(R,i.map(({column:e,order:l})=>[gt(e),l])),E=R))}te.afterFullData=R,te.afterTreeFullData=E,te.afterGroupFullData=E,vt()})(),o=n());e=l?o.slice(t.startIndex,t.endIndex):o.slice(0);let i={};return e.forEach((e,l)=>{var t=(0,_util.getRowid)(ge,e),r=a[t];r&&(r.$index=l),i[t]=e}),le.tableData=e,te.visibleDataRowIdData=i,r&&r.updateViewData&&r.updateViewData(),(0,_vue.nextTick)()},cacheRowMap(e){let s=K.treeConfig;var l=le.isRowGroupStatus;let{currKeyField:u,fullAllDataRowIdData:t,tableFullData:r,tableFullTreeData:a,tableFullGroupData:o,treeExpandedMaps:c,rowExpandedMaps:g,selectCheckboxMaps:v}=te,h=e?{}:Object.assign({},t),f={},p={},m=(0,_util.createHandleUpdateRowId)(ge).handleUpdateRowId,x=(e,l,t,r,a,o,i,n)=>{let d=h[o];p[o]&&(0,_log.errLog)("vxe.error.repeatKey",[u,o]),d||(d={row:e,rowid:o,seq:n,index:-1,_index:-1,$index:-1,treeIndex:l,_tIndex:-1,items:t,parent:a,level:i,height:0,resizeHeight:0,oTop:0,expandHeight:0},f[o]=d,h[o]=d),d.treeLoaded=!1,d.expandLoaded=!1,d.row=e,d.items=t,d.parent=a,d.level=i,d.index=r,d.treeIndex=l,v[o]&&(v[o]=e),g[o]&&(g[o]=e),p[o]=!0,f[o]=d,h[o]=d};if(s){var e=ce.value;let n=e.lazy,d=e.children||e.childrenField,u=e.hasChild||e.hasChildField;_xeUtils.default.eachTree(a,(e,l,t,r,a,o)=>{var i=m(e);s&&n&&(e[u]&&void 0===e[d]&&(e[d]=null),!c[i]||e[d]&&e[d].length||delete c[i]),x(e,l,t,a?-1:l,a,i,o.length-1,(0,_util.toTreePathSeq)(r))},{children:d})}else l?(e=$.value.mapChildrenField,_xeUtils.default.eachTree(o,(e,l,t,r,a,o)=>{var i=m(e);x(e,l,t,a?-1:l,a,i,o.length-1,(0,_util.toTreePathSeq)(r))},{children:e})):r.forEach((e,l,t)=>{x(e,l,t,l,null,m(e),0,l+1)});te.fullDataRowIdData=f,te.fullAllDataRowIdData=h,le.treeExpandedFlag++},cacheSourceMap(e){var l=K.treeConfig,t=ce.value,e=_xeUtils.default.clone(e,!0);let r=(0,_util.createHandleUpdateRowId)(ge).handleUpdateRowId,a={};var o=e=>{var l=r(e);a[l]=e};l?(l=t.children||t.childrenField,_xeUtils.default.eachTree(e,o,{children:t.transform?t.mapChildrenField:l})):e.forEach(o),te.sourceDataRowIdData=a,te.tableSourceData=e},analyColumnWidth(){var e=te.tableFullColumn;let{width:l,minWidth:t}=oe.value,r=[],a=[],o=[],i=[],n=[],d=[],u=[],s=[];e.forEach(e=>{l&&!e.width&&(e.width=l),t&&!e.minWidth&&(e.minWidth=t),e.visible&&(e.resizeWidth?r:"auto"===e.width?u:(0,_dom.isPx)(e.width)?a:(0,_dom.isScale)(e.width)?n:(0,_dom.isPx)(e.minWidth)?o:"auto"===e.minWidth?i:(0,_dom.isScale)(e.minWidth)?d:s).push(e)}),Object.assign(le.columnStore,{resizeList:r,pxList:a,pxMinList:o,autoMinList:i,scaleList:n,scaleMinList:d,autoList:u,remainList:s})},handleColResizeMousedownEvent(l,t,r){l.stopPropagation(),l.preventDefault();var a=r.column,{columnStore:o,overflowX:i,scrollbarHeight:n}=le;let R=te.visibleColumn;var{leftList:o,rightList:E}=o;let T=Ze.value,y=i?n:0,S=re.value,D=Y.value;i=j.value;let F=ye.value;if(F){let m="left"===t,x="right"===t,w=F.firstElementChild,_=qe.value,C=l.clientX;n=l.target;let e=n.parentElement,b=a;var t=a.children&&a.children.length;if(t&&(b=(0,_util.getLastChildColumn)(a),t)&&(t=(a=e?e.parentElement:null)?a.parentElement:null,e=t?t.querySelector(`.vxe-header--column[colid="${b.id}"]`):null),e){a=_xeUtils.default.assign(r,{cell:e,$table:ge});let d=0,u=S.getBoundingClientRect(),s=i?i.getBoundingClientRect():null;var t=e.getBoundingClientRect(),i=n.getBoundingClientRect(),n=n.clientWidth,I=_xeUtils.default.floor(n/2);let c=i.x-u.x+I,g=(0,_util.getColReMinWidth)(a)-I,v=x?0:t.x-u.x+n+g,h=t.x-u.x+e.clientWidth-g,f=0,p=0;if(m||x){let l=!1;var L=m?o:E;for(let e=0;e<L.length;e++){var M=L[e];l?f+=M.renderWidth:(l=M.id===b.id)||(p+=M.renderWidth)}}i=l=>{l.stopPropagation(),l.preventDefault();var t=S.clientHeight,r=l.clientX-C;let e=c+r;m?s&&(e=Math.min(e,s.x-u.x-f-g)):x&&(D&&(e=Math.max(e,D.clientWidth+p+g)),e=Math.min(e,h)),d=Math.max(e,v);r=Math.max(1,d);if(F.style.left=r+"px",F.style.top=`${_?y:0}px`,F.style.height=`${_?t-y:t}px`,T.showDragTip&&w){w.textContent=getI18n("vxe.table.resizeColTip",[Math.floor(b.renderWidth+(x?c-d:d-c))]);var a=S.clientWidth,o=F.clientWidth,i=w.clientWidth,n=w.clientHeight;let e=-i;r<i+o?e=0:a<r&&(e+=a-r),w.style.left=e+"px",w.style.top=Math.min(t-n,Math.max(0,l.clientY-u.y-n/2))+"px"}le.isDragResize=!0};le.isDragResize=!0,(0,_dom.addClass)(S,"col-drag--resize"),F.style.display="block",document.onmousemove=i,document.onmouseup=function(e){document.onmousemove=null,document.onmouseup=null,F.style.display="none",te._lastResizeTime=Date.now(),setTimeout(()=>{le.isDragResize=!1},50);var l=b.renderWidth+(x?c-d:d-c),t=Object.assign(Object.assign({},r),{resizeWidth:l,resizeColumn:b});"fixed"===T.dragMode&&R.forEach(e=>{e.id===b.id||e.resizeWidth||(e.resizeWidth=e.renderWidth)}),ge.handleColResizeCellAreaEvent?ge.handleColResizeCellAreaEvent(e,t):(b.resizeWidth=l,Kt(e,t)),(0,_dom.removeClass)(S,"col-drag--resize")},i(l),ge.closeMenu&&ge.closeMenu()}}},handleColResizeDblclickEvent(t,r){var a=Ze.value.isDblclickAutoWidth,o=re.value;if(a&&o){t.stopPropagation(),t.preventDefault();var a=te.fullColumnIdData,i=r.column;let l=i;i.children&&i.children.length&&_xeUtils.default.eachTree(i.children,e=>{l=e});i=a[l.id],a=t.target.parentNode,a=Object.assign(r,{cell:a,$table:ge}),a=(0,_util.getColReMinWidth)(a);o.setAttribute("data-calc-col","Y");let e=nt(l,o);o.removeAttribute("data-calc-col"),i&&(e=Math.max(e,i.width)),e=Math.max(a,e);o=Object.assign(Object.assign({},r),{resizeWidth:e,resizeColumn:l});le.isDragResize=!1,te._lastResizeTime=Date.now(),ge.handleColResizeDblclickCellAreaEvent?ge.handleColResizeDblclickCellAreaEvent(t,o):(l.resizeWidth=e,Kt(t,o))}},handleRowResizeMousedownEvent(r,a){r.stopPropagation(),r.preventDefault();let o=a.row;var i=K.showOverflow,{overflowX:n,scrollbarWidth:h,overflowY:f,scrollbarHeight:p}=le,{elemStore:m,fullAllDataRowIdData:x}=te;let w=f?h:0,_=n?p:0,C=Ye.value,b=Ze.value;f=ie.value,h=O.value;let R=re.value,E=(Q&&(n=Q.getRefMaps().refGanttContainerElem,p=n.value)&&(R=p),Se.value);if(E){let g=r.clientY,v=E.firstElementChild;n=r.currentTarget.parentNode,p=n.parentNode;if((0,_util.getRefElem)(m["main-body-scroll"])){let t=x[(0,_util.getRowid)(ge,o)];if(t){m=H.value;let d=t.resizeHeight||h.height||f.height||t.height||m,u=(i||(d=n.clientHeight),R.getBoundingClientRect());x=p.getBoundingClientRect();let e=g-x.y-p.clientHeight,s=d;h=n.querySelector(".vxe-cell");let l=0,c=(h&&(f=getComputedStyle(h),l=Math.max(1,Math.ceil(_xeUtils.default.toNumber(f.paddingTop)+_xeUtils.default.toNumber(f.paddingBottom)))),x.y-u.y+l);m=t=>{t.stopPropagation(),t.preventDefault();var r=R.clientWidth-w,a=R.clientHeight-_;let o=t.clientY-u.y-e;if(o<c?o=c:s=Math.max(l,d+t.clientY-g),E.style.left=`${C?w:0}px`,E.style.top=o+"px",E.style.width=r+"px",b.showDragTip&&v){v.textContent=getI18n("vxe.table.resizeRowTip",[s]);var i=v.clientWidth,n=v.clientHeight;let e=Math.max(2,t.clientX-u.x),l=0;e+i>=r-2&&(e=r-i-2),o+n>=a&&(l=a-(o+n)),v.style.left=e+"px",v.style.top=l+"px"}le.isDragResize=!0};le.isDragResize=!0,(0,_dom.addClass)(R,"row-drag--resize"),E.style.display="block",document.onmousemove=m,document.onmouseup=function(e){var l;document.onmousemove=null,document.onmouseup=null,E.style.display="none",te._lastResizeTime=Date.now(),setTimeout(()=>{le.isDragResize=!1},50),s!==d&&(l=Object.assign(Object.assign({},a),{resizeHeight:s,resizeRow:o}),te.isResizeCellHeight=!0,ge.handleRowResizeCellAreaEvent?ge.handleRowResizeCellAreaEvent(e,l):(t.resizeHeight=s,Zt(e,l),N())),(0,_dom.removeClass)(R,"row-drag--resize")},m(r)}}}},handleRowResizeDblclickEvent(a,o){var e=Ze.value.isDblclickAutoHeight;let i=re.value;if(e&&i){a.stopPropagation(),a.preventDefault();var e=le.editStore,l=te.fullAllDataRowIdData,e=e.actived;let t=o.row,r=l[(0,_util.getRowid)(ge,t)];r&&(l=()=>{i.setAttribute("data-calc-row","Y");var e=st(r,i),l=(i.removeAttribute("data-calc-row"),Object.assign(Object.assign({},o),{resizeHeight:e,resizeRow:t}));le.isDragResize=!1,te._lastResizeTime=Date.now(),ge.handleRowResizeDblclickCellAreaEvent?ge.handleRowResizeDblclickCellAreaEvent(a,l):(r.resizeHeight=e,Zt(a,l))},e.row||e.column?ge.clearEdit().then(l):l())}},saveCustomStore(e){var l=K.customConfig,t=v.value,r=Ll.value,{updateStore:a,storage:o,storeOptions:i}=r,n=!0===o,i=Object.assign({},!n&&o||{},i),d=S(i.resizable,n),u=S(i.visible,n),s=S(i.fixed,n),c=S(i.sort,n),g=S(i.aggGroup,n),i=S(i.aggFunc,n);if("reset"!==e&&(le.isCustomStatus=!0),o&&(l?(0,_utils.isEnableConf)(r):r.enabled)&&(d||u||s||c||g||i)){if(!t)return(0,_log.errLog)("vxe.error.reqProp",["id"]),(0,_vue.nextTick)();n="reset"===e?{resizableData:{},sortData:[],visibleData:{},fixedData:{},aggGroupData:{},aggFuncData:{}}:P.getCustomStoreData();if(a)return a({$table:ge,id:t,type:e,storeData:n});o=t,l="reset"===e?null:n,r=getConfig().version,(d=ql())[o]=l||void 0,d._v=r,localStorage.setItem(customStorageKey,_xeUtils.default.toJSONString(d))}return(0,_vue.nextTick)()},handleCustom(){var e=K.mouseConfig;return e&&(ge.clearSelected&&ge.clearSelected(),ge.clearCellAreas)&&(ge.clearCellAreas(),ge.clearCopyCellArea()),B.analyColumnWidth(),P.refreshColumn(!0)},handleUpdateDataQueue(){le.upDataFlag++},handleRefreshColumnQueue(){le.reColumnFlag++},handleFilterOptions(a){if(a){var e=le.filterStore,{filterRender:l,filters:t}=a,t=t||[],l=(0,_utils.isEnableConf)(l)?renderer.get(l.name):null;let r=a.filterRecoverMethod||(l?l.tableFilterRecoverMethod||l.filterRecoverMethod:null);e.column=a,t.forEach(e=>{var{_checked:l,checked:t}=e;(e._checked=t)||l===t||r&&r({option:e,column:a,$table:ge})}),ge.checkFilterOptions()}},preventEvent(l,e,t,r,a){let o=interceptor.get(e),i=(o.length||"event.clearEdit"!==e||(o=interceptor.get("event.clearActived")).length&&(0,_log.warnLog)("vxe.error.delEvent",["event.clearActived","event.clearEdit"]),null),n=!1;for(let e=0;e<o.length;e++){var d=(0,o[e])(Object.assign({$table:ge,$grid:J,gantt:Q,$event:l},t));if(!1===d){n=!0;break}if(d&&!1===d.status){i=d.result,n=!0;break}}return n||r&&(i=r()),a&&a(),i},updateCheckboxStatus(){var e=K.treeConfig,l=le.isRowGroupStatus;let{afterTreeFullData:t,afterGroupFullData:a,selectCheckboxMaps:u,treeIndeterminateRowMaps:s}=te;var n=$.value,c=ce.value;let g=c.children||c.childrenField,{checkField:v,indeterminateField:h,checkStrictly:r,checkMethod:f}=ue.value;if(!r){if(l||e){let d=(0,_util.createHandleGetRowId)(ge).handleGetRowId,o={},i=[];if(l){let r=n.mapChildrenField;r&&_xeUtils.default.eachTree(a,e=>{var l=d(e),t=e[r];t&&t.length&&!o[l]&&(o[l]=1,i.unshift([e,l,t]))},{children:r})}else if(e){let{transform:r,mapChildrenField:a}=c;_xeUtils.default.eachTree(t,e=>{var l=d(e),t=e[r?a:g];t&&t.length&&!o[l]?(o[l]=1,i.unshift([e,l,t])):h&&_xeUtils.default.set(e,h,!1)},{children:r?a:g})}i.forEach(e=>{var l=e[0],t=e[1],e=e[2];let r=0,a=0,o=0;var i=e.length;e.forEach(f?e=>{var l=d(e),t=v?_xeUtils.default.get(e,v):u[l];f({$table:ge,row:e})?(t?r++:s[l]&&a++,o++):t?r++:s[l]&&a++}:e=>{var l=d(e);(v?_xeUtils.default.get(e,v):u[l])?r++:s[l]&&a++,o++});let n=!1;e=!(n=0<i?0<o?(0<r||0<a)&&r>=o:0<r&&r>=o||!!u[t]:u[t])&&(0<r||0<a);v&&_xeUtils.default.set(l,v,n),h&&_xeUtils.default.set(l,h,e),n?(v||(u[t]=l),s[t]&&delete s[t]):(v||u[t]&&delete u[t],e?s[t]=l:s[t]&&delete s[t])})}le.updateCheckboxFlag++}},updateAllCheckboxStatus(){var e=K.treeConfig;let a=le.isRowGroupStatus,{afterFullData:l,afterTreeFullData:t,afterGroupFullData:r,checkboxReserveRowMap:o,selectCheckboxMaps:i,treeIndeterminateRowMaps:n}=te,d=$.value.mapChildrenField,{checkField:u,checkMethod:s,showReserveStatus:c}=ue.value,g=(0,_util.createHandleGetRowId)(ge).handleGetRowId,v=0,h=0,f=0,p=0,m=0;e=e?t:a?r:l,e.forEach(s?e=>{var l,t=g(e),r=u?_xeUtils.default.get(e,u):i[t];a&&ge.isAggregateRecord(e)?(l=e[d||""],r?(m++,v++):n[t]?(m++,f++):l&&l.length&&l.some(e=>s({$table:ge,row:e}))&&m++):s({$table:ge,row:e})?(r?v++:n[t]&&f++,m++):r?h++:n[t]&&p++}:e=>{var l=g(e);(u?_xeUtils.default.get(e,u):i[l])?v++:n[l]&&f++,m++}),e=0<e.length&&(0<m?v>=m:v>=e.length);let x=!e&&(0<v||0<f||0<h||0<p);e||x||!c||(x=!_xeUtils.default.isEmpty(o)),le.isAllSelected=e,le.isIndeterminate=x},checkSelectionStatus(){ge.updateCheckboxStatus(),ge.updateAllCheckboxStatus()},handleBatchSelectRows(e,t,r){var l=K.treeConfig,a=le.isRowGroupStatus;let o=te.selectCheckboxMaps;var i=$.value,n=ce.value,{transform:d,mapChildrenField:u}=n,n=n.children||n.childrenField,s=ue.value;let{checkField:c,checkStrictly:g,checkMethod:v}=s,h=(0,_util.createHandleGetRowId)(ge).handleGetRowId,f=s.indeterminateField||s.halfField;if(c)!l&&!a||g?e.forEach(e=>{!r&&v&&!v({$table:ge,row:e})||(_xeUtils.default.set(e,c,t),xt(e,t))}):_xeUtils.default.eachTree(e,e=>{!r&&v&&!v({$table:ge,row:e})||(_xeUtils.default.set(e,c,t),f&&_xeUtils.default.set(e,f,!1),xt(e,t))},{children:d?u:n}),le.updateCheckboxFlag++;else{if(!g){if(a)return _xeUtils.default.eachTree(e,e=>{var l=h(e);!r&&v&&!v({$table:ge,row:e})||(t?o[l]=e:o[l]&&delete o[l],xt(e,t))},{children:i.mapChildrenField}),void le.updateCheckboxFlag++;if(l)return _xeUtils.default.eachTree(e,e=>{var l=h(e);!r&&v&&!v({$table:ge,row:e})||(t?o[l]=e:o[l]&&delete o[l],xt(e,t))},{children:d?u:n}),void le.updateCheckboxFlag++}e.forEach(e=>{var l=h(e);!r&&v&&!v({$table:ge,row:e})||(t?o[l]||(o[l]=e):o[l]&&delete o[l],xt(e,t),le.updateCheckboxFlag++)})}},handleSelectRow({row:e},l,t){ge.handleBatchSelectRows([e],l,t)},handleUpdateBodyMerge(){var e=te.mergeBodyList;te.mergeBodyCellMaps=et(e),le.mergeBodyFlag++},handleUpdateHeaderMerge(){var e=te.mergeHeaderList;te.mergeHeaderCellMaps=et(e),le.mergeHeadFlag++},handleUpdateFooterMerge(){var e=te.mergeFooterList;te.mergeFooterCellMaps=et(e),le.mergeFootFlag++},handleAggregateSummaryData(){return(()=>{var{aggregateConfig:e,rowGroupConfig:l}=K,t=le.isRowGroupStatus,r=te.tableFullGroupData,a=$.value.mapChildrenField;if((e||l)&&t){let l=[];_xeUtils.default.eachTree(r,e=>{e.isAggregate&&l.push(e)},{children:a}),Mt(l)}})()},triggerHeaderTitleEvent(t,e,r){var a=e.content||e.message;if(a){var o=le.tooltipStore,r=r.column;let l=(0,_utils.getFuncText)(a);cr(!0),o.row=null,o.column=r,o.visible=!0,o.currOpts=e,(0,_vue.nextTick)(()=>{var e=ae.value;e&&e.open&&e.open(t.currentTarget,l)})}},triggerHeaderTooltipEvent(e,l){var t,r,a=le.tooltipStore,o=el.value,i=l.column,e=(cr(!0),e.currentTarget);(e=e&&e.parentElement)&&(t=e.parentElement)&&(r=t.parentElement)&&(a.column!==i||!a.visible)&&(i=r.querySelector(".vxe-cell--title"),wr(0,o,"header",r,((0,_dom.hasClass)(r,"col--ellipsis")?i:e)||e,i||t,l))},triggerBodyTooltipEvent(t,r){var a=K.editConfig,e=le.editStore,l=le.tooltipStore,o=Qe.value,i=al.value,e=e.actived,{row:n,column:d}=r,t=t.currentTarget;if(cr(l.column!==d||l.row!==n),d.editRender&&(0,_utils.isEnableConf)(a)){if("row"===i.mode&&e.row===n)return;if(e.row===n&&e.column===d)return}if(l.column!==d||l.row!==n||!l.visible){a=t.querySelector(".vxe-cell--wrapper");let e=null,l=t.querySelector("html"===d.type?".vxe-cell--html":".vxe-cell--label");d.treeNode&&(e=t.querySelector(".vxe-tree-cell")),l=l||a,wr(0,o,"body",t,e||a,l,r)}},triggerFooterTooltipEvent(t,r){var a=r.column,o=le.tooltipStore,i=ll.value,t=t.currentTarget;if(cr(o.column!==a||!!o.row),o.column!==a||!o.visible){o=t.querySelector(".vxe-cell--wrapper");let e=null,l=t.querySelector("html"===a.type?".vxe-cell--html":".vxe-cell--label");"html"===a.type&&(e=t.querySelector(".vxe-cell--html")),l=l||o,wr(0,i,"footer",t,e||o,l,r)}},handleTargetLeaveEvent(){var e=Qe.value;let l=ae.value;l&&l.setActived&&l.setActived(!1),e.enterable?te.tooltipTimeout=setTimeout(()=>{(l=ae.value)&&l.isActived&&!l.isActived()&&ge.closeTooltip()},e.leaveDelay):ge.closeTooltip()},triggerHeaderCellClickEvent(e,l){var t=te._lastResizeTime,r=y.value,a=oe.value,o=Xe.value,i=l.column,n=e.currentTarget,t=t&&t>Date.now()-300,d=(0,_dom.getEventTargetNode)(e,n,"vxe-cell--sort").flag,u=(0,_dom.getEventTargetNode)(e,n,"vxe-cell--filter").flag;"cell"!==r.trigger||t||d||u||ge.triggerSortEvent(e,i,Vl(i)),W("header-cell-click",Object.assign({triggerResizable:t,triggerSort:d,triggerFilter:u,cell:n},l),e),!a.isCurrent&&!K.highlightCurrentColumn||o.trigger&&!["header","default"].includes(o.trigger)||ge.triggerCurrentColumnEvent(e,l)},triggerHeaderCellDblclickEvent(e,l){W("header-cell-dblclick",Object.assign({cell:e.currentTarget},l),e)},triggerCellClickEvent(e,l){var t,r,a,o,i,n,d,u,s,c,g,v,h,f,p,m,x,w,_,C,b,R,E,{treeConfig:T,highlightCurrentRow:y,highlightCurrentColumn:S,editConfig:D,aggregateConfig:F,rowGroupConfig:I}=K,{editStore:L,isDragResize:M,expandColumn:k,checkboxColumn:U,radioColumn:A}=le;M||(M=z.value,t=al.value,r=ce.value,a=G.value,o=ue.value,i=dl.value,n=$.value,d=ie.value,u=oe.value,s=Xe.value,{actived:L,focused:c}=L,{row:g,column:v}=l,{type:p,treeNode:h,rowGroupNode:f}=v,m="checkbox"===p,x="expand"===p,w=e.currentTarget,_=(p="radio"===p)&&(0,_dom.getEventTargetNode)(e,w,"vxe-cell--radio").flag,C=m&&(0,_dom.getEventTargetNode)(e,w,"vxe-cell--checkbox").flag,b=h&&(0,_dom.getEventTargetNode)(e,w,"vxe-cell--tree-btn").flag,R=x&&(0,_dom.getEventTargetNode)(e,w,"vxe-table--expanded").flag,E=x&&(0,_dom.getEventTargetNode)(e,w,"vxe-row-group--node-btn").flag,l=Object.assign({cell:w,triggerRadio:_,triggerCheckbox:C,triggerTreeNode:b,triggerExpandNode:R},l),C||_||(!R&&(k&&"row"===M.trigger||x&&"cell"===M.trigger)&&ge.triggerRowExpandEvent(e,l),T&&("row"===r.trigger||h&&"cell"===r.trigger)&&ge.triggerTreeExpandEvent(e,l),(F||I)&&("row"===n.trigger||f&&"cell"===n.trigger)&&ge.triggerRowGroupExpandEvent(e,l)),b||(R||E||(!d.isCurrent&&!y||C||_||ge.triggerCurrentRowEvent(e,l),!u.isCurrent&&!S||s.trigger&&!["cell","default"].includes(s.trigger)||C||_||ge.triggerCurrentColumnEvent(e,l),!_&&(A&&"row"===a.trigger||p&&"cell"===a.trigger)&&ge.triggerRadioRowEvent(e,l),!C&&(U&&"row"===o.trigger||m&&"cell"===o.trigger)&&ge.handleToggleCheckRowEvent(e,l)),(0,_utils.isEnableConf)(D)&&(i.arrowCursorLock&&e&&"cell"===t.mode&&e.target&&/^input|textarea$/i.test(e.target.tagName)&&(c.column=v,c.row=g),"manual"===t.trigger?L.args&&L.row===g&&v!==L.column&&ft(e,l):L.args&&g===L.row&&v===L.column||("click"===t.trigger||"dblclick"===t.trigger&&"row"===t.mode&&L.row===g)&&ft(e,l))),(0,_utils.isEnableConf)(D)&&"dblclick"===t.trigger&&L.row&&L.column&&("row"===t.mode?ge.eqRow(L.row,g)||ge.handleClearEdit(e):"cell"!==t.mode||ge.eqRow(L.row,g)&&L.column.id===v.id||ge.handleClearEdit(e)),W("cell-click",l,e))},triggerCellDblclickEvent(e,l){var t,r=K.editConfig,{editStore:a,isDragResize:o}=le;o||(o=al.value,a=a.actived,t=e.currentTarget,l=Object.assign({cell:t},l),!(0,_utils.isEnableConf)(r)||"dblclick"!==o.trigger||a.args&&e.currentTarget===a.args.cell||("row"===o.mode?ht("blur").catch(e=>e).then(()=>{ge.handleEdit(l,e).then(()=>ht("change")).catch(e=>e)}):"cell"===o.mode&&ge.handleEdit(l,e).then(()=>ht("change")).catch(e=>e)),W("cell-dblclick",l,e))},handleToggleCheckRowEvent(l,t){var r=te.selectCheckboxMaps,{checkField:a,trigger:e}=ue.value,o=t.row;if("manual"!==e){let e=!1;e=a?!_xeUtils.default.get(o,a):!r[(0,_util.getRowid)(ge,o)],l?ge.triggerCheckRowEvent(l,t,e):(ge.handleBatchSelectRows([o],e),ge.checkSelectionStatus())}},triggerCheckRowEvent(l,t,e){var r=K.treeConfig,a=t.row,o=le.isRowGroupStatus,i=te.afterFullData,n=ue.value,{checkMethod:d,trigger:u}=n;if("manual"!==u){if(l.stopPropagation(),n.isShiftKey&&l.shiftKey&&!r&&!o){u=ge.getCheckboxRecords();if(u.length){n=u[0],r=ge.getVTRowIndex(a),u=ge.getVTRowIndex(n);if(r!==u){ge.setAllCheckboxRow(!1);let e=r<u?i.slice(r,u+1):i.slice(u,r+1);return(0,_vue.nextTick)(()=>{_t(e,!0,!1)}),void W("checkbox-range-select",Object.assign({rangeRecords:e},t),l)}}}!o&&d&&!d({$table:ge,row:a})||(ge.handleBatchSelectRows([a],e),ge.checkSelectionStatus(),W("checkbox-change",Object.assign({records:()=>ge.getCheckboxRecords(),reserves:()=>ge.getCheckboxReserveRecords(),indeterminates:()=>ge.getCheckboxIndeterminateRecords(),checked:e},t),l))}},triggerCheckAllEvent(e,l){var t=ue.value.trigger;"manual"!==t&&(e&&e.stopPropagation(),qt(e,l))},triggerRadioRowEvent(t,r){var a=le.selectRadioRow,o=r.row,i=G.value,{trigger:e,checkMethod:l}=i;if("manual"!==e&&(t.stopPropagation(),!l||l({$table:ge,row:o}))){let e=o,l=a!==e;l?wt(e):i.strict||(l=a===e)&&(e=null,ge.clearRadioRow()),l&&W("radio-change",Object.assign({oldValue:a,newValue:e},r),t)}},triggerCurrentColumnEvent(e,l){var t=le.currentColumn,r=oe.value,a=Xe.value,r=a.beforeSelectMethod||r.currentMethod,o=l.column,a=a.trigger;"manual"!==a&&(a=t!==o,!r||r({column:o,$table:ge})?(ge.setCurrentColumn(o),a&&W("current-column-change",Object.assign({oldValue:t,newValue:o},l),e)):W("current-column-disabled",l,e))},triggerCurrentRowEvent(e,l){var t=le.currentRow,r=ie.value,a=Ke.value,r=a.beforeSelectMethod||r.currentMethod,o=l.row,a=a.trigger;"manual"!==a&&(a=t!==o,!r||r({row:o,$table:ge})?(ge.setCurrentRow(o),a&&(W("current-row-change",Object.assign({oldValue:t,newValue:o},l),e),W("current-change",Object.assign({oldValue:t,newValue:o},l),e))):W("current-row-disabled",l,e))},triggerRowExpandEvent(e,l){var t=le.expandColumn,r=te.rowExpandLazyLoadedMaps,l=l.row,{lazy:a,trigger:o}=z.value;"manual"===o||(e.stopPropagation(),o=(0,_util.getRowid)(ge,l),a&&r[o])||(a=!ge.isRowExpandByRow(l),r=t?ge.getColumnIndex(t):-1,o=t?ge.getVMColumnIndex(t):-1,ge.setRowExpand(l,a),W("toggle-row-expand",{expanded:a,column:t,columnIndex:r,$columnIndex:o,row:l,rowIndex:ge.getRowIndex(l),$rowIndex:ge.getVMRowIndex(l)},e))},triggerRowGroupExpandEvent(e,l){var t,r=te.rowGroupExpandedMaps,{row:l,column:a}=l,o=$.value.trigger;"manual"!==o&&(e.stopPropagation(),o=!r[(0,_util.getRowid)(ge,l)],r=ge.getColumnIndex(a),t=ge.getVMColumnIndex(a),ge.setRowGroupExpand(l,o),W("toggle-row-group-expand",{expanded:o,column:a,columnIndex:r,$columnIndex:t,row:l},e))},triggerTreeExpandEvent(e,l){var{treeExpandLazyLoadedMaps:t,treeEATime:r}=te,a=ce.value;let{row:o,column:i}=l,{lazy:n,trigger:d,accordion:u}=a;"manual"===d||(e.stopPropagation(),l=(0,_util.getRowid)(ge,o),n&&t[l])||(a=!ge.isTreeExpandByRow(o),t=ge.getColumnIndex(i),l=ge.getVMColumnIndex(i),r&&clearTimeout(r),ge.setTreeExpand(o,a).then(()=>{u&&(te.treeEATime=setTimeout(()=>{te.treeEATime=void 0,ge.scrollToRow(o)},30))}),W("toggle-tree-expand",{expanded:a,column:i,columnIndex:t,$columnIndex:l,row:o},e))},handleColumnSortEvent(e,l){var t=K.mouseConfig,r=se.value,{field:a,sortable:o,order:i}=l;o&&(o={$table:ge,$event:e,column:l,field:a,property:a,order:i,sortList:P.getSortColumns(),sortTime:l.sortTime},t&&r.area&&ge.handleSortEvent&&ge.handleSortEvent(e,o),i||W("clear-sort",o,e),W("sort-change",o,e))},triggerSortEvent(e,l,t){var{multiple:r,allowClear:a}=y.value,{field:o,sortable:i}=l;i&&(t&&l.order!==t?ge.sort({field:o,order:t}):a&&ge.clearSort(r?l:null),ge.handleColumnSortEvent(e,l))},handleCellRuleUpdateStatus(e,l,r){let a=le.validStore,{row:o,column:i}=l;if(ge.hasCellRules&&ge.hasCellRules(e,o,i)){let t=ge.getCellElement(o,i);if(t){let l=!_xeUtils.default.isUndefined(r);return ge.validCellRules(e,o,i,r).then(()=>{l&&a.visible&&(0,_util.setCellValue)(o,i,r),ge.clearValidate(o,i)}).catch(({rule:e})=>{l&&(0,_util.setCellValue)(o,i,r),ge.showValidTooltip({rule:e,row:o,column:i,cell:t})})}}return(0,_vue.nextTick)()},triggerHeaderCellMousedownEvent(e,l){var t=K.mouseConfig,r=se.value,a=oe.value,{trigger:o,isCrossDrag:i,isPeerDrag:n,disabledMethod:d}=de.value,u=e.currentTarget,s=u&&u.tagName&&"input"===u.tagName.toLowerCase(),c=(0,_dom.getEventTargetNode)(e,u,"vxe-cell--checkbox").flag,g=(0,_dom.getEventTargetNode)(e,u,"vxe-cell--sort").flag,v=(0,_dom.getEventTargetNode)(e,u,"vxe-cell--filter").flag;let h=!1;a=a.drag&&"cell"===o;s||c||g||v||(o=l.column,!a)||o.fixed||!i&&!n&&o.parentId||d&&d(l)||(h=!0,ge.handleHeaderCellDragMousedownEvent(e,l)),!h&&t&&r.area&&ge.handleHeaderCellAreaMouseDnEvent&&ge.handleHeaderCellAreaMouseDnEvent(e,Object.assign({cell:u,triggerSort:g,triggerFilter:v},l)),ge.focus(),ge.closeMenu&&ge.closeMenu()},triggerCellMousedownEvent(e,l){var t=l.column,{type:r,treeNode:a}=t,o="radio"===r,i="checkbox"===r,r="expand"===r,n=ie.value,{trigger:d,isCrossDrag:u,isPeerDrag:s,disabledMethod:c}=ne.value,g=e.currentTarget,v=(l.cell=g)&&g.tagName&&"input"===g.tagName.toLowerCase(),o=o&&(0,_dom.getEventTargetNode)(e,g,"vxe-cell--radio").flag,i=i&&(0,_dom.getEventTargetNode)(e,g,"vxe-cell--checkbox").flag,a=a&&(0,_dom.getEventTargetNode)(e,g,"vxe-cell--tree-btn").flag,r=r&&(0,_dom.getEventTargetNode)(e,g,"vxe-table--expanded").flag;let h=!1,f=(n.drag&&(h="row"===d||t.dragSort&&"cell"===d),!1);v||o||i||a||r||!h||!u&&!s&&l.level||c&&c(l)||(f=!0,ge.handleCellDragMousedownEvent(e,l)),!f&&ge.handleCellMousedownEvent&&ge.handleCellMousedownEvent(e,l),ge.focus(),ge.closeFilter(),ge.closeMenu&&ge.closeMenu()},triggerCellMouseupEvent(){gr()},handleRowDragDragstartEvent(e){e.dataTransfer&&e.dataTransfer.setDragImage((0,_dom.getTpImg)(),0,0)},handleRowDragSwapEvent(g,e,v,h,f,l){let{treeConfig:p,dragConfig:t}=K;var r=ne.value;let{afterFullData:m,tableFullData:x,fullAllDataRowIdData:w}=te,_=te.xeGanttView,{animation:C,isPeerDrag:b,isCrossDrag:R,isSelfToChildDrag:E,dragEndMethod:a,dragToChildMethod:o}=r;r=ce.value;let T=O.value,y=ie.value,S=H.value,{transform:D,rowField:F,mapChildrenField:I,parentField:L}=r,M=r.children||r.childrenField;r=a||(t?t.dragEndMethod:null);let k="bottom"===f?1:0,U=re.value,A={status:!1};if(!(U&&h&&v))return Promise.resolve(A);if(h===v)return Promise.resolve(A);{var i={oldRow:v,newRow:h,dragRow:v,dragPos:f,dragToChild:!!l,offsetIndex:k};let c=E&&o?o(i):l;return Promise.resolve(!r||r(i)).then(t=>{if(!t)return mr(),V(),A;let e=(0,_util.getRowid)(ge,v);t=w[e]||{};let u=t._index,s=0,l=-1,r=(C&&(s=(0,_util.getCellRestHeight)(t,T,y,S),o=U.querySelector(`.vxe-body--row[rowid="${e}"]`))&&(l=o.offsetTop),-1),a=-1;if(p){if(D){var o=t,t=(0,_util.getRowid)(ge,h),i=w[t];if(o&&i){var n=o.level,d=i.level;let l={},e=(_xeUtils.default.eachTree([v],e=>{l[(0,_util.getRowid)(ge,e)]=e},{children:I}),!1);if(n&&d)if(b&&!R){if(o.row[L]!==i.row[L])return A}else{if(!R)return A;if(l[t]&&(e=!0,!R||!E))return _ui.VxeUI.modal&&_ui.VxeUI.modal.message({status:"error",content:getI18n("vxe.error.treeDragChild")}),A}else if(n){if(!R)return A}else if(d){if(!R)return A;if(l[t]&&(e=!0,!R||!E))return _ui.VxeUI.modal&&_ui.VxeUI.modal.message({status:"error",content:getI18n("vxe.error.treeDragChild")}),A}o=_xeUtils.default.toTreeArray(te.afterTreeFullData,{key:F,parentKey:L,children:I}),i=ge.findRowIndexOf(o,v),n=(o.splice(i,1),ge.findRowIndexOf(o,h)),d=n+k;o.splice(d,0,v),e&&R&&E&&_xeUtils.default.each(v[M],e=>{e[L]=v[L]}),v[L]=c?h[F]:h[L],te.tableFullTreeData=_xeUtils.default.toArrayTree(o,{key:F,parentKey:L,children:M,mapChildren:I})}}}else{r=ge.findRowIndexOf(m,v);t=ge.findRowIndexOf(x,v),i=(m.splice(r,1),x.splice(t,1),ge.findRowIndexOf(m,h)),n=ge.findRowIndexOf(x,h),d=(a=i+k,n+k);m.splice(a,0,v),x.splice(d,0,v)}return mr(),V(),ge.handleTableData(p&&D),ge.cacheRowMap(!1),Wt(),p&&D||ge.updateAfterDataIndex(),ge.checkSelectionStatus(),le.scrollYLoad&&ge.updateScrollYSpace(),g&&W("row-dragend",{oldRow:v,newRow:h,dragRow:v,dragPos:f,dragToChild:c,offsetIndex:k,_index:{newIndex:a,oldIndex:r}},g),(0,_vue.nextTick)().then(()=>{if(C){var a=le.tableData,o=w[e],i=o._index,n=a[0],n=w[(0,_util.getRowid)(ge,n)];let r=U;if(Q&&_&&(d=Q.getRefMaps().refGanttContainerElem,d=d.value)&&(r=d),n){var d=n._index,n=d+a.length;let e=-1,l=-1,t=1;u<d?(e=0,l=i-d):u>n?(n=o.$index,e=n+1,l=a.length,t=-1):i>u?(e=u-d,l=e+i-u):(e=i-d,l=e+u-i+1,t=-1);o=a.slice(e,l);if(o.length){let l=[];o.forEach(e=>{e=(0,_util.getRowid)(ge,e);l.push(`.vxe-body--row[rowid="${e}"]`),Q&&l.push(`.vxe-gantt-view--body-row[rowid="${e}"]`,`.vxe-gantt-view--chart-row[rowid="${e}"]`)});n=r.querySelectorAll(l.join(","));(0,_anime.moveRowAnimateToTb)(n,t*s)}}d=[`.vxe-body--row[rowid="${e}"]`],i=(Q&&d.push(`.vxe-gantt-view--body-row[rowid="${e}"]`,`.vxe-gantt-view--chart-row[rowid="${e}"]`),r.querySelectorAll(d.join(","))),a=i[0];-1<l&&a&&(0,_anime.moveRowAnimateToTb)(i,l-a.offsetTop)}N(),Qt(),ge.updateCellAreas(),ge.recalculate()}).then(()=>({status:!0}))}).catch(()=>A)}},handleCrossTableRowDragCancelEvent(){mr(),V()},handleCrossTableRowDragFinishEvent(l){var t=le.tableData,o=te.fullAllDataRowIdData,i=ie.value,n=O.value,d=H.value;let{animation:u,isCrossTableDrag:e}=ne.value;var s=ce.value.mapChildrenField;let c=re.value;if(e&&crossTableDragRowObj&&me){var g=me.row;if(g){o=o[(0,_util.getRowid)(ge,g)];let r=0,e=-1,a=(o&&(u&&(r=(0,_util.getCellRestHeight)(o,n,i,d)),e=o.$index),-1<e&&e<t.length-1?t.slice(e+1):[]);n=_xeUtils.default.toTreeArray([g],{updated:!0,children:s});ge.remove(n).then(()=>{if(u&&r&&a.length){var t=te.xeGanttView;let e=c,l=(Q&&t&&(t=Q.getRefMaps().refGanttContainerElem,t=t.value)&&(e=t),[]);a.forEach(e=>{e=(0,_util.getRowid)(ge,e);l.push(`.vxe-body--row[rowid="${e}"]`),Q&&l.push(`.vxe-gantt-view--body-row[rowid="${e}"]`,`.vxe-gantt-view--chart-row[rowid="${e}"]`)});t=e.querySelectorAll(l.join(","));(0,_anime.moveRowAnimateToTb)(t,r)}}),W("row-remove-dragend",{row:g},l),mr(),V()}}},handleCrossTableRowDragoverEmptyEvent(e){var l,t=le.tableData,r=ne.value.isCrossTableDrag;r&&crossTableDragRowObj&&!t.length&&({$oldTable:r,$newTable:t}=crossTableDragRowObj,r)&&(l=r.reactData,r.xID!==ge.xID)&&(t&&t.xID!==ge.xID&&t.hideCrossTableRowDropClearStatus(),e.preventDefault(),r.hideCrossTableRowDropClearStatus(),crossTableDragRowObj.$newTable=ge,te.prevDragRow=null,le.dragTipText=l.dragTipText,fr(e,e.currentTarget,null,!0,""))},handleCrossTableRowDragInsertEvent(u){let s=K.treeConfig,{prevDragRow:c,prevDragPos:g,prevDragToChild:e}=te;let{animation:v,isSelfToChildDrag:l,isCrossTableDrag:t,dragEndMethod:h,dragToChildMethod:f}=ne.value,p=ie.value,m=O.value,x=H.value;var w=ce.value;let{parentField:_,mapChildrenField:C}=w,b=w.children||w.childrenField;if(t&&crossTableDragRowObj&&me){let i=me.row,n=crossTableDragRowObj.$oldTable,d=re.value;if(n&&i){let o=i,t=-1;c&&(t="bottom"===g?1:0);w={oldRow:o,newRow:c,dragRow:o,dragPos:g,dragToChild:!!e,offsetIndex:t};let r=l&&f?f(w):e,a={status:!1};Promise.resolve(!h||h(w)).then(e=>{if(!e)return n&&n.xID!==ge.xID&&n.handleCrossTableRowDragCancelEvent(u),mr(),V(),a;let l=Promise.resolve();l=s?(e=_xeUtils.default.toTreeArray([o],{updated:!0,children:C}),n.handleCrossTableRowDragFinishEvent(u),c?o[_]=c[_]:o[_]=null,e.forEach(e=>{e[b]=void 0,e[C]=void 0}),c?"bottom"===g?ge.insertNextAt(e,c):ge.insertAt(e,c):ge.insert(e)):(n.handleCrossTableRowDragFinishEvent(u),c?"bottom"===g?ge.insertNextAt(o,c):ge.insertAt(o,c):ge.insert(o)),W("row-insert-dragend",{oldRow:i,newRow:c,dragRow:o,dragPos:g,dragToChild:r,offsetIndex:t},u),mr(),l.then(()=>{var t=le.tableData,r=te.fullAllDataRowIdData,r=r[(0,_util.getRowid)(ge,o)];let a=0,e=-1;r&&(v&&(a=(0,_util.getCellRestHeight)(r,m,p,x)),e=r.$index);r=-1<e?t.slice(e):[];if(v&&a&&r.length){var t=te.xeGanttView;let e=d,l=(Q&&t&&(t=Q.getRefMaps().refGanttContainerElem,t=t.value)&&(e=t),[]);r.forEach(e=>{e=(0,_util.getRowid)(ge,e);l.push(`.vxe-body--row[rowid="${e}"]`),Q&&l.push(`.vxe-gantt-view--body-row[rowid="${e}"]`,`.vxe-gantt-view--chart-row[rowid="${e}"]`)});t=e.querySelectorAll(l.join(","));(0,_anime.moveRowAnimateToTb)(t,-a)}})})}}},hideCrossTableRowDropClearStatus(){pr()},handleRowDragDragendEvent(e){var l=K.treeConfig,{fullAllDataRowIdData:t,prevDragToChild:r}=te,a=le.dragRow,o=ce.value,i=o.lazy,o=o.hasChild||o.hasChildField,{prevDragRow:n,prevDragPos:d}=te,u=ne.value.isCrossTableDrag;if(u&&crossTableDragRowObj){var u=crossTableDragRowObj.$newTable;if(u&&u.xID!==ge.xID)return void u.handleCrossTableRowDragInsertEvent(e)}l&&i&&r&&(u=t[(0,_util.getRowid)(ge,n)],n[o])&&(!u||!u.treeLoaded)||ge.handleRowDragSwapEvent(e,!0,a,n,d,r)},handleRowDragDragoverEvent(l){var t=K.treeConfig,r=te.fullAllDataRowIdData,a=le.dragRow,o=ce.value,{lazy:i,transform:n,parentField:d}=o,o=o.hasChild||o.hasChildField,{isPeerDrag:u,isCrossDrag:s,isToChildDrag:c,isCrossTableDrag:g}=ne.value;if(a||g&&(!t||s)&&crossTableDragRowObj){var v=(0,_dom.hasControlKey)(l),h=l.currentTarget;let e=h.getAttribute("rowid")||"";var f=r[e];if(f){l.preventDefault();var p=f.row;let e=(0,_util.getRowid)(ge,p);var r=r[e],m=l.clientY-h.getBoundingClientRect().y<h.clientHeight/2?"top":"bottom";if(te.prevDragToChild=!!(t&&n&&s&&c&&v),te.prevDragRow=p,te.prevDragPos=m,g&&(!t||s)&&crossTableDragRowObj){var{$oldTable:c,$newTable:g}=crossTableDragRowObj;if(c){var x=c.reactData;if(c.xID!==ge.xID)return g&&g.xID!==ge.xID&&g.hideCrossTableRowDropClearStatus(),c.hideCrossTableRowDropClearStatus(),x.isCrossDragRow=!0,le.dragTipText=x.dragTipText,crossTableDragRowObj.$newTable=ge,void fr(l,h,null,!0,m);g&&g.hideCrossTableRowDropClearStatus(),le.isCrossDragRow=!1,x.isCrossDragRow=!1,crossTableDragRowObj.$newTable=null}}ge.eqRow(a,p)||v&&t&&i&&p[o]&&r&&!r.treeLoaded||!s&&t&&n&&(u?a[d]!==p[d]:f.level)?fr(l,h,null,!1,m):(fr(l,h,null,!0,m),W("row-dragover",{oldRow:a,targetRow:p,dragPos:m},l))}}else l.preventDefault()},handleCellDragMousedownEvent(e,l){var t=(e.stopPropagation(),K).dragConfig,{isCrossTableDrag:r,trigger:a,dragStartMethod:o}=ne.value,i=l.row,n=e.currentTarget,n="cell"===a||"row"===a?n:null==(a=n.parentElement)?void 0:a.parentElement,a=n.parentElement,o=o||(t?t.dragStartMethod:null);vr(),o&&!o(l)?(a.draggable=!1,le.dragRow=null,le.dragCol=null,V(),pr()):(r&&(me.row=i,crossTableDragRowObj={$oldTable:ge,$newTable:null}),le.dragRow=i,le.isCrossDragRow=!1,le.dragCol=null,a.draggable=!0,(e=>{var l=re.value;if(l){e=(0,_util.getRowid)(ge,e);_xeUtils.default.arrayEach(l.querySelectorAll(`[rowid="${e}"]`),e=>{(0,_dom.addClass)(e,"row--drag-origin")})}})(i),(e=>{var l=K.dragConfig,t=le.dragRow,r=ne.value.tooltipMethod,r=r||(l?l.rowTooltipMethod:null);let a="";a=r?""+(r({$table:ge,row:t})||""):getI18n("vxe.table.dragTip",[e.textContent||""]),le.dragTipText=a})(n),W("row-dragstart",l,e))},handleCellDragMouseupEvent(){gr()},handleHeaderCellDragDragstartEvent(e){e.dataTransfer&&e.dataTransfer.setDragImage((0,_dom.getTpImg)(),0,0)},handleColDragSwapColumn(){return $t(),zt(!1).then(()=>{ge.updateCellAreas(),ge.saveCustomStore("update:sort")})},handleColDragSwapEvent(m,x,e,l,w,t){let _=K.mouseConfig;let{animation:C,isPeerDrag:b,isCrossDrag:R,isSelfToChildDrag:E,isToChildDrag:T,dragEndMethod:r,dragToChildMethod:a}=de.value,{collectColumn:y,fullColumnIdData:S}=te,D=re.value,F="right"===w?1:0,I={status:!1};if(!(D&&l&&e))return Promise.resolve(I);if(l===e)return Promise.resolve(I);{let h=e,f=l;e={oldColumn:h,newColumn:f,dragColumn:h,dragPos:w,dragToChild:!!t,offsetIndex:F};let p=E&&a?a(e):t;return Promise.resolve(!r||r(e)).then(e=>{if(!e)return xr(),V(),I;let l=null,t=[],c=0,g=(C&&_xeUtils.default.eachTree([h],e=>{l||e.children&&e.children.length||(l=e,c+=e.renderWidth),t.push(e)}),l=l||h,S[l.id]||{}),v=g._index,r=-1;C&&(e=D.querySelector(`.vxe-table--column[colid="${l.id}"]`))&&(r=e.offsetLeft);let a=-1,o=-1,i={},n=(_xeUtils.default.eachTree([h],e=>{i[e.id]=e}),!1);if(h.parentId&&f.parentId)if(b&&!R){if(h.parentId!==f.parentId)return I}else{if(!R)return I;if(i[f.id]&&(n=!0,!R||!E))return _ui.VxeUI.modal&&_ui.VxeUI.modal.message({status:"error",content:getI18n("vxe.error.treeDragChild")}),I}else if(h.parentId){if(!R)return I}else if(f.parentId){if(!R)return I;if(i[f.id]&&(n=!0,!R||!E))return _ui.VxeUI.modal&&_ui.VxeUI.modal.message({status:"error",content:getI18n("vxe.error.treeDragChild")}),I}var d,u,s,e=_xeUtils.default.findTree(y,e=>e.id===h.id),e=(n&&R&&E?e&&({items:d,index:s}=e,(u=h.children||[]).forEach(e=>{e.parentId=h.parentId}),d.splice(s,1,...u),h.children=[]):e&&({items:d,index:s,parent:u}=e,d.splice(s,1),u||(a=s)),_xeUtils.default.findTree(y,e=>e.id===f.id));return e&&({items:d,index:u,parent:s}=e,R&&T&&p?(h.parentId=f.id,f.children=(f.children||[]).concat([h])):(h.parentId=f.parentId,d.splice(u+F,0,h)),s||(o=u)),_xeUtils.default.eachTree(y,(e,l,t,r,a)=>{a||(e.renderSortNumber=l+1)}),_&&(ge.clearSelected&&ge.clearSelected(),ge.clearCellAreas)&&(ge.clearCellAreas(),ge.clearCopyCellArea()),xr(),V(),m&&W("column-dragend",{oldColumn:h,newColumn:f,dragColumn:h,dragPos:w,dragToChild:p,offsetIndex:F,_index:{newIndex:o,oldIndex:a}},m),(0,_vue.nextTick)().then(()=>{if(x)return ge.handleColDragSwapColumn()}).then(()=>{if(C){var i=le.tableColumn,{visibleColumn:n,fullColumnIdData:d}=te;let l=null,o={};if(_xeUtils.default.eachTree([h],e=>{l||e.children&&e.children.length||(l=e),o[e.id]=e}),l=l||h,c&&t.length){n=_xeUtils.default.findIndexOf(n,e=>!!l&&e.id===l.id),d=d[i[0].id];if(d){var d=d._index,u=d+i.length;let l=-1,t=-1,e=1,r=(v<d?(l=0,t=n-d):v>u?(u=g.$index,l=u+1,t=i.length,e=-1):n>v?(l=v-d,t=l+n-v):(l=n-d+1,t=l+v-n,e=-1),[]),a={};for(let e=l;e<t;e++){var s=i[e];a[s.id]||o[s.id]||(a[s.id]=s,r.push(s))}_xeUtils.default.eachTree([f],e=>{a[e.id]||(a[e.id]=e,r.push(e))}),r.length&&(u=D.querySelectorAll(r.map(e=>`.vxe-table--column[colid="${e.id}"]`).join(",")),(0,_anime.moveColAnimateToLr)(u,e*c))}d=D.querySelectorAll(t.map(e=>`.vxe-table--column[colid="${e.id}"]`).join(",")),n=d[0];-1<r&&n&&(0,_anime.moveColAnimateToLr)(d,r-n.offsetLeft)}}return Jt(),Gt(),ge.updateCellAreas(),{status:!0}})}).catch(()=>I)}},handleHeaderCellDragDragendEvent(e){var l=le.dragCol,{prevDragCol:t,prevDragPos:r,prevDragToChild:a}=te;ge.handleColDragSwapEvent(e,!0,l,t,r,a)},handleHeaderCellDragDragoverEvent(e){var l,t,r,a,o,i=le.dragCol,{isToChildDrag:n,isPeerDrag:d,isCrossDrag:u}=de.value;i?(o=(0,_dom.hasControlKey)(e),r=(t=e.currentTarget).getAttribute("colid"),(r=ge.getColumnById(r))&&(e.preventDefault(),l=e.clientX,a=l-t.getBoundingClientRect().x<t.clientWidth/2?"left":"right",te.prevDragToChild=!!(u&&n&&o),te.prevDragCol=r,te.prevDragPos=a,r.fixed||i&&i.id===r.id||!u&&(d?i.parentId!==r.parentId:r.parentId)?fr(e,null,t,!1,a):(fr(e,null,t,!0,a),W("column-dragover",{oldColumn:i,targetColumn:r,dragPos:a},e),(n=re.value)&&(o=L.value,d=(u=x.value)?u.$el:null,t=o||d)&&(i=n.getBoundingClientRect(),r=n.clientWidth,u=(a=Y.value)?a.clientWidth:0,d=(o=j.value)?o.clientWidth:0,n=l-(i.x+u),a=i.x+r-d-l,0<n&&n<=28?(o=Math.floor(r/(14<n?240:120)),t.scrollLeft-=o*(28-n)):0<a&&a<=28&&(u=Math.floor(r/(14<a?240:120)),t.scrollLeft+=u*(28-a)))))):e.preventDefault()},handleHeaderCellDragMousedownEvent(e,l){e.stopPropagation();var t=de.value,{trigger:t,dragStartMethod:r}=t,a=l.column,o=e.currentTarget,o="cell"===t?o:null==(t=o.parentElement)?void 0:t.parentElement;hr(),r&&!r(l)?(o.draggable=!1,le.dragRow=null,le.dragCol=null,V(),pr()):(le.dragCol=a,le.dragRow=null,o.draggable=!0,V(),(e=>{var t=re.value;if(t){let l=[];_xeUtils.default.eachTree([e],e=>{l.push(`[colid="${e.id}"]`)});_xeUtils.default.arrayEach(t.querySelectorAll(l.join(",")),e=>{(0,_dom.addClass)(e,"col--drag-origin")})}})(a),(e=>{var l=le.dragCol,t=de.value.tooltipMethod;let r="";r=t?""+(t({$table:ge,column:l})||""):getI18n("vxe.table.dragTip",[e.textContent||""]),le.dragTipText=r})(o),W("column-dragstart",l,e))},handleHeaderCellDragMouseupEvent(){hr(),pr(),V(),le.dragRow=null,le.dragCol=null},handleScrollEvent(u,s,c,g,v,h){var f=K.highlightHoverRow,{lastScrollLeft:p,lastScrollTop:m}=te,x=L.value,w=M.value;if(x&&w){var _=ie.value,C=_e.value,b=ae.value,R=w.clientHeight,E=x.clientWidth,w=w.scrollHeight,x=x.scrollWidth;let e=!1,l=!1,t=!1,r=!1,a="",o=!1,i=!1,n=!1,d=!1;c&&(S=Pe.value,(t=v<=0)||(r=x<=v+E),p<v?(a="right",x-S<=v+E&&(d=!0)):(a="left",v<=S&&(n=!0)),ge.checkScrolling(),te.lastScrollLeft=v),s&&(p=je.value,(e=g<=1)||(l=w-1<=g+R),m<g?(a="bottom",w-p<=g+R&&(i=!0)):(a="top",g<=p&&(o=!0)),te.lastScrollTop=g),le.lastScrollTime=Date.now();var T,y,S=Object.assign({scrollTop:g,scrollLeft:v,bodyHeight:R,bodyWidth:E,scrollHeight:w,scrollWidth:x,isX:c,isY:s,isTop:e,isBottom:l,isLeft:t,isRight:r,direction:a},h);Qt(),T=c,y=s,m=te.lcsTimeout,le.lazScrollLoading=!0,m&&clearTimeout(m),te.lcsTimeout=setTimeout(()=>{let{scrollXLoad:e,scrollYLoad:l,isAllOverflow:t}=le;te.lcsRunTime=Date.now(),te.lcsTimeout=void 0,te.intoRunScroll=!1,te.inVirtualScroll=!1,te.inWheelScroll=!1,te.inHeaderScroll=!1,te.inBodyScroll=!1,te.inFooterScroll=!1,le.lazScrollLoading=!1,te.scrollRenderType="",t||(ct(),N()),T&&e&&ge.updateScrollXData(),y&&l&&ge.updateScrollYData().then(()=>{t||(ct(),N()),ge.updateScrollYSpace()}),Qt(),ge.updateCellAreas()},200),c&&ge.closeFilter(),(_.isHover||f)&&ge.clearHoverRow(),C&&C.reactData.visible&&C.close(),b&&b.reactData.visible&&b.close(),(i||o||d||n)&&W("scroll-boundary",S,u),W("scroll",S,u)}},triggerScrollXEvent(){(Be.value.immediate?Gt:()=>{var{lxTimeout:e,lxRunTime:l,scrollXStore:t}=te,t=t.visibleSize,t=26<t?26:16<t?14:6;e&&clearTimeout(e),(!l||l+t<Date.now())&&(te.lxRunTime=Date.now(),Gt()),te.lxTimeout=setTimeout(()=>{te.lxTimeout=void 0,te.lxRunTime=void 0,Gt()},t)})()},triggerScrollYEvent(){(T.value.immediate?Yt:()=>{var{lyTimeout:e,lyRunTime:l,scrollYStore:t}=te,t=t.visibleSize,t=30<t?32:20<t?18:8;e&&clearTimeout(e),(!l||l+t<Date.now())&&(te.lyRunTime=Date.now(),Yt()),te.lyTimeout=setTimeout(()=>{te.lyTimeout=void 0,te.lyRunTime=void 0,Yt()},t)})()},triggerBodyScrollEvent(t,r){var{scrollYLoad:a,scrollXLoad:o}=le,{elemStore:i,intoRunScroll:n,lastScrollTop:d,lastScrollLeft:u,inWheelScroll:s,inVirtualScroll:c,inHeaderScroll:g,inBodyScroll:v,scrollRenderType:e,inFooterScroll:h}=te;if(!(s||c||g||h)){var s=L.value,c=M.value,g=(0,_util.getRefElem)(i["left-body-scroll"]),h=(0,_util.getRefElem)(i["main-body-scroll"]),f=(0,_util.getRefElem)(i["right-body-scroll"]),p=(0,_util.getRefElem)(i["main-header-scroll"]),i=(0,_util.getRefElem)(i["main-footer-scroll"]),m=X.value;if(!n&&h&&s&&c&&(!v||e===r)){let e=c.scrollTop,l=s.scrollLeft;g&&"left"===r?e=g.scrollTop:f&&"right"===r?e=f.scrollTop:(e=h.scrollTop,l=h.scrollLeft);n=l!==u,v=e!==d;te.inBodyScroll=!0,te.scrollRenderType=r,v&&("left"===r?((0,_dom.setScrollTop)(h,e),(0,_dom.setScrollTop)(f,e)):"right"===r?((0,_dom.setScrollTop)(h,e),(0,_dom.setScrollTop)(g,e)):((0,_dom.setScrollTop)(g,e),(0,_dom.setScrollTop)(f,e)),(0,_dom.setScrollTop)(c,e),(0,_dom.setScrollTop)(m,e),jt(e),a)&&ge.triggerScrollYEvent(t),n&&((0,_dom.setScrollLeft)(s,l),(0,_dom.setScrollLeft)(p,l),(0,_dom.setScrollLeft)(i,l),o)&&ge.triggerScrollXEvent(t),ge.handleScrollEvent(t,v,n,e,l,{type:"body",fixed:r})}}},triggerHeaderScrollEvent(e,l){var t=le.scrollXLoad,{elemStore:r,intoRunScroll:a,inWheelScroll:o,inVirtualScroll:i,inBodyScroll:n,inFooterScroll:d}=te;o||i||n||d||(o=M.value,i=L.value,n=(0,_util.getRefElem)(r["main-body-scroll"]),d=(0,_util.getRefElem)(r["main-header-scroll"]),r=(0,_util.getRefElem)(r["main-footer-scroll"]),a)||d&&i&&o&&(a=o.scrollTop,o=d.scrollLeft,te.inHeaderScroll=!0,(0,_dom.setScrollLeft)(i,o),(0,_dom.setScrollLeft)(r,o),(0,_dom.setScrollLeft)(n,o),t&&ge.triggerScrollXEvent(e),ge.handleScrollEvent(e,!1,!0,a,o,{type:"header",fixed:l}))},triggerFooterScrollEvent(e,l){var t=le.scrollXLoad,{elemStore:r,intoRunScroll:a,inWheelScroll:o,inVirtualScroll:i,inHeaderScroll:n,inBodyScroll:d}=te;o||i||n||d||(o=M.value,i=L.value,n=(0,_util.getRefElem)(r["main-body-scroll"]),d=(0,_util.getRefElem)(r["main-header-scroll"]),r=(0,_util.getRefElem)(r["main-footer-scroll"]),a)||r&&i&&o&&(a=o.scrollTop,o=r.scrollLeft,te.inFooterScroll=!0,(0,_dom.setScrollLeft)(i,o),(0,_dom.setScrollLeft)(d,o),(0,_dom.setScrollLeft)(n,o),t&&ge.triggerScrollXEvent(e),ge.handleScrollEvent(e,!1,!0,a,o,{type:"footer",fixed:l}))},triggerBodyWheelEvent(v){var{target:h,deltaY:f,deltaX:p,shiftKey:m}=v;if((!h||!/^textarea$/i.test(h.tagName))&&(f||p)){h=_props.tableProps.highlightHoverRow;let{scrollXLoad:r,scrollYLoad:a,expandColumn:e}=le;var x=vl.value,w=hl.value,{elemStore:_,lastScrollTop:C,lastScrollLeft:b}=te,R=ie.value,E=Ne.value,T=Ve.value;let o=L.value,i=M.value,n=(0,_util.getRefElem)(_["left-body-scroll"]),d=(0,_util.getRefElem)(_["main-header-scroll"]),u=(0,_util.getRefElem)(_["main-body-scroll"]),s=(0,_util.getRefElem)(_["main-footer-scroll"]),c=(0,_util.getRefElem)(_["right-body-scroll"]),g=X.value;if(u){var y,S,_=(e=>{let l=1;var t=Date.now();return t<e+25?l=1.18:t<e+30?l=1.15:t<e+40?l=1.12:t<e+55?l=1.09:t<e+75?l=1.06:t<e+100&&(l=1.03),l})(le.lastScrollTime),D=m?0:f*_,F=u.scrollTop,I=F+D,m=u.scrollLeft+(m?p||f:p)*_;let l=m!==b,t=I!==C;if(l&&"hidden"===E.visible)v.preventDefault();else{if(t){if("hidden"===T.visible)return void v.preventDefault();if(D<0?F<=0:F>=u.scrollHeight-u.clientHeight)return}if(k){if(t&&(0,_dom.checkTargetElement)(v.target,[n,u,c],v.currentTarget))return void v.stopPropagation();if(l&&(0,_dom.checkTargetElement)(v.target,[d,u,s],v.currentTarget))return void v.stopPropagation()}(x||w||e)&&((R.isHover||h)&&ge.clearHoverRow(),l&&(v.preventDefault(),te.inWheelScroll=!0,q.firefox||q.safari?((0,_dom.setScrollLeft)(o,f=m),(0,_dom.setScrollLeft)(u,f),(0,_dom.setScrollLeft)(d,f),(0,_dom.setScrollLeft)(s,f),r&&ge.triggerScrollXEvent(v),ge.handleScrollEvent(v,t,l,u.scrollTop,f,{type:"table",fixed:""})):(y=m,S=e=>{te.inWheelScroll=!0;(0,_dom.setScrollLeft)(o,e),(0,_dom.setScrollLeft)(u,e),(0,_dom.setScrollLeft)(d,e),(0,_dom.setScrollLeft)(s,e),r&&ge.triggerScrollXEvent(v),ge.handleScrollEvent(v,t,l,u.scrollTop,e,{type:"table",fixed:""})},requestAnimationFrame(()=>{S(y)}))),t)&&(v.preventDefault(),te.inWheelScroll=!0,q.firefox||q.safari?((0,_dom.setScrollTop)(i,p=I),(0,_dom.setScrollTop)(u,p),(0,_dom.setScrollTop)(n,p),(0,_dom.setScrollTop)(c,p),(0,_dom.setScrollTop)(g,p),jt(p),a&&ge.triggerScrollYEvent(v),ge.handleScrollEvent(v,t,l,p,u.scrollLeft,{type:"table",fixed:""})):((t,r)=>{let a=Math.abs(t),o=performance.now(),i=0,n=e=>{let l=(e-o)/a;l<0?l=0:1<l&&(l=1);e=Math.pow(l,2),e=Math.floor(t*e)-i;i+=e,r(e),l<1&&requestAnimationFrame(n)};requestAnimationFrame(n)})(I-F,e=>{te.inWheelScroll=!0;e=u.scrollTop+e;(0,_dom.setScrollTop)(i,e),(0,_dom.setScrollTop)(u,e),(0,_dom.setScrollTop)(n,e),(0,_dom.setScrollTop)(c,e),(0,_dom.setScrollTop)(g,e),jt(e),a&&ge.triggerScrollYEvent(v),ge.handleScrollEvent(v,t,l,e,u.scrollLeft,{type:"table",fixed:""})}))}}}},triggerVirtualScrollXEvent(l){var t=le.scrollXLoad,{elemStore:r,inWheelScroll:a,lastScrollTop:o,inHeaderScroll:i,inBodyScroll:n,inFooterScroll:d}=te;if(!(i||n||d||a)){i=(0,_util.getRefElem)(r["main-header-scroll"]),n=(0,_util.getRefElem)(r["main-body-scroll"]),d=(0,_util.getRefElem)(r["main-footer-scroll"]),a=M.value,r=l.currentTarget.scrollLeft,a=a||n;let e=0;a=(e=a?a.scrollTop:e)!==o;te.inVirtualScroll=!0,(0,_dom.setScrollLeft)(n,r),(0,_dom.setScrollLeft)(i,r),(0,_dom.setScrollLeft)(d,r),t&&ge.triggerScrollXEvent(l),ge.handleScrollEvent(l,a,!0,e,r,{type:"table",fixed:""})}},triggerVirtualScrollYEvent(l){var t=le.scrollYLoad,{elemStore:r,inWheelScroll:a,lastScrollLeft:o,inHeaderScroll:i,inBodyScroll:n,inFooterScroll:d}=te;if(!(i||n||d||a)){var i=(0,_util.getRefElem)(r["left-body-scroll"]),n=(0,_util.getRefElem)(r["main-body-scroll"]),d=(0,_util.getRefElem)(r["right-body-scroll"]),a=X.value,r=L.value,u=l.currentTarget.scrollTop,r=r||n;let e=0;r=(e=r?r.scrollLeft:e)!==o;te.inVirtualScroll=!0,(0,_dom.setScrollTop)(n,u),(0,_dom.setScrollTop)(i,u),(0,_dom.setScrollTop)(d,u),(0,_dom.setScrollTop)(a,u),jt(u),t&&ge.triggerScrollYEvent(l),ge.handleScrollEvent(l,!0,r,u,e,{type:"table",fixed:""})}},scrollToTreeRow(l){var e=K.treeConfig,t=le.isRowGroupStatus,r=te.tableFullData;let a=[];if(e||t){var e=$.value,o=ce.value,o=o.children||o.childrenField,r=_xeUtils.default.findTree(r,e=>ge.eqRow(e,l),{children:t?e.mapChildrenField:o});if(r){let t=r.nodes;t.forEach((e,l)=>{l<t.length-1&&!ge.isTreeExpandByRow(e)&&a.push(ge.setTreeExpand(e,!0))})}}return Promise.all(a).then(()=>(0,_util.rowToVisible)(ge,l))},updateScrollYStatus:Wt,updateScrollXSpace(){let{scrollXLoad:a,overflowX:o,scrollXWidth:i}=le,{visibleColumn:n,scrollXStore:d,elemStore:u,fullColumnIdData:s}=te;var c=te.xeGanttView,g=se.value,v=x.value;if(v?v.$el:null){var v=(0,_util.getRefElem)(u["main-body-scroll"]),h=(0,_util.getRefElem)(u["main-body-table"]),f=(0,_util.getRefElem)(u["main-header-table"]),p=(0,_util.getRefElem)(u["main-footer-table"]);let e=0;var m=n[d.startIndex];m&&(m=s[m.id]||{},e=m.oLeft);let l=0,t=(v&&(l=v.clientWidth),!1),r=i;i>maxXWidth&&(e=v&&h&&v.scrollLeft+l>=maxXWidth?maxXWidth-h.clientWidth:(maxXWidth-l)*(e/(i-l)),r=maxXWidth,t=!0),a&&o||(e=0),getConfig().scrollMarginStyle?(f&&(f.style.marginLeft=f.getAttribute("xvm")?e+"px":""),h&&(h.style.marginLeft=e+"px"),p&&(p.style.marginLeft=p.getAttribute("xvm")?e+"px":"")):(f&&(f.style.transform=f.getAttribute("xvm")?`translate(${e}px, 0px)`:""),h&&(h.style.transform=`translate(${e}px, ${le.scrollYTop||0}px)`),p&&(p.style.transform=p.getAttribute("xvm")?`translate(${e}px, 0px)`:""));["main"].forEach(l=>{["header","body","footer"].forEach(e=>{e=(0,_util.getRefElem)(u[l+`-${e}-xSpace`]);e&&(e.style.width=a?r+"px":"")})}),le.scrollXLeft=e,le.scrollXWidth=r,le.isScrollXBig=t;m=D.value;return m&&(m.style.width=r+"px"),St(),t&&g.area&&(0,_log.errLog)("vxe.error.notProp",["mouse-config.area"]),c&&c.handleUpdateSXSpace&&c.handleUpdateSXSpace(),(0,_vue.nextTick)().then(()=>{F()})}},updateScrollYSpace(){var{isAllOverflow:e,overflowY:l,scrollYLoad:t,scrollYHeight:r,expandColumn:a}=le;let{scrollYStore:o,elemStore:i,isResizeCellHeight:n,afterFullData:d,fullAllDataRowIdData:u,rowExpandedMaps:s}=te;var c,g=te.xeGanttView,v=o.startIndex,h=se.value,f=z.value,p=ie.value,m=O.value,x=H.value,w=(0,_util.getRefElem)(i["main-body-scroll"]),_=(0,_util.getRefElem)(i["main-body-table"]),C=(0,_util.getRefElem)(i["left-body-table"]),b=(0,_util.getRefElem)(i["right-body-table"]);let R=0,E=r,T=!1,y=(t?n||m.height||p.height||a||!e?(e=d[v])?(e=u[(0,_util.getRowid)(ge,e)]||{},R=e.oTop||0,c=d[d.length-1],(e=u[c=(0,_util.getRowid)(ge,c)]||{}).oTop&&(E=(e.oTop||0)+(e.resizeHeight||m.height||p.height||e.height||x),a)&&s[c]&&(E+=e.expandHeight||f.height||0),E>maxYHeight&&(T=!0)):E=_?_.clientHeight:0:((E=d.length*x)>maxYHeight&&(T=!0),R=Math.max(0,v*x)):_&&(E=_.clientHeight),0),S=(w&&(y=w.clientHeight),E),D=R;T&&(D=w&&_&&w.scrollTop+y>=maxYHeight?maxYHeight-_.clientHeight:(maxYHeight-y)*(R/(r-y)),S=maxYHeight),t&&l||(D=0),getConfig().scrollMarginStyle?(C&&(C.style.marginTop=D+"px"),_&&(_.style.marginTop=D+"px"),b&&(b.style.marginTop=D+"px")):(C&&(C.style.transform=`translate(0px, ${D}px)`),_&&(_.style.transform=`translate(${le.scrollXLeft||0}px, ${D}px)`),b&&(b.style.transform=`translate(0px, ${D}px)`)),["main","left","right"].forEach(l=>{["header","body","footer"].forEach(e=>{e=(0,_util.getRefElem)(i[l+`-${e}-ySpace`]);e&&(e.style.height=S?S+"px":"")})});m=U.value,m&&(m.style.height=S?S+"px":""),p=I.value;return p&&(p.style.height=S?S+"px":""),le.scrollYTop=D,le.scrollYHeight=S,le.isScrollYBig=T,St(),T&&h.area&&(0,_log.errLog)("vxe.error.notProp",["mouse-config.area"]),g&&g.handleUpdateSYSpace&&g.handleUpdateSYSpace(),(0,_vue.nextTick)().then(()=>{F()})},updateScrollXData(){let e=le.isAllOverflow;return Ot(),ge.updateScrollXSpace(),(0,_vue.nextTick)().then(()=>{Ot(),ge.updateScrollXSpace(),e||ge.updateScrollYSpace()})},updateScrollYData(){return ge.handleTableData(),ge.updateScrollYSpace(),(0,_vue.nextTick)().then(()=>{ge.handleTableData(),ge.updateScrollYSpace()})},checkScrolling(){var e=te.elemStore,e=(0,_util.getRefElem)(e["main-body-scroll"]),l=Y.value,t=j.value,e=L.value||e;e&&(l&&(0<e.scrollLeft?(0,_dom.addClass):(0,_dom.removeClass))(l,"scrolling--middle"),t)&&(e.clientWidth<e.scrollWidth-Math.ceil(e.scrollLeft)?(0,_dom.addClass):(0,_dom.removeClass))(t,"scrolling--middle")},handleUpdateAggData(){return At(te.tableSynchData,!0)},updateZindex(){K.zIndex?te.tZindex=K.zIndex:te.tZindex<(0,_utils.getLastZIndex)()&&(te.tZindex=(0,_utils.nextZIndex)())},handleCheckedCheckboxRow:_t,triggerHoverEvent(e,{row:l}){B.setHoverRow(l)},setHoverRow(e){var l=te.xeGanttView,t=(0,_util.getRowid)(ge,e),r=re.value;B.clearHoverRow(),r&&_xeUtils.default.arrayEach(r.querySelectorAll(`.vxe-body--row[rowid="${t}"]`),e=>(0,_dom.addClass)(e,"row--hover")),te.hoverRow=e,l&&l.handleUpdateHoverRow&&l.handleUpdateHoverRow(e)},clearHoverRow(){var e=te.xeGanttView,l=re.value;l&&_xeUtils.default.arrayEach(l.querySelectorAll(".vxe-body--row.row--hover"),e=>(0,_dom.removeClass)(e,"row--hover")),te.hoverRow=null,e&&e.handleUpdateHoverRow&&e.handleUpdateHoverRow()},getCell(e,l){return P.getCellElement(e,l)},findRowIndexOf(e,l){return l?_xeUtils.default.findIndexOf(e,e=>ge.eqRow(e,l)):-1},eqRow(e,l){return!(!e||!l||e!==l&&(0,_util.getRowid)(ge,e)!==(0,_util.getRowid)(ge,l))},handleConnectGanttView(e){return e&&e.connectUpdate&&(e.connectUpdate({$table:ge}),te.xeGanttView=e),(0,_vue.nextTick)()}},Object.assign(ge,P,B),e=>{var{showHeader:l,showFooter:t}=K,{tableData:r,tableColumn:a,tableGroupColumn:o,columnStore:i,footerTableData:n}=le,d=We.value,u=Ne.value,s=Ve.value,c=u.overscrollBehavior,g=s.overscrollBehavior,v="left"===e,i=v?i.leftList:i.rightList,c=_xeUtils.default.eqNull(c)?d.overscrollBehavior:c,d=_xeUtils.default.eqNull(g)?d.overscrollBehavior:g;return(0,_vue.h)("div",{ref:v?Y:j,class:[`vxe-table--fixed-${e}-wrapper`,"sx--"+u.visible,"sy--"+s.visible,{["x-ob--"+c]:c,["y-ob--"+d]:d}]},[l?(0,_vue.h)(_header.default,{ref:v?m:b,fixedType:e,tableData:r,tableColumn:a,tableGroupColumn:o,fixedColumn:i}):renderEmptyElement(ge),(0,_vue.h)(_body.default,{ref:v?w:R,fixedType:e,tableData:r,tableColumn:a,fixedColumn:i}),t?(0,_vue.h)(_footer.default,{ref:v?_:E,footerTableData:n,tableColumn:a,fixedColumn:i,fixedType:e}):renderEmptyElement(ge)])}),br=()=>{var e=K.dragConfig,{dragRow:l,dragCol:t,dragTipText:r}=le,a=de.value,o=ne.value,e=(o.slots||{}).tip||(e&&e.slots?e.slots.rowTip:null),a=(a.slots||{}).tip,l=l||(o.isCrossTableDrag?me.row:null);return l&&e?_r(e,{row:l}):t&&a?_r(a,{column:t}):[(0,_vue.h)("span",r)]},Rr=()=>{let _=K.treeConfig,{expandColumn:C,isRowGroupStatus:b}=le;var e=Ml.value,l=z.value.mode;if("fixed"!==l)return renderEmptyElement(ge);let R=[(0,_vue.h)("div",{key:"repY",ref:I})];if(C){let w=(0,_util.createHandleGetRowId)(ge).handleGetRowId;e.forEach(e=>{var{height:l,padding:t,indent:r}=z.value,{fullAllDataRowIdData:a,fullColumnIdData:o}=te,i=ce.value,{transform:n,seqMode:d}=i,u={},s=w(e),a=a[s],o=o[C.id]||{};let c=0,g=-1,v=-1,h=-1,f=-1,p=(a&&(h=a.index,f=a.$index,v=a._index,c=a.level,g=a.seq,b||_&&n&&"increasing"===d?g=a._index+1:_&&"fixed"===d&&(g=a._tIndex+1)),l&&(u.height=l+"px"),(b||_)&&(u.paddingLeft=c*(_xeUtils.default.isNumber(r)?r:i.indent)+30+"px"),-1),m=-1,x=-1;o&&(p=o.index,m=o.$index,x=o._index);n={$table:ge,$grid:J,$gantt:Q,seq:g,column:C,columnIndex:p,$columnIndex:m,_columnIndex:x,fixed:"",source:"table",type:"body",level:c,rowid:s,row:e,rowIndex:h,$rowIndex:f,_rowIndex:v,isHidden:!1,isEdit:!1,visibleData:[],data:[],items:[]};R.push((0,_vue.h)("div",{key:s,class:["vxe-body--row-expanded-cell",{"is--padding":t,"is--ellipsis":l}],rowid:s,style:u},C.renderData(n)))})}return(0,_vue.h)("div",{ref:X,class:"vxe-table--row-expanded-wrapper"},R)},Er=()=>(0,_vue.h)("div",{key:"vsx",ref:Me,class:"vxe-table--scroll-x-virtual"},[(0,_vue.h)("div",{ref:Ue,class:"vxe-table--scroll-x-left-corner"}),(0,_vue.h)("div",{ref:Oe,class:"vxe-table--scroll-x-wrapper"},[(0,_vue.h)("div",{ref:L,class:"vxe-table--scroll-x-handle",onScroll:ge.triggerVirtualScrollXEvent},[(0,_vue.h)("div",{ref:D,class:"vxe-table--scroll-x-space"})]),(0,_vue.h)("div",{class:"vxe-table--scroll-x-handle-appearance"})]),(0,_vue.h)("div",{ref:Ae,class:"vxe-table--scroll-x-right-corner"})]),Tr=()=>(0,_vue.h)("div",{ref:ke,class:"vxe-table--scroll-y-virtual"},[(0,_vue.h)("div",{ref:He,class:"vxe-table--scroll-y-top-corner"}),(0,_vue.h)("div",{ref:$e,class:"vxe-table--scroll-y-wrapper"},[(0,_vue.h)("div",{ref:M,class:"vxe-table--scroll-y-handle",onScroll:ge.triggerVirtualScrollYEvent},[(0,_vue.h)("div",{ref:U,class:"vxe-table--scroll-y-space"})]),(0,_vue.h)("div",{class:"vxe-table--scroll-y-handle-appearance"})]),(0,_vue.h)("div",{ref:Ge,class:"vxe-table--scroll-y-bottom-corner"})]),yr=()=>{var{showHeader:e,showFooter:l}=K,{overflowX:t,tableData:r,tableColumn:a,tableGroupColumn:o,footerTableData:i,columnStore:n}=le,d=We.value,u=Ne.value,s=Ve.value,c=u.overscrollBehavior,g=s.overscrollBehavior,{leftList:n,rightList:v}=n,c=_xeUtils.default.eqNull(c)?d.overscrollBehavior:c,d=_xeUtils.default.eqNull(g)?d.overscrollBehavior:g;return(0,_vue.h)("div",{ref:h,class:["vxe-table--viewport-wrapper",{["x-ob--"+c]:c,["y-ob--"+d]:d}]},[(0,_vue.h)("div",{class:["vxe-table--main-wrapper","sx--"+u.visible,"sy--"+s.visible]},[e?(0,_vue.h)(_header.default,{ref:f,tableData:r,tableColumn:a,tableGroupColumn:o}):renderEmptyElement(ge),(0,_vue.h)(_body.default,{ref:x,tableData:r,tableColumn:a}),l?(0,_vue.h)(_footer.default,{ref:p,footerTableData:i,tableColumn:a}):renderEmptyElement(ge)]),(0,_vue.h)("div",{class:"vxe-table--fixed-wrapper"},[n&&n.length&&t?Cr("left"):renderEmptyElement(ge),v&&v.length&&t?Cr("right"):renderEmptyElement(ge)]),Rr()])},Sr=()=>{var e=Ye.value;return(0,_vue.h)("div",{class:"vxe-table--layout-wrapper"},e?[Tr(),yr()]:[yr(),Tr()])};let Dr=(0,_vue.ref)(0),Fr=((0,_vue.watch)(()=>K.data?K.data.length:-1,()=>{Dr.value++}),(0,_vue.watch)(()=>K.data,()=>{Dr.value++}),(0,_vue.watch)(Dr,()=>{let a=te.initStatus;var e=K.data||[];e&&2e4<=e.length&&(0,_log.warnLog)("vxe.error.errLargeData",["loadData(data), reloadData(data)"]),At(e,!0).then(()=>{var{scrollXLoad:e,scrollYLoad:l,expandColumn:t}=le,r=z.value;return te.inited=!0,te.initStatus=!0,a||Ht(),(e||l)&&t&&"fixed"!==r.mode&&(0,_log.warnLog)("vxe.error.scrollErrProp",["column.type=expand"]),P.recalculate()})}),(0,_vue.ref)(0)),Ir=((0,_vue.watch)(()=>le.staticColumns.length,()=>{Fr.value++}),(0,_vue.watch)(()=>le.staticColumns,()=>{Fr.value++}),(0,_vue.watch)(Fr,()=>{(0,_vue.nextTick)(()=>Pt(_xeUtils.default.clone(le.staticColumns)))}),(0,_vue.ref)(0)),e=((0,_vue.watch)(()=>le.tableColumn.length,()=>{Ir.value++}),(0,_vue.watch)(()=>le.tableColumn,()=>{Ir.value++}),(0,_vue.watch)(Ir,()=>{B.analyColumnWidth()}),(0,_vue.watch)(()=>le.upDataFlag,()=>{(0,_vue.nextTick)(()=>{P.updateData()})}),(0,_vue.watch)(()=>le.reColumnFlag,()=>{(0,_vue.nextTick)(()=>{P.refreshColumn()})}),(0,_vue.ref)(0)),Lr=((0,_vue.watch)(pe,()=>{e.value++}),(0,_vue.watch)(()=>K.showHeader,()=>{e.value++}),(0,_vue.watch)(()=>K.showFooter,()=>{e.value++}),(0,_vue.watch)(()=>le.overflowX,()=>{e.value++}),(0,_vue.watch)(()=>le.overflowY,()=>{e.value++}),(0,_vue.watch)(()=>K.height,()=>{e.value++}),(0,_vue.watch)(()=>K.maxHeight,()=>{e.value++}),(0,_vue.watch)(qe,()=>{e.value++}),(0,_vue.watch)(Ye,()=>{e.value++}),(0,_vue.watch)(()=>_ui.VxeUI.getLanguage(),()=>{e.value++}),(0,_vue.watch)(()=>Ne.value.visible,()=>{e.value++}),(0,_vue.watch)(()=>Ve.value.visible,()=>{e.value++}),(0,_vue.watch)(e,()=>{ge.recalculate(!0)}),(0,_vue.ref)(0)),Mr=((0,_vue.watch)(()=>K.footerData?K.footerData.length:-1,()=>{Lr.value++}),(0,_vue.watch)(()=>K.footerData,()=>{Lr.value++}),(0,_vue.watch)(Lr,()=>{te.footerFullDataRowData={},ge.updateFooter()}),(0,_vue.watch)(()=>K.syncResize,e=>{e&&(Xt(),(0,_vue.nextTick)(()=>{Xt(),setTimeout(()=>Xt())}))}),(0,_vue.ref)(0)),kr=((0,_vue.watch)(()=>K.mergeCells?K.mergeCells.length:-1,()=>{Mr.value++}),(0,_vue.watch)(()=>K.mergeCells,()=>{Mr.value++}),(0,_vue.watch)(Mr,()=>{var e;e=K.mergeCells||[],te.mergeBodyList=[],te.mergeBodyMaps={},te.mergeBodyCellMaps={},ge.setMergeCells(e)}),(0,_vue.ref)(0)),Ur=((0,_vue.watch)(()=>K.mergeHeaderCells?K.mergeHeaderCells.length:-1,()=>{kr.value++}),(0,_vue.watch)(()=>K.mergeHeaderCells,()=>{kr.value++}),(0,_vue.watch)(kr,()=>{var e;e=K.mergeHeaderCells||[],te.mergeHeaderList=[],te.mergeHeaderMaps={},te.mergeHeaderCellMaps={},ge.setMergeHeaderCells(e)}),(0,_vue.ref)(0));(0,_vue.watch)(()=>K.mergeFooterCells?K.mergeFooterCells.length:-1,()=>{Ur.value++}),(0,_vue.watch)(()=>K.mergeFooterCells,()=>{Ur.value++}),(0,_vue.watch)(()=>K.mergeFooterItems?K.mergeFooterItems.length:-1,()=>{Ur.value++}),(0,_vue.watch)(()=>K.mergeFooterItems,()=>{Ur.value++}),(0,_vue.watch)(Ur,()=>{var e=K.mergeFooterCells||K.mergeFooterItems;e=e||[],te.mergeFooterList=[],te.mergeFooterMaps={},te.mergeFooterCellMaps={},ge.setMergeFooterCells(e)}),(0,_vue.watch)(Gl,e=>{Lt(e)}),(0,_vue.watch)(a,()=>{let{inited:e,tableFullData:l}=te;e&&(Nl(),le.tableData=[],(0,_vue.nextTick)(()=>{ge.reloadData(l)}))}),t&&(0,_vue.watch)(()=>t?t.reactData.resizeFlag:null,()=>{sr()}),Nl(),hooks.forEach(e=>{var e=e.setupTable;e&&(e=e(ge))&&_xeUtils.default.isObject(e)&&Object.assign(ge,e)}),B.preventEvent(null,"created",{$table:ge});let Ar;return(0,_vue.onActivated)(()=>{P.recalculate().then(()=>P.refreshScroll()),B.preventEvent(null,"activated",{$table:ge})}),(0,_vue.onDeactivated)(()=>{var e=le.filterStore;e.visible&&ge.clearFilter(),ge.closeTooltip(),te.isActivated=!1,B.preventEvent(null,"deactivated",{$table:ge})}),(0,_vue.onMounted)(()=>{let b=oe.value;var e,l=ie.value,t=Ll.value,r=$.value,a=T.value,r=r.groupFields;Q&&(e=Q.getRefMaps().refClassifyWrapperElem,e=e.value)&&(te.teleportToWrapperElem=e),ee&&(e=ee.getRefMaps().refPopupContainerElem,e=e.value)&&(te.popupToWrapperElem=e),(b.drag||l.drag||t.allowSort)&&(0,_dom.initTpImg)(),Lt(r),(0,_vue.nextTick)(()=>{var{exportConfig:e,importConfig:l,treeConfig:t,highlightCurrentRow:r,highlightCurrentColumn:a}=K,{scrollXStore:o,scrollYStore:i}=te,n=al.value;let d=ce.value;var u=G.value,s=ue.value,c=z.value,g=ie.value,v=Ll.value,h=se.value;let f=Tl.value,p=yl.value;var m=Ke.value,x=Xe.value,w=dl.value,_=$.value,C=ne.value;if(K.rowId&&(0,_log.warnLog)("vxe.error.delProp",["row-id","row-config.keyField"]),K.rowKey&&(0,_log.warnLog)("vxe.error.delProp",["row-key","row-config.useKey"]),K.columnKey&&(0,_log.warnLog)("vxe.error.delProp",["column-id","column-config.useKey"]),K.rowId||g.keyField||!(s.reserve||s.checkRowKeys||u.reserve||u.checkRowKey||c.expandRowKeys||d.expandRowKeys)||(0,_log.warnLog)("vxe.error.reqProp",["row-config.keyField"]),K.editConfig&&(n.showStatus||n.showUpdateStatus||n.showInsertStatus)&&!K.keepSource&&(0,_log.warnLog)("vxe.error.reqProp",["keep-source"]),t&&!d.transform&&K.stripe&&(0,_log.warnLog)("vxe.error.noTree",["stripe"]),!K.showFooter||K.footerMethod||K.footerData||(0,_log.warnLog)("vxe.error.reqProp",["footer-data | footer-method"]),g.height&&(0,_log.warnLog)("vxe.error.delProp",["row-config.height","cell-config.height"]),K.highlightCurrentRow&&(0,_log.warnLog)("vxe.error.delProp",["highlight-current-row","row-config.isCurrent"]),K.highlightHoverRow&&(0,_log.warnLog)("vxe.error.delProp",["highlight-hover-row","row-config.isHover"]),K.highlightCurrentColumn&&(0,_log.warnLog)("vxe.error.delProp",["highlight-current-column","column-config.isCurrent"]),K.highlightHoverColumn&&(0,_log.warnLog)("vxe.error.delProp",["highlight-hover-column","column-config.isHover"]),K.resizable&&(0,_log.warnLog)("vxe.error.delProp",["resizable","column-config.resizable"]),K.aggregateConfig&&K.rowGroupConfig&&(0,_log.warnLog)("vxe.error.notSupportProp",["aggregate-config","row-group-config","row-group-config=null"]),l&&p.types&&!p.importMethod&&!_xeUtils.default.includeArrays(_xeUtils.default.keys(p._typeMaps),p.types)&&(0,_log.warnLog)("vxe.error.errProp",["export-config.types="+p.types.join(","),p.types.filter(e=>_xeUtils.default.includes(_xeUtils.default.keys(p._typeMaps),e)).join(",")||_xeUtils.default.keys(p._typeMaps).join(",")]),e&&f.types&&!f.exportMethod&&!_xeUtils.default.includeArrays(_xeUtils.default.keys(f._typeMaps),f.types)&&(0,_log.warnLog)("vxe.error.errProp",["export-config.types="+f.types.join(","),f.types.filter(e=>_xeUtils.default.includes(_xeUtils.default.keys(f._typeMaps),e)).join(",")||_xeUtils.default.keys(f._typeMaps).join(",")]),K.id||(K.customConfig?(0,_utils.isEnableConf)(v):v.enabled)&&v.storage&&(0,_log.errLog)("vxe.error.reqProp",["id"]),K.treeConfig&&s.range&&(0,_log.errLog)("vxe.error.noTree",["checkbox-config.range"]),g.height&&!K.showOverflow&&(0,_log.warnLog)("vxe.error.notProp",["table.show-overflow"]),!ge.triggerCellAreaModnEvent&&(K.areaConfig&&(0,_log.warnLog)("vxe.error.notProp",["area-config"]),K.clipConfig&&(0,_log.warnLog)("vxe.error.notProp",["clip-config"]),K.fnrConfig&&(0,_log.warnLog)("vxe.error.notProp",["fnr-config"]),h.area))(0,_log.errLog)("vxe.error.notProp",["mouse-config.area"]);else{if(!ge.handlePivotTableAggregateData){if(v.allowGroup)return void(0,_log.errLog)("vxe.error.notProp",["custom-config.allowGroup"]);if(v.allowValues)return void(0,_log.errLog)("vxe.error.notProp",["custom-config.allowValues"])}t&&g.drag&&!d.transform&&(0,_log.errLog)("vxe.error.notSupportProp",["row-config.drag","tree-config.transform=false","tree-config.transform=true"]),t&&C.isCrossTableDrag&&!C.isCrossDrag&&(0,_log.errLog)("vxe.error.reqSupportProp",["tree-config & row-drag-config.isCrossTableDrag","row-drag-config.isCrossDrag"]),K.dragConfig&&(0,_log.warnLog)("vxe.error.delProp",["drag-config","row-drag-config"]),K.rowGroupConfig&&(0,_log.warnLog)("vxe.error.delProp",["row-group-config","aggregate-config"]),_.countFields&&(0,_log.warnLog)("vxe.error.delProp",["row-group-config.countFields","column.agg-func"]),_.aggregateMethod&&(0,_log.warnLog)("vxe.error.delProp",["row-group-config.aggregateMethod","aggregate-config.calcValuesMethod"]),_.countMethod&&(0,_log.warnLog)("vxe.error.delProp",["aggregate-config.countMethod","aggregate-config.calcValuesMethod"]),K.treeConfig&&d.children&&(0,_log.warnLog)("vxe.error.delProp",["tree-config.children","tree-config.childrenField"]),K.treeConfig&&d.line&&(0,_log.warnLog)("vxe.error.delProp",["tree-config.line","tree-config.showLine"]),h.area&&h.selected&&(0,_log.warnLog)("vxe.error.errConflicts",["mouse-config.area","mouse-config.selected"]),h.area&&K.treeConfig&&!d.transform&&(0,_log.errLog)("vxe.error.noTree",["mouse-config.area"]),K.editConfig&&n.activeMethod&&(0,_log.warnLog)("vxe.error.delProp",["edit-config.activeMethod","edit-config.beforeEditMethod"]),K.treeConfig&&s.isShiftKey&&(0,_log.errLog)("vxe.error.errConflicts",["tree-config","checkbox-config.isShiftKey"]),s.halfField&&(0,_log.warnLog)("vxe.error.delProp",["checkbox-config.halfField","checkbox-config.indeterminateField"]),t&&_xeUtils.default.arrayEach(["rowField","parentField","childrenField","hasChildField","mapChildrenField"],e=>{var l=d[e];l&&-1<l.indexOf(".")&&(0,_log.errLog)("vxe.error.errProp",[e+"="+l,e+"="+l.split(".")[0]])}),g.currentMethod&&(0,_log.warnLog)("vxe.error.delProp",["row-config.currentMethod","current-row-config.beforeSelectMethod"]),b.currentMethod&&(0,_log.warnLog)("vxe.error.delProp",["row-config.currentMethod","current-column-config.beforeSelectMethod"]),(g.isCurrent||r)&&K.keyboardConfig&&w.isArrow&&!_xeUtils.default.isBoolean(m.isFollowSelected)&&(0,_log.warnLog)("vxe.error.notConflictProp",["row-config.isCurrent","current-row-config.isFollowSelected"]),(b.isCurrent||a)&&K.keyboardConfig&&w.isArrow&&!_xeUtils.default.isBoolean(x.isFollowSelected)&&(0,_log.warnLog)("vxe.error.notConflictProp",["column-config.isCurrent","current-column-config.isFollowSelected"]),Object.assign(i,{startIndex:0,endIndex:0,visibleSize:0}),Object.assign(o,{startIndex:0,endIndex:0,visibleSize:0}),Ut(),K.autoResize&&(u=re.value,c=B.getParentElem(),Ar=globalResize.create(()=>{K.autoResize&&Ft()}),u&&Ar.observe(u),c)&&Ar.observe(c)}}),"scroll"!==a.mode&&(e=h.value)&&e.addEventListener("wheel",ge.triggerBodyWheelEvent,{passive:!1}),globalEvents.on(ge,"paste",nr),globalEvents.on(ge,"copy",dr),globalEvents.on(ge,"cut",ur),globalEvents.on(ge,"mousedown",tr),globalEvents.on(ge,"blur",rr),globalEvents.on(ge,"mousewheel",ar),globalEvents.on(ge,"keydown",ir),globalEvents.on(ge,"resize",sr),globalEvents.on(ge,"contextmenu",ge.handleGlobalContextmenuEvent),ge.preventEvent(null,"mounted",{$table:ge})}),(0,_vue.onBeforeUnmount)(()=>{var e=h.value;e&&e.removeEventListener("wheel",ge.triggerBodyWheelEvent),te.cvCacheMaps={},te.prevDragRow=null,te.prevDragCol=null,Ar&&Ar.disconnect(),P.closeFilter(),ge.closeMenu&&ge.closeMenu(),globalEvents.off(ge,"paste"),globalEvents.off(ge,"copy"),globalEvents.off(ge,"cut"),globalEvents.off(ge,"mousedown"),globalEvents.off(ge,"blur"),globalEvents.off(ge,"mousewheel"),globalEvents.off(ge,"keydown"),globalEvents.off(ge,"resize"),globalEvents.off(ge,"contextmenu"),B.preventEvent(null,"beforeUnmount",{$table:ge})}),(0,_vue.onUnmounted)(()=>{B.preventEvent(null,"unmounted",{$table:ge}),_xeUtils.default.assign(te,(0,_util.createInternalData)())}),(0,_vue.nextTick)(()=>{!K.loading||he||Z.loading||((0,_log.errLog)("vxe.error.errProp",["loading=true","loading=false | <template #loading>...</template>"]),(0,_log.errLog)("vxe.error.reqComp",["vxe-loading"])),!0!==K.showOverflow&&"tooltip"!==K.showOverflow&&!0!==K.showHeaderOverflow&&"tooltip"!==K.showHeaderOverflow&&!0!==K.showFooterOverflow&&"tooltip"!==K.showFooterOverflow&&!K.tooltipConfig&&!K.editRules||fe||(!0===K.showOverflow&&(0,_log.errLog)("vxe.error.errProp",["show-overflow=true","show-overflow=title"]),"tooltip"===K.showOverflow&&(0,_log.errLog)("vxe.error.errProp",["show-overflow=tooltip","show-overflow=title"]),!0===K.showHeaderOverflow&&(0,_log.errLog)("vxe.error.errProp",["show-header-overflow=true","show-header-overflow=title"]),"tooltip"===K.showHeaderOverflow&&(0,_log.errLog)("vxe.error.errProp",["show-header-overflow=tooltip","show-header-overflow=title"]),!0===K.showFooterOverflow&&(0,_log.errLog)("vxe.error.errProp",["show-footer-overflow=true","show-footer-overflow=title"]),"tooltip"===K.showFooterOverflow&&(0,_log.errLog)("vxe.error.errProp",["show-footer-overflow=tooltip","show-footer-overflow=title"]),(0,_log.errLog)("vxe.error.reqComp",["vxe-tooltip"]))}),(0,_vue.provide)("$xeColgroup",null),(0,_vue.provide)("$xeTable",ge),ge.renderVN=()=>{var{loading:e,stripe:l,showHeader:t,height:r,treeConfig:a,mouseConfig:o,showFooter:i,highlightCell:n,highlightHoverRow:d,highlightHoverColumn:u,editConfig:s,editRules:c}=K;let{isGroup:g,overflowX:H,overflowY:O,scrollXLoad:$,scrollYLoad:G,tableData:v,initStore:h,isRowGroupStatus:z,columnStore:P,filterStore:B,customStore:W,tooltipStore:f}=le;var{teleportToWrapperElem:p,popupToWrapperElem:m}=te,{leftList:N,rightList:V}=P;let x=Z.loading;var w={header:Z.headerTooltip||Z["header-tooltip"],body:Z.tooltip,footer:Z.footerTooltip||Z["footer-tooltip"]};let _=f.visible&&f.type?w[f.type]:null;var w=ne.value,C=tl.value,b=rl.value,R=ze.value,q=ue.value,E=ce.value,Y=ie.value,T=oe.value,y=pe.value,S=Hl.value,D=se.value,F=nl.value,I=Fl.value,j=Rl.value;let L=le.isColLoading||le.isRowLoading||e;var e=Ze.value,M=o&&D.area,X=de.value,k=qe.value,U=Ye.value,w=w.isCrossTableDrag,A={onKeydown:or};return w&&!v.length&&(A.onDragover=ge.handleCrossTableRowDragoverEmptyEvent),(0,_vue.h)("div",Object.assign({ref:re,class:["vxe-table","vxe-table--render-default","tid_"+ve,"border--"+S,"sx-pos--"+(k?"top":"bottom"),"sy-pos--"+(U?"left":"right"),{["size--"+y]:y,["valid-msg--"+R.msgMode]:!!c,"vxe-editable":!!s,"old-cell-valid":c&&"obsolete"===getConfig().cellVaildMode,"cell--highlight":n,"cell--selected":o&&D.selected,"cell--area":M,"header-cell--area":M&&F.selectCellByHeader,"body-cell--area":M&&F.selectCellByBody,"row--highlight":Y.isHover||d,"column--highlight":T.isHover||u,"checkbox--range":q.range,"col--drag-cell":T.drag&&"cell"===X.trigger,"is--header":t,"is--footer":i,"is--group":g,"is-row-group":z,"is--tree-line":a&&(E.showLine||E.line),"is--fixed-left":N.length,"is--fixed-right":V.length,"is--animat":!!K.animat,"is--round":K.round,"is--stripe":!a&&l,"is--loading":L,"is--empty":!L&&!v.length,"is--scroll-y":O,"is--scroll-x":H,"is--virtual-x":$,"is--virtual-y":G}],spellcheck:!1},A),[(0,_vue.h)("div",{class:"vxe-table-slots"},Z.default?Z.default({}):[]),(0,_vue.h)("div",{ref:xe,class:"vxe-table-vars"},[(0,_vue.h)("div",{class:"vxe-table-var-default"}),(0,_vue.h)("div",{class:"vxe-table-var-medium"}),(0,_vue.h)("div",{class:"vxe-table-var-small"}),(0,_vue.h)("div",{class:"vxe-table-var-mini"})]),(0,_vue.h)("div",{key:"tw",class:"vxe-table--render-wrapper"},k?[Er(),Sr()]:[Sr(),Er()]),(0,_vue.h)("div",{key:"tn",ref:De,class:"vxe-table--empty-place-wrapper"},[(0,_vue.h)("div",{class:"vxe-table--empty-placeholder"},[(0,_vue.h)("div",{class:"vxe-table--empty-content"},(w=Dl.value,S=Z.empty,U={$table:ge,$grid:J,gantt:Q},S?S(U):(S=(S=w.name?renderer.get(w.name):null)?S.renderTableEmpty||S.renderTableEmptyView||S.renderEmpty:null)?(0,_vn.getSlotVNs)(S(w,U)):(0,_utils.getFuncText)(K.emptyText)||getI18n("vxe.table.emptyText")))])]),(0,_vue.h)("div",{key:"tl",class:"vxe-table--border-line"}),(0,_vue.h)("div",{key:"tcl",ref:ye,class:"vxe-table--resizable-col-bar"},e.showDragTip?[(0,_vue.h)("div",{class:"vxe-table--resizable-number-tip"})]:[]),(0,_vue.h)("div",{key:"ttw"},[(0,_vue.h)(_vue.Teleport,{to:p,disabled:!(Q&&p)},[(0,_vue.h)("div",{ref:Ee},[(0,_vue.h)("div",{key:"trl",ref:Se,class:"vxe-table--resizable-row-bar"},e.showDragTip?[(0,_vue.h)("div",{class:"vxe-table--resizable-number-tip"})]:[]),h.custom?(0,_vue.h)(_panel.default,{key:"cs",ref:Re,customStore:W}):renderEmptyElement(ge),he?(0,_vue.h)(he,{key:"lg",class:"vxe-table--loading",modelValue:L,icon:I.icon,text:I.text},x?{default:()=>_r(x,{$table:ge,$grid:J,$gantt:Q,loading:L})}:{}):x?(0,_vue.h)("div",{class:["vxe-loading--custom-wrapper",{"is--visible":L}]},_r(x,{$table:ge,$grid:J,$gantt:Q,loading:L})):renderEmptyElement(ge),(()=>{var{dragRow:e,dragCol:l}=le,t=ie.value,r=oe.value,a=ne.value,o=de.value,e=e||(a.isCrossTableDrag?me.row:null);return t.drag||r.drag?(0,_vue.h)("div",{class:"vxe-table--drag-wrapper"},[(0,_vue.h)("div",{ref:Ie,class:["vxe-table--drag-row-line",{"is--guides":a.showGuidesStatus}]}),(0,_vue.h)("div",{ref:Le,class:["vxe-table--drag-col-line",{"is--guides":o.showGuidesStatus}]}),e&&a.showDragTip||l&&o.showDragTip?(0,_vue.h)("div",{ref:Fe,class:"vxe-table--drag-sort-tip"},[(0,_vue.h)("div",{class:"vxe-table--drag-sort-tip-wrapper"},[(0,_vue.h)("div",{class:"vxe-table--drag-sort-tip-status"},[(0,_vue.h)("span",{class:["vxe-table--drag-sort-tip-normal-status",e?getIcon().TABLE_DRAG_STATUS_ROW:getIcon().TABLE_DRAG_STATUS_COLUMN]}),(0,_vue.h)("span",{class:["vxe-table--drag-sort-tip-sub-status",getIcon().TABLE_DRAG_STATUS_SUB_ROW]}),(0,_vue.h)("span",{class:["vxe-table--drag-sort-tip-disabled-status",getIcon().TABLE_DRAG_DISABLED]})]),(0,_vue.h)("div",{class:"vxe-table--drag-sort-tip-content"},br())])]):renderEmptyElement(ge)]):renderEmptyElement(ge)})()])])]),(0,_vue.h)("div",{key:"tpw"},[(0,_vue.h)(_vue.Teleport,{to:m,disabled:!(ee&&m)},[(0,_vue.h)("div",{ref:Te},[h.filter?(0,_vue.h)(_panel2.default,{key:"tf",ref:be,filterStore:B}):renderEmptyElement(ge),j?(0,_vue.h)(_panel3.default,{key:"tm",ref:Ce}):renderEmptyElement(ge)])])]),h.import&&K.importConfig?(0,_vue.h)(_importPanel.default,{key:"it",defaultOptions:le.importParams,storeData:le.importStore}):renderEmptyElement(ge),h.export&&(K.exportConfig||K.printConfig)?(0,_vue.h)(_exportPanel.default,{key:"et",defaultOptions:le.exportParams,storeData:le.exportStore}):renderEmptyElement(ge),fe?(0,_vue.h)("div",{},[(0,_vue.h)(fe,{key:"ctp",ref:we,isArrow:!1,enterable:!1}),(0,_vue.h)(fe,{key:"btp",ref:ae,theme:C.theme,enterable:C.enterable,enterDelay:C.enterDelay,leaveDelay:C.leaveDelay,useHTML:C.useHTML,width:C.width,height:C.height,minWidth:C.minWidth,minHeight:C.minHeight,maxWidth:C.maxWidth,maxHeight:C.maxHeight},_?{content:()=>{var{type:e,row:l,column:t,content:r}=f;if(_){if(t&&"header"===e)return(0,_vue.h)("div",{key:e},_({column:t,tooltipContent:r,$table:ge,$grid:J,$gantt:Q}));if(l&&t&&"body"===e)return(0,_vue.h)("div",{key:e},_({row:l,column:t,tooltipContent:r,$table:ge,$grid:J,$gantt:Q}));if(l&&t&&"footer"===e)return(0,_vue.h)("div",{key:e},_({row:l,column:t,tooltipContent:r,$table:ge,$grid:J,$gantt:Q}))}return renderEmptyElement(ge)}}:{}),K.editRules&&R.showMessage&&("default"===R.message?!r:"tooltip"===R.message)?(0,_vue.h)(fe,{key:"vtp",ref:_e,class:[{"old-cell-valid":c&&"obsolete"===getConfig().cellVaildMode},"vxe-table--valid-error"],theme:b.theme,enterable:b.enterable,enterDelay:b.enterDelay,leaveDelay:b.leaveDelay}):renderEmptyElement(ge)]):renderEmptyElement(ge)])},ge},render(){return this.renderVN()}});