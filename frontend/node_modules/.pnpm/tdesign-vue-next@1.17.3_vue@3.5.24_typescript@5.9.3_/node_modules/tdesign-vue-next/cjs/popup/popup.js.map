{"version":3,"file":"popup.js","sources":["../../../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/_baseInRange.js","../../../../node_modules/.pnpm/lodash-es@4.17.21/node_modules/lodash-es/inRange.js","../../../components/popup/popup.tsx"],"sourcesContent":["/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * The base implementation of `_.inRange` which doesn't coerce arguments.\n *\n * @private\n * @param {number} number The number to check.\n * @param {number} start The start of the range.\n * @param {number} end The end of the range.\n * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n */\nfunction baseInRange(number, start, end) {\n  return number >= nativeMin(start, end) && number < nativeMax(start, end);\n}\n\nexport default baseInRange;\n","import baseInRange from './_baseInRange.js';\nimport toFinite from './toFinite.js';\nimport toNumber from './toNumber.js';\n\n/**\n * Checks if `n` is between `start` and up to, but not including, `end`. If\n * `end` is not specified, it's set to `start` with `start` then set to `0`.\n * If `start` is greater than `end` the params are swapped to support\n * negative ranges.\n *\n * @static\n * @memberOf _\n * @since 3.3.0\n * @category Number\n * @param {number} number The number to check.\n * @param {number} [start=0] The start of the range.\n * @param {number} end The end of the range.\n * @returns {boolean} Returns `true` if `number` is in the range, else `false`.\n * @see _.range, _.rangeRight\n * @example\n *\n * _.inRange(3, 2, 4);\n * // => true\n *\n * _.inRange(4, 8);\n * // => true\n *\n * _.inRange(4, 2);\n * // => false\n *\n * _.inRange(2, 2);\n * // => false\n *\n * _.inRange(1.2, 2);\n * // => true\n *\n * _.inRange(5.2, 4);\n * // => false\n *\n * _.inRange(-3, -2, -6);\n * // => true\n */\nfunction inRange(number, start, end) {\n  start = toFinite(start);\n  if (end === undefined) {\n    end = start;\n    start = 0;\n  } else {\n    end = toFinite(end);\n  }\n  number = toNumber(number);\n  return baseInRange(number, start, end);\n}\n\nexport default inRange;\n","import { createPopper, Placement } from '@popperjs/core';\nimport { inRange, max, min, isObject, debounce, isString, isFunction } from 'lodash-es';\nimport {\n  computed,\n  CSSProperties,\n  defineComponent,\n  inject,\n  InjectionKey,\n  nextTick,\n  onUnmounted,\n  provide,\n  ref,\n  Ref,\n  toRefs,\n  Transition,\n  watch,\n} from 'vue';\nimport { useVModel, useContent, useTNodeJSX, usePrefixClass, useCommonClassName } from '@tdesign/shared-hooks';\n\nimport { off, on, once, isServer } from '@tdesign/shared-utils';\nimport setStyle from '@tdesign/common-js/utils/setStyle';\nimport Container from './container';\nimport props from './props';\nimport { PopupTriggerEvent, TdPopupProps } from './type';\n\nconst POPUP_ATTR_NAME = 'data-td-popup';\nconst POPUP_PARENT_ATTR_NAME = 'data-td-popup-parent';\n\n/**\n * @param id\n * @param upwards query upwards poppers\n */\nfunction getPopperTree(id: number | string, upwards?: boolean): Element[] {\n  const list = [] as any;\n  const selectors = [POPUP_PARENT_ATTR_NAME, POPUP_ATTR_NAME];\n\n  if (!id) return list;\n  if (upwards) {\n    selectors.unshift(selectors.pop());\n  }\n\n  recurse(id);\n\n  return list;\n\n  function recurse(id: number | string) {\n    const children = document.querySelectorAll(`[${selectors[0]}=\"${id}\"]`);\n    children.forEach((el) => {\n      list.push(el);\n      const childId = el.getAttribute(selectors[1]);\n      if (childId && childId !== id) {\n        recurse(childId);\n      }\n    });\n  }\n}\n\nconst parentKey = Symbol() as InjectionKey<{\n  id: string;\n  assertMouseLeave: (ev: MouseEvent) => void;\n}>;\n\nfunction getPopperPlacement(placement: TdPopupProps['placement']): Placement {\n  return placement.replace(/-(left|top)$/, '-start').replace(/-(right|bottom)$/, '-end') as Placement;\n}\n\nfunction attachListeners(elm: Ref<Element>) {\n  const offs: Array<() => void> = [];\n  return {\n    add<K extends keyof HTMLElementEventMap>(type: K, listener: (ev: HTMLElementEventMap[K]) => void) {\n      if (!type) return;\n      on(elm.value, type, listener);\n      offs.push(() => {\n        off(elm.value, type, listener);\n      });\n    },\n    clean() {\n      offs.forEach((handler) => handler?.());\n      offs.length = 0;\n    },\n  };\n}\n\nexport default defineComponent({\n  name: 'TPopup',\n  props: {\n    ...props,\n    expandAnimation: {\n      type: Boolean,\n    },\n  },\n  setup(props, { expose }) {\n    const { visible: propVisible, modelValue } = toRefs(props);\n    const [visible, setVisible] = useVModel(\n      propVisible,\n      modelValue,\n      props.defaultVisible,\n      props.onVisibleChange,\n      'visible',\n    );\n    const renderTNodeJSX = useTNodeJSX();\n    const renderContent = useContent();\n\n    /** popperjs instance */\n    let popper: ReturnType<typeof createPopper>;\n    /** timeout id */\n    let showTimeout: any;\n    let hideTimeout: any;\n\n    const triggerEl = ref<HTMLElement>(null);\n    const overlayEl = ref<HTMLElement>(null);\n    const popperEl = ref<HTMLElement>(null);\n    const containerRef = ref<typeof Container>(null);\n    const isOverlayHover = ref(false);\n\n    const arrowStyle = ref<CSSProperties>({});\n\n    const id = typeof process !== 'undefined' && process.env?.TEST ? '' : Date.now().toString(36);\n    const parent = inject(parentKey, undefined);\n\n    provide(parentKey, {\n      id,\n      assertMouseLeave: onMouseLeave,\n    });\n\n    const prefixCls = usePrefixClass('popup');\n    const { STATUS: commonCls } = useCommonClassName();\n    const delay = computed(() => {\n      const delay = props.trigger !== 'hover' ? [0, 0] : [].concat(props.delay ?? [250, 150]);\n      return {\n        show: delay[0],\n        hide: delay[1] ?? delay[0],\n      };\n    });\n\n    const trigger = attachListeners(triggerEl);\n\n    watch(\n      () => [props.trigger, triggerEl.value],\n      () => {\n        if (!triggerEl.value) return;\n        trigger.clean();\n\n        trigger.add(\n          (\n            {\n              hover: 'mouseenter',\n              focus: 'focusin',\n              'context-menu': 'contextmenu',\n              click: 'click',\n            } as any\n          )[props.trigger],\n          (ev: MouseEvent) => {\n            if (props.disabled) return;\n\n            if (ev.type === 'contextmenu') {\n              ev.preventDefault();\n            }\n\n            if ((ev.type === 'click' || ev.type === 'contextmenu') && visible.value) {\n              hide(ev);\n              return;\n            }\n\n            show(ev);\n          },\n        );\n\n        trigger.add(\n          (\n            {\n              hover: 'mouseleave',\n              focus: 'focusout',\n            } as any\n          )[props.trigger],\n          hide,\n        );\n      },\n    );\n\n    watch(\n      () => [props.overlayStyle, props.overlayInnerStyle, overlayEl.value],\n      () => {\n        updateOverlayInnerStyle();\n        updatePopper();\n      },\n      { immediate: true },\n    );\n\n    watch(\n      () => props.triggerElement,\n      (v) => {\n        // triggerElement 为字符串的情况，作为元素选择器使用\n        if (typeof v === 'string') {\n          nextTick(() => {\n            triggerEl.value = document.querySelector(v);\n          });\n        }\n      },\n      { immediate: true },\n    );\n\n    watch(\n      () => props.placement,\n      () => {\n        destroyPopper();\n        updatePopper();\n      },\n    );\n\n    watch(\n      () => visible.value,\n      (visible) => {\n        if (visible) {\n          !isServer && on(document, 'mousedown', onDocumentMouseDown, true);\n          if (props.trigger === 'focus') {\n            once(triggerEl.value, 'keydown', (ev: KeyboardEvent) => {\n              const code = typeof process !== 'undefined' && process.env?.TEST ? '27' : 'Escape';\n              if (ev.code === code) {\n                hide(ev);\n              }\n            });\n          }\n          return;\n        }\n        !isServer && off(document, 'mousedown', onDocumentMouseDown, true);\n      },\n      { immediate: true },\n    );\n\n    watch(\n      () => [visible.value, overlayEl.value],\n      () => {\n        if (visible.value && overlayEl.value && updateScrollTop) {\n          updateScrollTop?.(overlayEl.value);\n        }\n      },\n    );\n\n    onUnmounted(() => {\n      destroyPopper();\n      clearAllTimeout();\n      off(document, 'mousedown', onDocumentMouseDown, true);\n    });\n\n    expose({\n      update: updatePopper,\n      getOverlay: () => overlayEl.value,\n      getOverlayState: () => ({\n        hover: isOverlayHover.value,\n      }),\n      getPopper: () => popper,\n      /** close is going to be deprecated. visible is enough */\n      close: () => hide(),\n    });\n\n    function getOverlayStyle() {\n      const { overlayStyle } = props;\n\n      if (!triggerEl.value || !overlayEl.value) return;\n      if (isFunction(overlayStyle)) {\n        return overlayStyle(triggerEl.value, overlayEl.value);\n      }\n      if (isObject(overlayStyle)) {\n        return overlayStyle;\n      }\n    }\n\n    function updateOverlayInnerStyle() {\n      const { overlayInnerStyle } = props;\n\n      if (!triggerEl.value || !overlayEl.value) return;\n      if (isFunction(overlayInnerStyle)) {\n        setStyle(overlayEl.value, overlayInnerStyle(triggerEl.value, overlayEl.value));\n      } else if (isObject(overlayInnerStyle)) {\n        setStyle(overlayEl.value, overlayInnerStyle);\n      }\n    }\n\n    function getArrowStyle() {\n      if (!triggerEl.value || !popperEl.value) {\n        // 不做修改\n        return {};\n      }\n\n      const triggerRect = triggerEl.value.getBoundingClientRect();\n      const popupRect = popperEl.value.getBoundingClientRect();\n\n      const position = props.placement;\n\n      if (position.startsWith('top') || position.startsWith('bottom')) {\n        // 距离中线的距离\n        const offsetLeft = Math.abs(triggerRect.left + triggerRect.width / 2 - popupRect.left);\n\n        const popupWidth = popperEl.value.offsetWidth ?? popperEl.value.offsetWidth;\n\n        // 保留 padding 的安全 offset\n        const maxPopupOffsetLeft = popupWidth - 4;\n        const minPopupOffsetLeft = 12;\n\n        // 偏移超出元素本身\n        if (inRange(offsetLeft, 0, popupWidth)) {\n          return {\n            // 加上箭头元素本身的偏移\n            left: `${max([minPopupOffsetLeft, min([maxPopupOffsetLeft, offsetLeft])]) - 4}px`,\n            // 覆盖可能的 margin\n            marginLeft: 0,\n          };\n        } else {\n          // 此时箭头的指向将不准确\n          // 不作偏移保持默认\n          // 或许考虑隐藏箭头或尽可能偏移\n          return {};\n        }\n      }\n\n      // 判断元素顶部和触发器中线的距离\n      const offsetTop = triggerRect.top + triggerRect.height / 2 - popupRect.top;\n\n      const popupHeight = popperEl.value.offsetHeight ?? popperEl.value.clientHeight;\n\n      // 保留 padding 的安全 offset\n      const maxPopupOffsetTop = popupHeight - 8;\n      const minPopupOffsetTop = 8;\n\n      // 偏移超出元素本身\n      if (inRange(offsetTop, 0, popupHeight)) {\n        return {\n          // 加上箭头元素本身的偏移\n          top: `${max([minPopupOffsetTop, min([maxPopupOffsetTop, offsetTop])]) - 4}px`,\n          // 覆盖可能的 margin\n          marginTop: 0,\n        };\n      } else {\n        // 此时箭头的指向将不准确\n        // 不作偏移保持默认\n        // 或许考虑隐藏箭头或尽可能偏移\n        return {};\n      }\n    }\n\n    function updatePopper() {\n      if (!popperEl.value || !visible.value) return;\n      if (popper) {\n        /**\n         * web component 内的元素限制在了shadow root内，\n         * 无法通过寻找父元素的方式判定是否在当前文档内\n         */\n        if (triggerEl.value.getRootNode() instanceof ShadowRoot) {\n          popper.state.elements.reference = triggerEl.value;\n          popper.update();\n        } else {\n          const rect = triggerEl.value.getBoundingClientRect();\n          let parent = triggerEl.value;\n          while (parent && parent !== document.body) {\n            parent = parent.parentElement;\n          }\n          const isHidden = parent !== document.body || (rect.width === 0 && rect.height === 0);\n          if (!isHidden) {\n            popper.state.elements.reference = triggerEl.value;\n            popper.update();\n          } else {\n            setVisible(false, { trigger: getTriggerType({ type: 'mouseenter' } as MouseEvent) });\n          }\n        }\n        if (props.showArrow) {\n          arrowStyle.value = getArrowStyle();\n        }\n        return;\n      }\n\n      popper = createPopper(triggerEl.value, popperEl.value, {\n        placement: getPopperPlacement(props.placement),\n        onFirstUpdate: () => {\n          nextTick(updatePopper);\n        },\n        ...props.popperOptions,\n      });\n      if (props.showArrow) {\n        arrowStyle.value = getArrowStyle();\n      }\n    }\n\n    function destroyPopper() {\n      if (popper) {\n        popper?.destroy();\n        popper = null;\n      }\n      if (props.destroyOnClose) {\n        containerRef.value?.unmountContent();\n      }\n    }\n\n    function show(ev: PopupTriggerEvent) {\n      clearAllTimeout();\n      showTimeout = setTimeout(() => {\n        setVisible(true, { trigger: getTriggerType(ev) });\n      }, delay.value.show);\n    }\n\n    function hide(ev?: PopupTriggerEvent) {\n      clearAllTimeout();\n      hideTimeout = setTimeout(() => {\n        setVisible(false, { trigger: getTriggerType(ev), e: ev });\n      }, delay.value.hide);\n    }\n\n    function clearAllTimeout() {\n      clearTimeout(showTimeout);\n      clearTimeout(hideTimeout);\n    }\n\n    function getTriggerType(ev?: PopupTriggerEvent) {\n      switch (ev?.type) {\n        case 'mouseenter':\n          return 'trigger-element-hover';\n        case 'mouseleave':\n          return 'trigger-element-hover';\n        case 'focusin':\n          return 'trigger-element-focus';\n        case 'focusout':\n          return 'trigger-element-blur';\n        case 'click':\n          return 'trigger-element-click';\n        case 'context-menu':\n        case 'keydown':\n          return 'keydown-esc';\n        case 'mousedown':\n          return 'document';\n        default:\n          return 'trigger-element-close';\n      }\n    }\n\n    function onDocumentMouseDown(ev: MouseEvent) {\n      // click content\n      if (popperEl.value?.contains(ev.target as Node)) {\n        return;\n      }\n\n      // click trigger element\n      if (triggerEl.value?.contains(ev.target as Node)) {\n        return;\n      }\n\n      // ignore upwards\n      const activedPopper = getPopperTree(id).find((el) => el.contains(ev.target as Node));\n      if (\n        activedPopper &&\n        getPopperTree(activedPopper.getAttribute(POPUP_PARENT_ATTR_NAME), true).some((el) => el === popperEl.value)\n      ) {\n        return;\n      }\n\n      hide(ev);\n    }\n\n    function onMouseLeave(ev: MouseEvent) {\n      isOverlayHover.value = false;\n      if (props.trigger !== 'hover' || triggerEl.value.contains(ev.target as Node)) return;\n\n      const isCursorOverlaps = getPopperTree(id).some((el) => {\n        const rect = el.getBoundingClientRect();\n\n        return ev.x > rect.x && ev.x < rect.x + rect.width && ev.y > rect.y && ev.y < rect.y + rect.height;\n      });\n      if (!isCursorOverlaps) {\n        hide(ev);\n        parent?.assertMouseLeave(ev);\n      }\n    }\n\n    function onMouseenter() {\n      isOverlayHover.value = true;\n      if (visible.value && props.trigger === 'hover') {\n        clearAllTimeout();\n      }\n    }\n\n    function onOverlayClick(e: MouseEvent) {\n      props.onOverlayClick?.({ e });\n    }\n\n    const updateScrollTop = inject('updateScrollTop', undefined);\n\n    function handleOnScroll(e: WheelEvent) {\n      const { scrollTop, clientHeight, scrollHeight } = e.target as HTMLDivElement;\n\n      // 防止多次触发添加截流\n      const debounceOnScrollBottom = debounce((e) => props.onScrollToBottom?.({ e }), 100);\n\n      // windows 下 scrollTop 会出现小数，这里取整\n      if (clientHeight + Math.floor(scrollTop) === scrollHeight) {\n        // touch bottom\n        debounceOnScrollBottom(e);\n      }\n      props.onScroll?.({ e });\n    }\n\n    return () => {\n      const content = renderTNodeJSX('content');\n      const hidePopup = props.hideEmptyPopup && ['', undefined, null].includes(content);\n\n      const overlay =\n        visible.value || !props.destroyOnClose ? (\n          <div\n            {...{\n              [POPUP_ATTR_NAME]: id,\n              [POPUP_PARENT_ATTR_NAME]: parent?.id,\n            }}\n            class={[prefixCls.value, props.overlayClassName]}\n            ref={(ref: HTMLElement) => (popperEl.value = ref)}\n            style={[{ zIndex: props.zIndex }, getOverlayStyle(), hidePopup && { visibility: 'hidden' }]}\n            v-show={visible.value}\n            onClick={onOverlayClick}\n            onMouseenter={onMouseenter}\n            onMouseleave={onMouseLeave}\n          >\n            <div\n              class={[\n                `${prefixCls.value}__content`,\n                {\n                  [`${prefixCls.value}__content--text`]: isString(props.content),\n                  [`${prefixCls.value}__content--arrow`]: props.showArrow,\n                  [commonCls.value.disabled]: props.disabled,\n                },\n                props.overlayInnerClassName,\n              ]}\n              ref={overlayEl}\n              onScroll={handleOnScroll}\n            >\n              {content}\n              {props.showArrow && <div class={`${prefixCls.value}__arrow`} style={arrowStyle.value} />}\n            </div>\n          </div>\n        ) : null;\n\n      return (\n        <Container\n          ref={(ref: any) => (containerRef.value = ref)}\n          forwardRef={(ref) => {\n            if (typeof props.triggerElement !== 'string') triggerEl.value = ref;\n          }}\n          onContentMounted={() => {\n            if (visible.value) {\n              updatePopper();\n\n              const timer = setTimeout(() => {\n                /** compted after animation finished */\n                updateOverlayInnerStyle();\n                clearTimeout(timer);\n              }, 60);\n            }\n          }}\n          onResize={() => {\n            if (visible.value) {\n              updatePopper();\n            }\n          }}\n          visible={visible.value}\n          attach={props.attach}\n        >\n          {{\n            content: () => (\n              <Transition\n                name={`${prefixCls.value}--animation${props.expandAnimation ? '-expand' : ''}`}\n                appear\n                onEnter={updatePopper}\n                onAfterLeave={destroyPopper}\n              >\n                {overlay}\n              </Transition>\n            ),\n            default: () => {\n              if (typeof props.triggerElement === 'string') return null;\n              return renderContent('default', 'triggerElement');\n            },\n          }}\n        </Container>\n      );\n    };\n  },\n});\n"],"names":["nativeMax","Math","max","nativeMin","min","baseInRange","number","start","end","inRange","toFinite","undefined","toNumber","_isSlot","s","Object","prototype","toString","call","_isVNode","POPUP_ATTR_NAME","POPUP_PARENT_ATTR_NAME","getPopperTree","id","upwards","list","selectors","unshift","pop","recurse","children","document","querySelectorAll","concat","forEach","el","push","childId","getAttribute","parentKey","Symbol","getPopperPlacement","placement","replace","attachListeners","elm","offs","add","type","listener","on","value","off","clean","handler","length","defineComponent","name","props","_objectSpread","expandAnimation","Boolean","setup","_process$env","expose","_ref","_toRefs","toRefs","propVisible","visible","modelValue","_useVModel","useVModel","defaultVisible","onVisibleChange","_useVModel2","_slicedToArray","setVisible","renderTNodeJSX","useTNodeJSX","renderContent","useContent","popper","showTimeout","hideTimeout","triggerEl","ref","overlayEl","popperEl","containerRef","isOverlayHover","arrowStyle","process","env","TEST","Date","now","parent","inject","provide","assertMouseLeave","onMouseLeave","prefixCls","usePrefixClass","_useCommonClassName","useCommonClassName","commonCls","STATUS","delay","computed","_props2$delay","_delay2$","trigger","show","hide","watch","hover","focus","click","ev","disabled","preventDefault","overlayStyle","overlayInnerStyle","updateOverlayInnerStyle","updatePopper","immediate","triggerElement","v","nextTick","querySelector","destroyPopper","isServer","onDocumentMouseDown","once","_process$env2","code","updateScrollTop","onUnmounted","clearAllTimeout","update","getOverlay","getOverlayState","getPopper","close","getOverlayStyle","isFunction","isObject","setStyle","getArrowStyle","_popperEl$value$offse2","triggerRect","getBoundingClientRect","popupRect","position","startsWith","_popperEl$value$offse","offsetLeft","abs","left","width","popupWidth","offsetWidth","maxPopupOffsetLeft","minPopupOffsetLeft","marginLeft","offsetTop","top","height","popupHeight","offsetHeight","clientHeight","maxPopupOffsetTop","minPopupOffsetTop","marginTop","getRootNode","ShadowRoot","state","elements","reference","rect","body","parentElement","isHidden","getTriggerType","showArrow","createPopper","onFirstUpdate","popperOptions","_popper","destroy","destroyOnClose","_containerRef$value","unmountContent","setTimeout","e","clearTimeout","_popperEl$value","_triggerEl$value","contains","target","activedPopper","find","some","isCursorOverlaps","x","y","onMouseenter","onOverlayClick","_props2$onOverlayClic","handleOnScroll","_props2$onScroll","_e$target","scrollTop","scrollHeight","debounceOnScrollBottom","debounce","onScrollToBottom","_props2$onScrollToBot","floor","onScroll","content","hidePopup","hideEmptyPopup","includes","overlay","_withDirectives","_createVNode","_mergeProps","_defineProperty","overlayClassName","zIndex","visibility","isString","overlayInnerClassName","_vShow","Container","forwardRef","onContentMounted","timer","onResize","attach","default"],"mappings":"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"}