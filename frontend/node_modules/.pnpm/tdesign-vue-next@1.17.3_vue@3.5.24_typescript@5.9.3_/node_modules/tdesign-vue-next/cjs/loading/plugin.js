/**
 * tdesign v1.17.3
 * (c) 2025 tdesign
 * @license MIT
 */

'use strict';

Object.defineProperty(exports, '__esModule', { value: true });

var Vue = require('vue');
var loading_loading = require('../_chunks/dep-fa858b52.js');
require('@babel/runtime/helpers/toConsumableArray');
require('@babel/runtime/helpers/typeof');
var dom = require('../_chunks/dep-e9e443b3.js');
var index = require('../_chunks/dep-f36ac85d.js');
require('@babel/runtime/helpers/slicedToArray');
require('../_chunks/dep-62c55445.js');
require('@babel/runtime/helpers/defineProperty');
var configProvider_utils_context = require('../_chunks/dep-35a0e660.js');
require('./icon/gradient.js');
require('../_chunks/dep-3c17082b.js');
require('../_chunks/dep-81f89596.js');
require('../_chunks/dep-6080cc7c.js');
require('../_chunks/dep-6d2dff6a.js');
require('@babel/runtime/helpers/objectWithoutProperties');
require('../_chunks/dep-4a3aa884.js');
require('../_chunks/dep-e62aa80a.js');
require('../_chunks/dep-3857e28e.js');
require('../_chunks/dep-42470626.js');
require('../_chunks/dep-11c0611a.js');
require('../_chunks/dep-56be0189.js');
require('../_chunks/dep-6c08ebb5.js');
require('../_chunks/dep-e0d767af.js');
require('../_chunks/dep-bfcf2d69.js');
require('../_chunks/dep-b172ffb0.js');
require('../_chunks/dep-d0a18b94.js');
require('../_chunks/dep-b970235a.js');
require('../_chunks/dep-cda66fb3.js');
require('../_chunks/dep-4ba9517c.js');
require('../_chunks/dep-d3130f90.js');
require('../_chunks/dep-53514171.js');
require('../_chunks/dep-a0ce0259.js');
require('../_chunks/dep-97cde52e.js');
require('../_chunks/dep-4b3d4086.js');
require('../config-provider/hooks/useConfig.js');
require('../_chunks/dep-73b8ee37.js');
require('../_chunks/dep-dc91d44a.js');
require('../_chunks/dep-d5216d3b.js');
require('../_chunks/dep-f7736f6a.js');
require('../_chunks/dep-dee5853a.js');
require('../_chunks/dep-676e174d.js');
require('../_chunks/dep-fac560bb.js');
require('../_chunks/dep-0ac6ae68.js');
require('../_chunks/dep-d72e09dd.js');
require('../_chunks/dep-2a644c59.js');
require('../_chunks/dep-b8a33a6b.js');
require('../_chunks/dep-abd1e140.js');
require('../_chunks/dep-f13b9823.js');
require('./props.js');
require('@babel/runtime/helpers/createClass');
require('@babel/runtime/helpers/classCallCheck');
require('../_chunks/dep-bb254cec.js');
require('dayjs');
require('../_chunks/dep-09350c0c.js');
require('../_chunks/dep-9f738d44.js');

var fullScreenLoadingInstance = null;
function mergeDefaultProps(props) {
  var options = configProvider_utils_context.merge({
    fullscreen: false,
    attach: "body",
    loading: true,
    preventScrollThrough: true
  }, props);
  return options;
}
function createLoading(props, context) {
  var mergedProps = mergeDefaultProps(props);
  if (mergedProps.fullscreen && fullScreenLoadingInstance) {
    return fullScreenLoadingInstance;
  }
  var component = Vue.defineComponent({
    setup: function setup() {
      var loadingOptions = Vue.reactive(mergedProps);
      return function () {
        return Vue.h(loading_loading._Loading, loadingOptions);
      };
    }
  });
  var attach = dom.getAttach(mergedProps.fullscreen ? "body" : mergedProps.attach);
  var instance = Vue.createVNode(component);
  if (context !== null && context !== void 0 ? context : LoadingPlugin._context) {
    instance.appContext = context !== null && context !== void 0 ? context : LoadingPlugin._context;
  }
  var wrapper = document.createElement("div");
  Vue.render(instance, wrapper);
  var parentRelativeClass = index.usePrefixClass("loading__parent--relative").value;
  var lockClass = index.usePrefixClass("loading--lock");
  var lockFullscreen = mergedProps.preventScrollThrough && mergedProps.fullscreen;
  if (lockFullscreen) {
    dom.addClass(document.body, lockClass.value);
  }
  if (attach) {
    dom.addClass(attach, parentRelativeClass);
  } else {
    console.error("attach is not exist");
  }
  var loadingInstance = {
    hide: function hide() {
      dom.removeClass(attach, parentRelativeClass);
      dom.removeClass(document.body, lockClass.value);
      Vue.render(null, wrapper);
      wrapper.remove();
    }
  };
  return loadingInstance;
}
function produceLoading(props, context) {
  if (props === true) {
    fullScreenLoadingInstance = createLoading({
      fullscreen: true,
      loading: true,
      attach: "body",
      preventScrollThrough: true
    }, context);
    return fullScreenLoadingInstance;
  }
  if (props === false) {
    var _fullScreenLoadingIns;
    (_fullScreenLoadingIns = fullScreenLoadingInstance) === null || _fullScreenLoadingIns === void 0 || _fullScreenLoadingIns.hide();
    fullScreenLoadingInstance = null;
    return;
  }
  return createLoading(props);
}
var LoadingPlugin = produceLoading;
LoadingPlugin.install = function (app) {
  app.config.globalProperties.$loading = produceLoading;
  LoadingPlugin._context = app._context;
};

exports.LoadingPlugin = LoadingPlugin;
exports["default"] = LoadingPlugin;
//# sourceMappingURL=plugin.js.map
